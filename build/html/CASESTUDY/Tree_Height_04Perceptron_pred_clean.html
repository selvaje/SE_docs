<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estimation of tree height using GEDI dataset - Clean Data - Perceptron 3 &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Estimation of tree height using GEDI dataset - Perceptron 2" href="Tree_Height_05NeuralNets_pred.html" />
    <link rel="prev" title="Estimation of tree height using GEDI dataset - Perceptron 1" href="Tree_Height_04Perceptron_pred.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Spatial Ecology's code documentation
            <img src="../_static/SE_compact.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2022.html">GeoComp &amp; ML 2022 course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_Colab_for_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_OSGeoLive_for_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_OSGeoLive_curso_para_Ecologia_Espacial.html">Prepare OSGeoLive para el curso de ecología espacial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../AWK/awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../R/R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Geo_Python.html">Python &amp; GeoComputation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_intro.html">GRASS Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_hydro.html">Using GRASS for stream-network extraction and basins delineation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CASE STUDY</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1"><a class="reference internal" href="temporal_interpolation.html">Temporal interpolation of landsat images</a></li>
<li class="toctree-l1"><a class="reference internal" href="DTW.html">Dynamic Time Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="pred_NP.html">Estimating nitrogen and phosphorus concentrations in streams and rivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day1.html">Estimating nitrogen concentrations in streams and rivers using NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day2.html">Autoencoder (AE), Variational Autoencoder (VAE) and Generative Adversarial Network (GAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day3.html">LSTM Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_01DataExplore.html">Estimation of tree height using GEDI dataset - Data explore</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_02SVM_pred.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_03RF_pred.html">Estimation of tree height using GEDI dataset - Random Forest prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04Perceptron_pred.html">Estimation of tree height using GEDI dataset - Perceptron 1</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Estimation of tree height using GEDI dataset - Clean Data - Perceptron 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Base-on-data-quality-flag-select-more-reilable-tree-height.">Base on data quality flag select more reilable tree height.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Import-raw-data,-extracted-predictors-and-show-the-data-distribution">Import raw data, extracted predictors and show the data distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_05NeuralNets_pred.html">Estimation of tree height using GEDI dataset - Perceptron 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Students Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../STUDENTSPROJECTS/index.html">1. 2021 SWEDEN</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OUTDOOR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../OUTDOOR/outdoor_orientering.html">Do not get lost in the wilderness</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TALKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TALKS/intelligent_modelling.html">Intelligent modelling in time and space: combine GeoComputation and Machine Learning for  environmental application.</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/video.html">Video tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/Compiling_OTB.html">Compiling OTB from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spatial Ecology's code documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">&lt;no title&gt;</a> &raquo;</li>
      <li>Estimation of tree height using GEDI dataset - Clean Data - Perceptron 3</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/CASESTUDY/Tree_Height_04Perceptron_pred_clean.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Estimation-of-tree-height-using-GEDI-dataset---Clean-Data---Perceptron-3">
<h1>Estimation of tree height using GEDI dataset - Clean Data - Perceptron 3<a class="headerlink" href="#Estimation-of-tree-height-using-GEDI-dataset---Clean-Data---Perceptron-3" title="Permalink to this headline"></a></h1>
<section id="Base-on-data-quality-flag-select-more-reilable-tree-height.">
<h2>Base on data quality flag select more reilable tree height.<a class="headerlink" href="#Base-on-data-quality-flag-select-more-reilable-tree-height." title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
<p><strong>File storing tree hight (cm) obtained by 6 algorithms, with their associate quality flags.</strong> The quality flags can be used to refine and select the best tree height estimation and use it as tree height observation.</p>
<ul class="simple">
<li><p>a?_95: tree hight (cm) at 95 quintile, for each algorithm</p></li>
<li><p>min_rh_95: minimum value of tree hight (cm) ammong the 6 algorithms</p></li>
<li><p>max_rh_95: maximum value of tree hight (cm) ammong the 6 algorithms</p></li>
<li><p>BEAM: 1-4 coverage beam = lower power (worse) ; 5-8 power beam = higher power (better)</p></li>
<li><p>digital_elev: digital mdoel elevation</p></li>
<li><p>elev_low: elevation of center of lowest mode</p></li>
<li><p>qc_a?: quality_flag for six algorithms quality_flag = 1 (better); = 0 (worse)</p></li>
<li><p>se_a?: sensitivity for six algorithms sensitivity &lt; 0.95 (worse); sensitivity &gt; 0.95 (beter )</p></li>
<li><p>deg_fg: (degrade_flag) not-degraded 0 (better) ; degraded &gt; 0 (worse)</p></li>
<li><p>solar_ele: solar elevation. &gt; 0 day (worse); &lt; 0 night (better)</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_6algorithms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tree_height/txt/eu_y_x_select_6algorithms_fullTable.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">height_6algorithms</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>a1_95</th>
      <th>a2_95</th>
      <th>a3_95</th>
      <th>a4_95</th>
      <th>a5_95</th>
      <th>a6_95</th>
      <th>min_rh_95</th>
      <th>max_rh_95</th>
      <th>BEAM</th>
      <th>digital_elev</th>
      <th>elev_low</th>
      <th>qc_a1</th>
      <th>qc_a2</th>
      <th>qc_a3</th>
      <th>qc_a4</th>
      <th>qc_a5</th>
      <th>qc_a6</th>
      <th>se_a1</th>
      <th>se_a2</th>
      <th>se_a3</th>
      <th>se_a4</th>
      <th>se_a5</th>
      <th>se_a6</th>
      <th>deg_fg</th>
      <th>solar_ele</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.050001</td>
      <td>49.727499</td>
      <td>3139</td>
      <td>3139</td>
      <td>3139</td>
      <td>3120</td>
      <td>3139</td>
      <td>3139</td>
      <td>3120</td>
      <td>3139</td>
      <td>5</td>
      <td>410.0</td>
      <td>383.72153</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.962</td>
      <td>0.984</td>
      <td>0.968</td>
      <td>0.962</td>
      <td>0.989</td>
      <td>0.979</td>
      <td>0</td>
      <td>17.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>6.050002</td>
      <td>49.922155</td>
      <td>1022</td>
      <td>2303</td>
      <td>970</td>
      <td>872</td>
      <td>5596</td>
      <td>1524</td>
      <td>872</td>
      <td>5596</td>
      <td>5</td>
      <td>290.0</td>
      <td>2374.14110</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.948</td>
      <td>0.990</td>
      <td>0.960</td>
      <td>0.948</td>
      <td>0.994</td>
      <td>0.980</td>
      <td>0</td>
      <td>43.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6.050002</td>
      <td>48.602377</td>
      <td>380</td>
      <td>1336</td>
      <td>332</td>
      <td>362</td>
      <td>1336</td>
      <td>1340</td>
      <td>332</td>
      <td>1340</td>
      <td>4</td>
      <td>440.0</td>
      <td>435.97781</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.947</td>
      <td>0.975</td>
      <td>0.956</td>
      <td>0.947</td>
      <td>0.981</td>
      <td>0.968</td>
      <td>0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>6.050009</td>
      <td>48.151979</td>
      <td>3153</td>
      <td>3142</td>
      <td>3142</td>
      <td>3127</td>
      <td>3138</td>
      <td>3142</td>
      <td>3127</td>
      <td>3153</td>
      <td>2</td>
      <td>450.0</td>
      <td>422.00537</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.930</td>
      <td>0.970</td>
      <td>0.943</td>
      <td>0.930</td>
      <td>0.978</td>
      <td>0.962</td>
      <td>0</td>
      <td>-14.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>6.050010</td>
      <td>49.588410</td>
      <td>666</td>
      <td>4221</td>
      <td>651</td>
      <td>33</td>
      <td>5611</td>
      <td>2723</td>
      <td>33</td>
      <td>5611</td>
      <td>8</td>
      <td>370.0</td>
      <td>2413.74830</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.941</td>
      <td>0.983</td>
      <td>0.946</td>
      <td>0.941</td>
      <td>0.992</td>
      <td>0.969</td>
      <td>0</td>
      <td>22.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>6.050014</td>
      <td>48.608456</td>
      <td>787</td>
      <td>1179</td>
      <td>1187</td>
      <td>761</td>
      <td>1833</td>
      <td>1833</td>
      <td>761</td>
      <td>1833</td>
      <td>3</td>
      <td>420.0</td>
      <td>415.51581</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.952</td>
      <td>0.979</td>
      <td>0.961</td>
      <td>0.952</td>
      <td>0.986</td>
      <td>0.975</td>
      <td>0</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_6algorithms_sel</span> <span class="o">=</span> <span class="n">height_6algorithms</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;BEAM&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;qc_a1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;qc_a2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;qc_a3&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;qc_a4&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;qc_a5&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;qc_a6&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;se_a1&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;se_a2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;se_a3&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;se_a4&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;se_a5&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;se_a6&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.95</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;deg_fg&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                                            <span class="o">&amp;</span>   <span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s1">&#39;solar_ele&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_6algorithms_sel</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>a1_95</th>
      <th>a2_95</th>
      <th>a3_95</th>
      <th>a4_95</th>
      <th>a5_95</th>
      <th>a6_95</th>
      <th>min_rh_95</th>
      <th>max_rh_95</th>
      <th>BEAM</th>
      <th>digital_elev</th>
      <th>elev_low</th>
      <th>qc_a1</th>
      <th>qc_a2</th>
      <th>qc_a3</th>
      <th>qc_a4</th>
      <th>qc_a5</th>
      <th>qc_a6</th>
      <th>se_a1</th>
      <th>se_a2</th>
      <th>se_a3</th>
      <th>se_a4</th>
      <th>se_a5</th>
      <th>se_a6</th>
      <th>deg_fg</th>
      <th>solar_ele</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>6.050019</td>
      <td>49.921613</td>
      <td>3303</td>
      <td>3288</td>
      <td>3296</td>
      <td>3236</td>
      <td>3857</td>
      <td>3292</td>
      <td>3236</td>
      <td>3857</td>
      <td>7</td>
      <td>320.0</td>
      <td>297.68533</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.971</td>
      <td>0.988</td>
      <td>0.976</td>
      <td>0.971</td>
      <td>0.992</td>
      <td>0.984</td>
      <td>0</td>
      <td>-33.9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>6.050039</td>
      <td>47.995344</td>
      <td>2762</td>
      <td>2736</td>
      <td>2740</td>
      <td>2747</td>
      <td>3893</td>
      <td>2736</td>
      <td>2736</td>
      <td>3893</td>
      <td>5</td>
      <td>390.0</td>
      <td>368.55121</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.975</td>
      <td>0.990</td>
      <td>0.979</td>
      <td>0.975</td>
      <td>0.994</td>
      <td>0.987</td>
      <td>0</td>
      <td>-37.3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>6.050046</td>
      <td>49.865317</td>
      <td>1398</td>
      <td>2505</td>
      <td>2509</td>
      <td>1316</td>
      <td>2848</td>
      <td>2505</td>
      <td>1316</td>
      <td>2848</td>
      <td>6</td>
      <td>340.0</td>
      <td>330.40564</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.973</td>
      <td>0.990</td>
      <td>0.979</td>
      <td>0.973</td>
      <td>0.994</td>
      <td>0.986</td>
      <td>0</td>
      <td>-18.2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>6.050048</td>
      <td>49.050020</td>
      <td>984</td>
      <td>943</td>
      <td>947</td>
      <td>958</td>
      <td>2617</td>
      <td>947</td>
      <td>943</td>
      <td>2617</td>
      <td>6</td>
      <td>300.0</td>
      <td>291.22598</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.978</td>
      <td>0.991</td>
      <td>0.982</td>
      <td>0.978</td>
      <td>0.995</td>
      <td>0.988</td>
      <td>0</td>
      <td>-35.4</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td>6.050049</td>
      <td>48.391359</td>
      <td>3362</td>
      <td>3332</td>
      <td>3336</td>
      <td>3351</td>
      <td>4467</td>
      <td>3336</td>
      <td>3332</td>
      <td>4467</td>
      <td>5</td>
      <td>530.0</td>
      <td>504.78122</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.973</td>
      <td>0.988</td>
      <td>0.977</td>
      <td>0.973</td>
      <td>0.992</td>
      <td>0.984</td>
      <td>0</td>
      <td>-5.1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1267207</th>
      <td>1267208</td>
      <td>9.949829</td>
      <td>49.216272</td>
      <td>2160</td>
      <td>2816</td>
      <td>2816</td>
      <td>2104</td>
      <td>3299</td>
      <td>2816</td>
      <td>2104</td>
      <td>3299</td>
      <td>8</td>
      <td>420.0</td>
      <td>386.44556</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.980</td>
      <td>0.993</td>
      <td>0.984</td>
      <td>0.980</td>
      <td>0.995</td>
      <td>0.989</td>
      <td>0</td>
      <td>-16.9</td>
    </tr>
    <tr>
      <th>1267211</th>
      <td>1267212</td>
      <td>9.949856</td>
      <td>49.881190</td>
      <td>3190</td>
      <td>3179</td>
      <td>3179</td>
      <td>3171</td>
      <td>3822</td>
      <td>3179</td>
      <td>3171</td>
      <td>3822</td>
      <td>6</td>
      <td>380.0</td>
      <td>363.69348</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.968</td>
      <td>0.986</td>
      <td>0.974</td>
      <td>0.968</td>
      <td>0.990</td>
      <td>0.982</td>
      <td>0</td>
      <td>-35.1</td>
    </tr>
    <tr>
      <th>1267216</th>
      <td>1267217</td>
      <td>9.949880</td>
      <td>49.873435</td>
      <td>2061</td>
      <td>2828</td>
      <td>2046</td>
      <td>2024</td>
      <td>2828</td>
      <td>2828</td>
      <td>2024</td>
      <td>2828</td>
      <td>7</td>
      <td>380.0</td>
      <td>361.06812</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.967</td>
      <td>0.988</td>
      <td>0.974</td>
      <td>0.967</td>
      <td>0.993</td>
      <td>0.983</td>
      <td>0</td>
      <td>-35.1</td>
    </tr>
    <tr>
      <th>1267227</th>
      <td>1267228</td>
      <td>9.949958</td>
      <td>49.127182</td>
      <td>366</td>
      <td>2307</td>
      <td>1260</td>
      <td>355</td>
      <td>3531</td>
      <td>2719</td>
      <td>355</td>
      <td>3531</td>
      <td>6</td>
      <td>500.0</td>
      <td>493.52792</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.973</td>
      <td>0.989</td>
      <td>0.978</td>
      <td>0.973</td>
      <td>0.993</td>
      <td>0.985</td>
      <td>0</td>
      <td>-36.0</td>
    </tr>
    <tr>
      <th>1267237</th>
      <td>1267238</td>
      <td>9.949999</td>
      <td>49.936763</td>
      <td>2513</td>
      <td>2490</td>
      <td>2490</td>
      <td>2494</td>
      <td>2490</td>
      <td>2490</td>
      <td>2490</td>
      <td>2513</td>
      <td>5</td>
      <td>360.0</td>
      <td>346.54227</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.968</td>
      <td>0.988</td>
      <td>0.974</td>
      <td>0.968</td>
      <td>0.993</td>
      <td>0.983</td>
      <td>0</td>
      <td>-32.2</td>
    </tr>
  </tbody>
</table>
<p>226892 rows × 28 columns</p>
</div></div>
</div>
<p>Calculate the mean height excluidng the maximum and minimum values</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_sel</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;ID&#39;</span> <span class="p">:</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="p">,</span>
                            <span class="s1">&#39;hm_sel&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;a1_95&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;a2_95&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;a3_95&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;a4_95&#39;</span><span class="p">]</span>
                             <span class="o">+</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;a5_95&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;a6_95&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;min_rh_95&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">height_6algorithms_sel</span><span class="p">[</span><span class="s1">&#39;max_rh_95&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">400</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_sel</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>hm_sel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>32.9475</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12</td>
      <td>27.4625</td>
    </tr>
    <tr>
      <th>14</th>
      <td>15</td>
      <td>22.2925</td>
    </tr>
    <tr>
      <th>15</th>
      <td>16</td>
      <td>9.5900</td>
    </tr>
    <tr>
      <th>16</th>
      <td>17</td>
      <td>33.4625</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1267207</th>
      <td>1267208</td>
      <td>26.5200</td>
    </tr>
    <tr>
      <th>1267211</th>
      <td>1267212</td>
      <td>31.8175</td>
    </tr>
    <tr>
      <th>1267216</th>
      <td>1267217</td>
      <td>24.4075</td>
    </tr>
    <tr>
      <th>1267227</th>
      <td>1267228</td>
      <td>16.6300</td>
    </tr>
    <tr>
      <th>1267237</th>
      <td>1267238</td>
      <td>24.9100</td>
    </tr>
  </tbody>
</table>
<p>226892 rows × 2 columns</p>
</div></div>
</div>
</section>
<section id="Import-raw-data,-extracted-predictors-and-show-the-data-distribution">
<h2>Import raw data, extracted predictors and show the data distribution<a class="headerlink" href="#Import-raw-data,-extracted-predictors-and-show-the-data-distribution" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tree_height/txt/eu_x_y_height_predictors_select.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># change column name</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">predictors</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;dev-magnitude&#39;</span><span class="p">:</span><span class="s1">&#39;devmagnitude&#39;</span><span class="p">}</span> <span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>h</th>
      <th>BLDFIE_WeigAver</th>
      <th>CECSOL_WeigAver</th>
      <th>CHELSA_bio18</th>
      <th>CHELSA_bio4</th>
      <th>convergence</th>
      <th>cti</th>
      <th>devmagnitude</th>
      <th>eastness</th>
      <th>elev</th>
      <th>forestheight</th>
      <th>glad_ard_SVVI_max</th>
      <th>glad_ard_SVVI_med</th>
      <th>glad_ard_SVVI_min</th>
      <th>northness</th>
      <th>ORCDRC_WeigAver</th>
      <th>outlet_dist_dw_basin</th>
      <th>SBIO3_Isothermality_5_15cm</th>
      <th>SBIO4_Temperature_Seasonality_5_15cm</th>
      <th>treecover</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.050001</td>
      <td>49.727499</td>
      <td>3139.00</td>
      <td>1540</td>
      <td>13</td>
      <td>2113</td>
      <td>5893</td>
      <td>-10.486560</td>
      <td>-238043120</td>
      <td>1.158417</td>
      <td>0.069094</td>
      <td>353.983124</td>
      <td>23</td>
      <td>276.871094</td>
      <td>46.444092</td>
      <td>347.665405</td>
      <td>0.042500</td>
      <td>9</td>
      <td>780403</td>
      <td>19.798992</td>
      <td>440.672211</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>6.050002</td>
      <td>49.922155</td>
      <td>1454.75</td>
      <td>1491</td>
      <td>12</td>
      <td>1993</td>
      <td>5912</td>
      <td>33.274361</td>
      <td>-208915344</td>
      <td>-1.755341</td>
      <td>0.269112</td>
      <td>267.511688</td>
      <td>19</td>
      <td>-49.526367</td>
      <td>19.552734</td>
      <td>-130.541748</td>
      <td>0.182780</td>
      <td>16</td>
      <td>772777</td>
      <td>20.889412</td>
      <td>457.756195</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6.050002</td>
      <td>48.602377</td>
      <td>853.50</td>
      <td>1521</td>
      <td>17</td>
      <td>2124</td>
      <td>5983</td>
      <td>0.045293</td>
      <td>-137479792</td>
      <td>1.908780</td>
      <td>-0.016055</td>
      <td>389.751160</td>
      <td>21</td>
      <td>93.257324</td>
      <td>50.743652</td>
      <td>384.522461</td>
      <td>0.036253</td>
      <td>14</td>
      <td>898820</td>
      <td>20.695877</td>
      <td>481.879700</td>
      <td>62</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>6.050009</td>
      <td>48.151979</td>
      <td>3141.00</td>
      <td>1526</td>
      <td>16</td>
      <td>2569</td>
      <td>6130</td>
      <td>-33.654274</td>
      <td>-267223072</td>
      <td>0.965787</td>
      <td>0.067767</td>
      <td>380.207703</td>
      <td>27</td>
      <td>542.401367</td>
      <td>202.264160</td>
      <td>386.156738</td>
      <td>0.005139</td>
      <td>15</td>
      <td>831824</td>
      <td>19.375000</td>
      <td>479.410278</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>6.050010</td>
      <td>49.588410</td>
      <td>2065.25</td>
      <td>1547</td>
      <td>14</td>
      <td>2108</td>
      <td>5923</td>
      <td>27.493824</td>
      <td>-107809368</td>
      <td>-0.162624</td>
      <td>0.014065</td>
      <td>308.042786</td>
      <td>25</td>
      <td>136.048340</td>
      <td>146.835205</td>
      <td>198.127441</td>
      <td>0.028847</td>
      <td>17</td>
      <td>796962</td>
      <td>18.777500</td>
      <td>457.880066</td>
      <td>85</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>6.050014</td>
      <td>48.608456</td>
      <td>1246.50</td>
      <td>1515</td>
      <td>19</td>
      <td>2124</td>
      <td>6010</td>
      <td>-1.602039</td>
      <td>17384282</td>
      <td>1.447979</td>
      <td>-0.018912</td>
      <td>364.527100</td>
      <td>18</td>
      <td>221.339844</td>
      <td>247.387207</td>
      <td>480.387939</td>
      <td>0.042747</td>
      <td>14</td>
      <td>897945</td>
      <td>19.398880</td>
      <td>474.331329</td>
      <td>62</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>6.050016</td>
      <td>48.571401</td>
      <td>2938.75</td>
      <td>1520</td>
      <td>19</td>
      <td>2169</td>
      <td>6147</td>
      <td>27.856503</td>
      <td>-66516432</td>
      <td>-1.073956</td>
      <td>0.002280</td>
      <td>254.679596</td>
      <td>19</td>
      <td>125.250488</td>
      <td>87.865234</td>
      <td>160.696777</td>
      <td>0.037254</td>
      <td>11</td>
      <td>908426</td>
      <td>20.170450</td>
      <td>476.414520</td>
      <td>96</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>6.050019</td>
      <td>49.921613</td>
      <td>3294.75</td>
      <td>1490</td>
      <td>12</td>
      <td>1995</td>
      <td>5912</td>
      <td>22.102139</td>
      <td>-297770784</td>
      <td>-1.402633</td>
      <td>0.309765</td>
      <td>294.927765</td>
      <td>26</td>
      <td>-86.729492</td>
      <td>-145.584229</td>
      <td>-190.062988</td>
      <td>0.222435</td>
      <td>15</td>
      <td>772784</td>
      <td>20.855963</td>
      <td>457.195404</td>
      <td>86</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>6.050020</td>
      <td>48.822645</td>
      <td>1623.50</td>
      <td>1554</td>
      <td>18</td>
      <td>1973</td>
      <td>6138</td>
      <td>18.496584</td>
      <td>-25336536</td>
      <td>-0.800016</td>
      <td>0.010370</td>
      <td>240.493759</td>
      <td>22</td>
      <td>-51.470703</td>
      <td>-245.886719</td>
      <td>172.074707</td>
      <td>0.004428</td>
      <td>8</td>
      <td>839132</td>
      <td>21.812290</td>
      <td>496.231110</td>
      <td>64</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>6.050024</td>
      <td>49.847522</td>
      <td>1400.00</td>
      <td>1521</td>
      <td>15</td>
      <td>2187</td>
      <td>5886</td>
      <td>-5.660453</td>
      <td>-278652608</td>
      <td>1.477951</td>
      <td>-0.068720</td>
      <td>376.671143</td>
      <td>12</td>
      <td>277.297363</td>
      <td>273.141846</td>
      <td>-138.895996</td>
      <td>0.098817</td>
      <td>13</td>
      <td>768873</td>
      <td>21.137711</td>
      <td>466.976685</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Merge the new height with the predictors table, using the ID as Primary Key</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_hm_sel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">predictors</span> <span class="p">,</span>  <span class="n">height_sel</span> <span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span> <span class="p">,</span>  <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span> <span class="p">,</span>  <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_hm_sel</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>h</th>
      <th>BLDFIE_WeigAver</th>
      <th>CECSOL_WeigAver</th>
      <th>CHELSA_bio18</th>
      <th>CHELSA_bio4</th>
      <th>convergence</th>
      <th>cti</th>
      <th>devmagnitude</th>
      <th>eastness</th>
      <th>elev</th>
      <th>forestheight</th>
      <th>glad_ard_SVVI_max</th>
      <th>glad_ard_SVVI_med</th>
      <th>glad_ard_SVVI_min</th>
      <th>northness</th>
      <th>ORCDRC_WeigAver</th>
      <th>outlet_dist_dw_basin</th>
      <th>SBIO3_Isothermality_5_15cm</th>
      <th>SBIO4_Temperature_Seasonality_5_15cm</th>
      <th>treecover</th>
      <th>hm_sel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>6.050019</td>
      <td>49.921613</td>
      <td>3294.75</td>
      <td>1490</td>
      <td>12</td>
      <td>1995</td>
      <td>5912</td>
      <td>22.102139</td>
      <td>-297770784</td>
      <td>-1.402633</td>
      <td>0.309765</td>
      <td>294.927765</td>
      <td>26</td>
      <td>-86.729492</td>
      <td>-145.584229</td>
      <td>-190.062988</td>
      <td>0.222435</td>
      <td>15</td>
      <td>772784</td>
      <td>20.855963</td>
      <td>457.195404</td>
      <td>86</td>
      <td>32.9475</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>6.050039</td>
      <td>47.995344</td>
      <td>2746.25</td>
      <td>1523</td>
      <td>12</td>
      <td>2612</td>
      <td>6181</td>
      <td>3.549103</td>
      <td>-71279992</td>
      <td>0.507727</td>
      <td>-0.021408</td>
      <td>322.920227</td>
      <td>26</td>
      <td>660.006104</td>
      <td>92.722168</td>
      <td>190.979736</td>
      <td>-0.034787</td>
      <td>16</td>
      <td>784807</td>
      <td>20.798000</td>
      <td>460.501221</td>
      <td>97</td>
      <td>27.4625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15</td>
      <td>6.050046</td>
      <td>49.865317</td>
      <td>2229.25</td>
      <td>1517</td>
      <td>13</td>
      <td>2191</td>
      <td>5901</td>
      <td>31.054762</td>
      <td>-186807440</td>
      <td>-1.375050</td>
      <td>-0.126880</td>
      <td>291.412537</td>
      <td>7</td>
      <td>1028.385498</td>
      <td>915.806396</td>
      <td>841.586182</td>
      <td>0.024677</td>
      <td>16</td>
      <td>766444</td>
      <td>19.941267</td>
      <td>454.185089</td>
      <td>54</td>
      <td>22.2925</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>6.050048</td>
      <td>49.050020</td>
      <td>959.00</td>
      <td>1526</td>
      <td>14</td>
      <td>2081</td>
      <td>6100</td>
      <td>9.933455</td>
      <td>-183562672</td>
      <td>-0.382834</td>
      <td>0.086874</td>
      <td>246.288010</td>
      <td>24</td>
      <td>-12.283691</td>
      <td>-58.179199</td>
      <td>174.205566</td>
      <td>0.094175</td>
      <td>10</td>
      <td>805730</td>
      <td>19.849365</td>
      <td>470.946533</td>
      <td>78</td>
      <td>9.5900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>6.050049</td>
      <td>48.391359</td>
      <td>3346.25</td>
      <td>1489</td>
      <td>19</td>
      <td>2486</td>
      <td>5966</td>
      <td>-6.957157</td>
      <td>-273522688</td>
      <td>2.989759</td>
      <td>0.214769</td>
      <td>474.409088</td>
      <td>24</td>
      <td>125.583008</td>
      <td>6.154297</td>
      <td>128.129150</td>
      <td>0.017164</td>
      <td>15</td>
      <td>950190</td>
      <td>21.179420</td>
      <td>491.398376</td>
      <td>85</td>
      <td>33.4625</td>
    </tr>
    <tr>
      <th>5</th>
      <td>19</td>
      <td>6.050053</td>
      <td>49.877876</td>
      <td>529.00</td>
      <td>1531</td>
      <td>12</td>
      <td>2184</td>
      <td>5915</td>
      <td>-24.278454</td>
      <td>-377335296</td>
      <td>0.265329</td>
      <td>-0.248356</td>
      <td>335.534760</td>
      <td>25</td>
      <td>593.601074</td>
      <td>228.712402</td>
      <td>315.298340</td>
      <td>-0.127365</td>
      <td>17</td>
      <td>764713</td>
      <td>19.760756</td>
      <td>448.580811</td>
      <td>96</td>
      <td>5.2900</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_hm_sel</span> <span class="o">=</span> <span class="n">predictors_hm_sel</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">predictors</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5000</span><span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_hm_sel</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>h</th>
      <th>BLDFIE_WeigAver</th>
      <th>CECSOL_WeigAver</th>
      <th>CHELSA_bio18</th>
      <th>CHELSA_bio4</th>
      <th>convergence</th>
      <th>cti</th>
      <th>devmagnitude</th>
      <th>eastness</th>
      <th>elev</th>
      <th>forestheight</th>
      <th>glad_ard_SVVI_max</th>
      <th>glad_ard_SVVI_med</th>
      <th>glad_ard_SVVI_min</th>
      <th>northness</th>
      <th>ORCDRC_WeigAver</th>
      <th>outlet_dist_dw_basin</th>
      <th>SBIO3_Isothermality_5_15cm</th>
      <th>SBIO4_Temperature_Seasonality_5_15cm</th>
      <th>treecover</th>
      <th>hm_sel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>6.050039</td>
      <td>47.995344</td>
      <td>2746.25</td>
      <td>1523</td>
      <td>12</td>
      <td>2612</td>
      <td>6181</td>
      <td>3.549103</td>
      <td>-71279992</td>
      <td>0.507727</td>
      <td>-0.021408</td>
      <td>322.920227</td>
      <td>26</td>
      <td>660.006104</td>
      <td>92.722168</td>
      <td>190.979736</td>
      <td>-0.034787</td>
      <td>16</td>
      <td>784807</td>
      <td>20.798000</td>
      <td>460.501221</td>
      <td>97</td>
      <td>27.4625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15</td>
      <td>6.050046</td>
      <td>49.865317</td>
      <td>2229.25</td>
      <td>1517</td>
      <td>13</td>
      <td>2191</td>
      <td>5901</td>
      <td>31.054762</td>
      <td>-186807440</td>
      <td>-1.375050</td>
      <td>-0.126880</td>
      <td>291.412537</td>
      <td>7</td>
      <td>1028.385498</td>
      <td>915.806396</td>
      <td>841.586182</td>
      <td>0.024677</td>
      <td>16</td>
      <td>766444</td>
      <td>19.941267</td>
      <td>454.185089</td>
      <td>54</td>
      <td>22.2925</td>
    </tr>
    <tr>
      <th>5</th>
      <td>19</td>
      <td>6.050053</td>
      <td>49.877876</td>
      <td>529.00</td>
      <td>1531</td>
      <td>12</td>
      <td>2184</td>
      <td>5915</td>
      <td>-24.278454</td>
      <td>-377335296</td>
      <td>0.265329</td>
      <td>-0.248356</td>
      <td>335.534760</td>
      <td>25</td>
      <td>593.601074</td>
      <td>228.712402</td>
      <td>315.298340</td>
      <td>-0.127365</td>
      <td>17</td>
      <td>764713</td>
      <td>19.760756</td>
      <td>448.580811</td>
      <td>96</td>
      <td>5.2900</td>
    </tr>
    <tr>
      <th>8</th>
      <td>27</td>
      <td>6.050083</td>
      <td>49.281439</td>
      <td>3921.25</td>
      <td>1488</td>
      <td>13</td>
      <td>2345</td>
      <td>5915</td>
      <td>3.646593</td>
      <td>-223499248</td>
      <td>0.383314</td>
      <td>0.062349</td>
      <td>309.142609</td>
      <td>25</td>
      <td>862.362305</td>
      <td>263.612793</td>
      <td>249.693115</td>
      <td>-0.068810</td>
      <td>16</td>
      <td>781120</td>
      <td>17.538614</td>
      <td>463.280243</td>
      <td>100</td>
      <td>39.2125</td>
    </tr>
    <tr>
      <th>9</th>
      <td>35</td>
      <td>6.050119</td>
      <td>49.928610</td>
      <td>1765.00</td>
      <td>1510</td>
      <td>13</td>
      <td>1976</td>
      <td>5917</td>
      <td>-2.138205</td>
      <td>-393005696</td>
      <td>-1.467515</td>
      <td>-0.316702</td>
      <td>301.649567</td>
      <td>20</td>
      <td>248.561035</td>
      <td>164.831299</td>
      <td>237.283447</td>
      <td>-0.144407</td>
      <td>19</td>
      <td>773647</td>
      <td>21.324263</td>
      <td>465.046478</td>
      <td>87</td>
      <td>17.6500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>226876</th>
      <td>1267176</td>
      <td>9.949637</td>
      <td>49.887471</td>
      <td>3266.50</td>
      <td>1558</td>
      <td>14</td>
      <td>2074</td>
      <td>6484</td>
      <td>4.993805</td>
      <td>-196691680</td>
      <td>1.260540</td>
      <td>0.044238</td>
      <td>328.019165</td>
      <td>26</td>
      <td>-144.124023</td>
      <td>-145.522949</td>
      <td>-14.317627</td>
      <td>0.020914</td>
      <td>7</td>
      <td>857229</td>
      <td>17.376682</td>
      <td>463.421387</td>
      <td>98</td>
      <td>32.6650</td>
    </tr>
    <tr>
      <th>226878</th>
      <td>1267180</td>
      <td>9.949658</td>
      <td>49.856387</td>
      <td>497.00</td>
      <td>1515</td>
      <td>17</td>
      <td>1956</td>
      <td>6561</td>
      <td>34.034641</td>
      <td>-126274136</td>
      <td>-0.959000</td>
      <td>0.047194</td>
      <td>260.889069</td>
      <td>0</td>
      <td>681.798340</td>
      <td>657.745605</td>
      <td>642.011475</td>
      <td>0.050846</td>
      <td>5</td>
      <td>857225</td>
      <td>21.177349</td>
      <td>573.086243</td>
      <td>12</td>
      <td>4.9700</td>
    </tr>
    <tr>
      <th>226879</th>
      <td>1267184</td>
      <td>9.949688</td>
      <td>49.362831</td>
      <td>2344.00</td>
      <td>1517</td>
      <td>15</td>
      <td>2264</td>
      <td>6499</td>
      <td>9.173168</td>
      <td>160967872</td>
      <td>0.645957</td>
      <td>-0.011381</td>
      <td>447.678040</td>
      <td>23</td>
      <td>282.119385</td>
      <td>79.830811</td>
      <td>10.140381</td>
      <td>0.014716</td>
      <td>7</td>
      <td>824157</td>
      <td>18.283070</td>
      <td>471.167419</td>
      <td>89</td>
      <td>23.4400</td>
    </tr>
    <tr>
      <th>226881</th>
      <td>1267189</td>
      <td>9.949701</td>
      <td>49.114458</td>
      <td>2014.50</td>
      <td>1529</td>
      <td>12</td>
      <td>2608</td>
      <td>6632</td>
      <td>27.137199</td>
      <td>104082784</td>
      <td>-0.481382</td>
      <td>-0.012974</td>
      <td>447.814392</td>
      <td>21</td>
      <td>187.934082</td>
      <td>90.763672</td>
      <td>168.527100</td>
      <td>0.045602</td>
      <td>18</td>
      <td>907894</td>
      <td>18.010750</td>
      <td>473.227966</td>
      <td>72</td>
      <td>20.1450</td>
    </tr>
    <tr>
      <th>226882</th>
      <td>1267192</td>
      <td>9.949731</td>
      <td>49.893196</td>
      <td>2891.00</td>
      <td>1566</td>
      <td>15</td>
      <td>2088</td>
      <td>6482</td>
      <td>-36.581142</td>
      <td>-219142496</td>
      <td>1.348770</td>
      <td>0.060537</td>
      <td>331.815918</td>
      <td>21</td>
      <td>-68.830078</td>
      <td>-160.909668</td>
      <td>11.658203</td>
      <td>-0.046048</td>
      <td>11</td>
      <td>857705</td>
      <td>16.320225</td>
      <td>450.409271</td>
      <td>75</td>
      <td>28.9100</td>
    </tr>
  </tbody>
</table>
<p>116199 rows × 24 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x_y_hm_sel</span> <span class="o">=</span> <span class="n">predictors_hm_sel</span><span class="p">[[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;hm_sel&quot;</span><span class="p">]]</span>
<span class="n">x_y_hm_sel</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>hm_sel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>6.050039</td>
      <td>47.995344</td>
      <td>27.4625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.050046</td>
      <td>49.865317</td>
      <td>22.2925</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.050053</td>
      <td>49.877876</td>
      <td>5.2900</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6.050083</td>
      <td>49.281439</td>
      <td>39.2125</td>
    </tr>
    <tr>
      <th>9</th>
      <td>6.050119</td>
      <td>49.928610</td>
      <td>17.6500</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>226876</th>
      <td>9.949637</td>
      <td>49.887471</td>
      <td>32.6650</td>
    </tr>
    <tr>
      <th>226878</th>
      <td>9.949658</td>
      <td>49.856387</td>
      <td>4.9700</td>
    </tr>
    <tr>
      <th>226879</th>
      <td>9.949688</td>
      <td>49.362831</td>
      <td>23.4400</td>
    </tr>
    <tr>
      <th>226881</th>
      <td>9.949701</td>
      <td>49.114458</td>
      <td>20.1450</td>
    </tr>
    <tr>
      <th>226882</th>
      <td>9.949731</td>
      <td>49.893196</td>
      <td>28.9100</td>
    </tr>
  </tbody>
</table>
<p>116199 rows × 3 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Normalize the data</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_y_hm_sel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Inspect the ranges</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([4.4490e+03, 2.5580e+03, 2.3750e+03, 2.2710e+03, 2.7280e+03,
        3.3330e+03, 4.4110e+03, 5.5060e+03, 6.5250e+03, 7.5690e+03,
        8.9780e+03, 1.0236e+04, 1.1240e+04, 1.0795e+04, 9.7710e+03,
        7.9490e+03, 5.6670e+03, 3.7270e+03, 2.4290e+03, 1.4340e+03,
        8.8400e+02, 4.8700e+02, 2.8500e+02, 1.5300e+02, 1.0600e+02,
        6.5000e+01, 4.1000e+01, 2.4000e+01, 2.9000e+01, 2.2000e+01,
        1.6000e+01, 2.0000e+01, 1.5000e+01, 1.2000e+01, 1.5000e+01,
        5.0000e+00, 9.0000e+00, 8.0000e+00, 7.0000e+00, 7.0000e+00,
        7.0000e+00, 3.0000e+00, 2.0000e+00, 7.0000e+00, 4.0000e+00,
        2.0000e+00, 4.0000e+00, 6.0000e+00, 1.0000e+00, 2.0000e+00]),
 array([0.  , 0.02, 0.04, 0.06, 0.08, 0.1 , 0.12, 0.14, 0.16, 0.18, 0.2 ,
        0.22, 0.24, 0.26, 0.28, 0.3 , 0.32, 0.34, 0.36, 0.38, 0.4 , 0.42,
        0.44, 0.46, 0.48, 0.5 , 0.52, 0.54, 0.56, 0.58, 0.6 , 0.62, 0.64,
        0.66, 0.68, 0.7 , 0.72, 0.74, 0.76, 0.78, 0.8 , 0.82, 0.84, 0.86,
        0.88, 0.9 , 0.92, 0.94, 0.96, 0.98, 1.  ]),
 &lt;a list of 50 Patch objects&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_04Perceptron_pred_clean_19_1.png" src="../_images/CASESTUDY_Tree_Height_04Perceptron_pred_clean_19_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[117]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Split the data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_train.shape: </span><span class="si">{}</span><span class="s1">, X_test.shape: </span><span class="si">{}</span><span class="s1">, y_train.shape: </span><span class="si">{}</span><span class="s1">, y_test.shape: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
X_train.shape: torch.Size([81339, 2]), X_test.shape: torch.Size([34860, 2]), y_train.shape: torch.Size([81339]), y_test.shape: torch.Size([34860])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Perceptron</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">,</span> <span class="n">use_activation_fn</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Perceptron</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_size</span><span class="p">,</span><span class="n">output_size</span><span class="p">)</span> <span class="c1"># Initializes weights with uniform distribution centered in zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">activation_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span> <span class="c1"># instead of Heaviside step fn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_activation_fn</span> <span class="o">=</span> <span class="n">use_activation_fn</span> <span class="c1"># If we want to use an activation function</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_activation_fn</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation_fn</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="c1"># To add the non-linearity. Try training you Perceptron with and without the non-linearity</span>
        <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[143]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create percetron</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Perceptron</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span> <span class="n">use_activation_fn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[144]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="n">epoch</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">all_loss</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epoch</span><span class="p">):</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="c1"># Forward pass</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="c1"># Compute Loss</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Backward pass</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="n">all_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[145]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">all_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[145]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f72adb26430&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_04Perceptron_pred_clean_24_1.png" src="../_images/CASESTUDY_Tree_Height_04Perceptron_pred_clean_24_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[146]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">after_train</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test loss after Training&#39;</span> <span class="p">,</span> <span class="n">after_train</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;slope: </span><span class="si">{:.3f}</span><span class="s1">, r_value: </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">r_value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Test loss after Training 0.009606563486158848
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_04Perceptron_pred_clean_25_1.png" src="../_images/CASESTUDY_Tree_Height_04Perceptron_pred_clean_25_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Tree_Height_04Perceptron_pred.html" class="btn btn-neutral float-left" title="Estimation of tree height using GEDI dataset - Perceptron 1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Tree_Height_05NeuralNets_pred.html" class="btn btn-neutral float-right" title="Estimation of tree height using GEDI dataset - Perceptron 2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Giuseppe Amatulli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>