

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Temporal interpolation of landsat images &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="# NP Modelling" href="122_pred_NP.html" />
    <link rel="prev" title="Data type in GTiff" href="120_Data_type_GTiff.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Spatial Ecology's code documentation
          

          
            
            <img src="../_static/SE_compact.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
</ul>
<p class="caption"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/00_Setting_Colab_for_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/00_Setting_OSGeoLive_for_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
</ul>
<p class="caption"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../BASH/03_bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/03_bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/03_bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../AWK/30_awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/01_gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/01_gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/02_pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/02_pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
</ul>
<p class="caption"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../R/05_R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/01_Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/02_Geo_Python.html">Python &amp; GeoComputation</a></li>
</ul>
<p class="caption"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_intro.html">GRASS Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">CASE STUDY</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="101_SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="101_SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="101_SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="110_manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="120_Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Temporal interpolation of landsat images</a></li>
<li class="toctree-l1"><a class="reference internal" href="122_pred_NP.html"># NP Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="122_pred_NP.html#BackGround">BackGround</a></li>
<li class="toctree-l1"><a class="reference internal" href="122_pred_NP.html#Code">Code</a></li>
</ul>
<p class="caption"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/video.html">Video tips</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spatial Ecology's code documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Temporal interpolation of landsat images</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/CASESTUDY/121_temporal_interpolation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Temporal-interpolation-of-landsat-images">
<h1>Temporal interpolation of landsat images<a class="headerlink" href="#Temporal-interpolation-of-landsat-images" title="Permalink to this headline">¶</a></h1>
<p>The Landsat Analysis Ready Data (GLAD ARD) developed by the Global Land Analysis and Discovery (GLAD) provides spatially and temporally consistent inputs for land cover mapping and change detection. The GLAD ARD represent a 16-day time-series of tiled Landsat normalized surface reflectance from 1997 to present (source <a class="reference external" href="https://glad.umd.edu/book/overview">https://glad.umd.edu/book/overview</a>).</p>
<p>The GLAD ARD data can be download from the <a class="reference external" href="https://glad.umd.edu/dataset/landsat_v1.1/">https://glad.umd.edu/dataset/landsat_v1.1/</a> previous autentifcation. For this exercise we are going to use a portion of TILE 015E_38N, which is located in the south of Italy (Sicily), for the year <strong>2018, 2019, 2020</strong>.</p>
<p>The temporal series for each tile is labeled following this numerical nomenclature.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> head -43  geodata/glad_ard/16d_intervals.csv  <span class="p">|</span> tail -6
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874
2018 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897
2019 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 920
2020 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943
2021 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966
2022 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989
</pre></div></div>
</div>
<p>Where the first column identify the year, and the others the 16-day time-series.</p>
<p>For example the below figure depict three images for the <strong>876, 899, 922</strong> time-frame (second 16-day time-serie).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/glad_ard_876_899_922_crop.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_3_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_3_0.png" />
</div>
</div>
<div class="section" id="Data-download">
<h2>Data download<a class="headerlink" href="#Data-download" title="Permalink to this headline">¶</a></h2>
<p>Per convenience the images have been downloaded and cropped already with the following lines.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for INTER in $(grep -e ^2018 -e ^2019 -e ^2020 geodata/glad_ard//16d_intervals.csv | awk &#39;{ $1=&quot;&quot;; print $0}&#39;) ; do
curl --connect-timeout 600 -u user:password -X GET https://glad.umd.edu/dataset/landsat_v1.1/38N/015E_38N/$INTER.tif -o geodata/glad_ard/$INTER.tif
gdal_translate -co COMPRESS=DEFLATE -co ZLEVEL=9  -projwin 15.24 38.11 15.34 38 geodata/glad_ard/$INTER.tif geodata/glad_ard/${INTER}_crop.tif
done
</pre></div>
</div>
</div>
<div class="section" id="Image-characteristics">
<h2>Image characteristics<a class="headerlink" href="#Image-characteristics" title="Permalink to this headline">¶</a></h2>
<p>The images have the following characteristic:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> gdalinfo -mm   geodata/glad_ard/922_crop.tif
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Driver: GTiff/GeoTIFF
Files: geodata/glad_ard/922_crop.tif
Size is 400, 440
Coordinate System is:
GEOGCRS[&#34;WGS 84&#34;,
    DATUM[&#34;World Geodetic System 1984&#34;,
        ELLIPSOID[&#34;WGS 84&#34;,6378137,298.257223563,
            LENGTHUNIT[&#34;metre&#34;,1]]],
    PRIMEM[&#34;Greenwich&#34;,0,
        ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&#34;geodetic latitude (Lat)&#34;,north,
            ORDER[1],
            ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
        AXIS[&#34;geodetic longitude (Lon)&#34;,east,
            ORDER[2],
            ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
    ID[&#34;EPSG&#34;,4326]]
Data axis to CRS axis mapping: 2,1
Origin = (15.240000000000000,38.109999999999999)
Pixel Size = (0.000250000000000,-0.000250000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  15.2400000,  38.1100000) ( 15d14&#39;24.00&#34;E, 38d 6&#39;36.00&#34;N)
Lower Left  (  15.2400000,  38.0000000) ( 15d14&#39;24.00&#34;E, 38d 0&#39; 0.00&#34;N)
Upper Right (  15.3400000,  38.1100000) ( 15d20&#39;24.00&#34;E, 38d 6&#39;36.00&#34;N)
Lower Right (  15.3400000,  38.0000000) ( 15d20&#39;24.00&#34;E, 38d 0&#39; 0.00&#34;N)
Center      (  15.2900000,  38.0550000) ( 15d17&#39;24.00&#34;E, 38d 3&#39;18.00&#34;N)
Band 1 Block=400x1 Type=UInt16, ColorInterp=Gray
    Computed Min/Max=1.000,10685.000
Band 2 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=707.000,11421.000
Band 3 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=597.000,12197.000
Band 4 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=1448.000,22767.000
Band 5 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=2175.000,17715.000
Band 6 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=1665.000,13789.000
Band 7 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=26477.000,30289.000
Band 8 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=1.000,14.000
</pre></div></div>
</div>
<p><strong>Bands features</strong></p>
<ul class="simple">
<li><p>1 Normalized surface reflectance of blue band</p></li>
<li><p>2 Normalized surface reflectance of green band</p></li>
<li><p>3 Normalized surface reflectance of red band</p></li>
<li><p>4 Normalized surface reflectance of NIR band</p></li>
<li><p>5 Normalized surface reflectance of SWIR1 band</p></li>
<li><p>6 Normalized surface reflectance of SWIR2 band</p></li>
<li><p>7 Normalized brightness temperature</p></li>
<li><p>8 Observation quality code (QA)</p></li>
</ul>
<p><strong>The band 8 include a Quality Assessment (QA) code</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 44%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>QA code</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Quality</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Nodata</p></td>
<td><p>stripes and out of the image</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Land</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Water</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Cloud</p></td>
<td><p>cloud contaminated</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Cloud shadow</p></td>
<td><p>shadow contaminated</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Hillshade</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Snow</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>Haze</p></td>
<td><p>cloud contaminated</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>Cloud buffer</p></td>
<td><p>cloud contaminated</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>Shadow buffer</p></td>
<td><p>shadow contaminated</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>Shadow high likelihood</p></td>
<td><p>shadow contaminated</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>Additional cloud buffer over land</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>Additional cloud buffer over water</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Additional shadow buffer over land</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>Land, water detected but not used</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>Additional cloud buffer over land, water detected but not used</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>Additional shadow buffer over land, water detected but not used</p></td>
<td><p>lear-sky</p></td>
</tr>
</tbody>
</table>
<p>The band 8 can be used to mask out areas that do not belong to land (QA=1) and water (QA=2) class.</p>
<p>In the below figures we use the same images than before and we apply a masking procedure using the band 8. The black part has pixel value equal to 0 and is labled as NoData</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/glad_ard_876_899_922_crop_msk.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_7_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_7_0.png" />
</div>
</div>
<p>We decided to compute a temporal median in order to reduce the area with no data. In other words we have combined the images that belong to the same period (876, 899, 922) and select the median value. During the opearion we use the band 8 to select only good-quality pixels.</p>
</div>
<div class="section" id="Temporal-composite">
<h2>Temporal composite<a class="headerlink" href="#Temporal-composite" title="Permalink to this headline">¶</a></h2>
<p>For each of the 16-day time-series we composite the 3 images (from the year 2018,2019,2020) taking median among them. The composite has been done by retaining from band 8 (-bndnodata 7) only pixels that belong to land (QA=1) or water (QA=2)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="nb">echo</span> <span class="m">01</span> <span class="m">02</span> <span class="m">03</span> <span class="m">04</span> <span class="m">05</span> <span class="m">06</span> <span class="m">07</span> <span class="m">08</span> <span class="m">09</span> <span class="k">$(</span> seq <span class="m">10</span> <span class="m">23</span> <span class="k">)</span>   <span class="p">|</span> xargs -n <span class="m">1</span> -P <span class="m">2</span>  bash -c <span class="s1">$&#39;</span>
<span class="s1">day=$1</span>

<span class="s1">## median composite</span>
<span class="s1">pkcomposite $( grep -e ^2019 -e ^2020 -e ^2018 geodata/glad_ard/16d_intervals.csv | awk -v day=$day \</span>
<span class="s1">\&#39;{ print $(day+1)  }\&#39; |  xargs  -I {}  -n 1 ls geodata/glad_ard/{}_crop.tif | xargs  -I {}  -n 1 echo -i  {}  ) \</span>
<span class="s1">-ot UInt16 -co COMPRESS=LZW -co ZLEVEL=9  -cr median -dstnodata 0  -bndnodata 7 \</span>
<span class="s1">-srcnodata 0  -srcnodata 3  -srcnodata 4 -srcnodata 5 -srcnodata 6 -srcnodata 7 -srcnodata 8 -srcnodata 9 \</span>
<span class="s1">-srcnodata 10 -srcnodata 11 -srcnodata 12 -srcnodata 13 -srcnodata 14 -srcnodata 15  -srcnodata 16 -srcnodata 17 \</span>
<span class="s1">-o geodata/glad_ard/median_$day.tif</span>

<span class="s1">##### The obtaine mosaic still contains 8 bands. Therefore we run gdal_translate to select only 6 bands</span>

<span class="s1">gdal_translate  -co COMPRESS=LZW -co ZLEVEL=9 -b 1 -b 2 -b 3 -b 4 -b 5 -b 6 -a_nodata 0 \</span>
<span class="s1">geodata/glad_ard/median_$day.tif  geodata/glad_ard/median_${day}_6bs.tif</span>
<span class="s1">rm geodata/glad_ard/median_$day.tif</span>
<span class="s1">&#39;</span> _
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
00...10.....20...10.30......40.20...50.....3060......7040......80.50....90....100 - done.
Input file size is 400, 440
0...10...20...30...40...5060...60...70...80...90...100 - done.
0......10..70..20.....3080.....40..90...50....100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
.0..60.10.....20....7030.....40..80...50.....9060......70100 - done.
.Input file size is 400, 440
0...10...20...30...40...50....60...70...80...90...100 - done.
0...80..10.....2090....30.....40100 - done.
Input file size is 400, 440
0....10...20...30...40...50.....60...70...80...90...100 - done.
500.....10....6020....30....40...70.50......8060.....90....70.100 - done.
.Input file size is 400, 440
0....10...20...30...40...5080...60...70...80...90...100 - done.
.0.....10.90...20.....30...40100 - done.
.Input file size is 400, 440
0....10...20...30...40...50.50....60...70...80...90...100 - done.
..060....10....20....3070....40.....8050......6090......70...80100 - done.
..Input file size is 400, 440
0.90...10...20...30...40...50......60...70...80...90...100 - done.
0...100 - done.
10Input file size is 400, 440
0.....10...20...30...40...50.20...60...70...80...90...100 - done.
.0.....1030.....20...40.30......40.50.....60.50....70...60....8070......8090......90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50100 - done.
Input file size is 400, 440
0...60...70...80...90...100 - done.
...10...20...30...40...500.....60...70...80...90...100 - done.
.10..0...20..10....30.20......4030......5040......6050.....70..60....80..70....90..80.....90.100 - done.
..Input file size is 400, 440
0...10...20...30...40...50100 - done.
...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...500......60...70...80...90...100 - done.
10..0...20..10.....3020......4030......4050......5060.....60..70....70..80....80...90..90.....100 - done.
Input file size is 400, 440
0100 - done.
Input file size is 400, 440
0...10...20...30...40...50...10...20...30...40...50...60...70...80...90...100 - done.
...60...70...80...90...100 - done.
0..0....10..10...20.20....30....40....3050....60.....4070......8050......60.90.....70...80100 - done.
.Input file size is 400, 440
0.....10...20...30...40...5090......60...70...80...90...100 - done.
0.100 - done.
Input file size is 400, 440
0....10...20...30...40...50.10...60...70...80...90...100 - done.
0.....20...10.30......40.20...50.....6030.....70....80...4090....100 - done.
Input file size is 400, 440
0...10...20...30...40...50....60...70...80...90...100 - done.
0..50...10....60.20......7030......8040.....90..50....100 - done.
Input file size is 400, 440
0...10...20...30...40...50....60...70...80...90...100 - done.
060....10....20....30.70..40....50...60....70....80.80..90.....100 - done.
Input file size is 400, 440
0....10...20...30...40...50...60...70...80...90...100 - done.
090......10100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
.0....10....2020......30.30...40.....5040.....60..50....70.60.....80.70.....90..80...100 - done.
.Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
.090......100 - done.
Input file size is 400, 440
010...10...20...30...40...50...60...70...80...90...100 - done.
...20...30...40...50...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
<p>After the temporal composite some images present areas with NoData.</p>
<p>Below the results of the median aggregation of the previus 3 images.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/glad_ard_median_02_6bs.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_12_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_12_0.png" />
</div>
</div>
</div>
<div class="section" id="Temporal-interpolation">
<h2>Temporal interpolation<a class="headerlink" href="#Temporal-interpolation" title="Permalink to this headline">¶</a></h2>
<p>We re-fill (gap-filling) all the area labeled as NoData=0 (black area in the above immages) using temporal interpolation by means of <a class="reference external" href="https://en.wikipedia.org/wiki/Akima_spline">Akima</a> and <a class="reference external" href="https://www.weatherclasses.com/uploads/1/3/1/3/131359169/steffen_interpolation_paper.pdf">Steffen</a> algorithm.</p>
<p><a class="reference external" href="http://spatial-ecology.net/docs/source/lectures/lect_20210429_Approximation.pdf">Approximation</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="c1"># for semplicity we concentrate in only on band 1</span>
<span class="nb">echo</span> <span class="m">1</span>  <span class="p">|</span> xargs -n <span class="m">1</span> -P <span class="m">1</span>  bash -c <span class="s1">$&#39;</span>
<span class="s1">B=$1 # band</span>

<span class="s1">## extract one band for all the 16-day time-series</span>
<span class="s1">for day in 01 02 03 04 05 06 07 08 09 $( seq 10 23 ) ; do</span>
<span class="s1">gdalbuildvrt -srcnodata 0 -vrtnodata 0 -overwrite -b $B geodata/glad_ard/median_${day}_${B}b.vrt \</span>
<span class="s1">geodata/glad_ard/median_${day}_6bs.tif</span>
<span class="s1">done</span>

<span class="s1">## replicate 3 times the 16-day time-series to avoid temporal border effect</span>
<span class="s1">gdalbuildvrt -srcnodata 0 -vrtnodata 0 -separate  -overwrite geodata/glad_ard/median_tseries_${B}b.vrt \</span>
<span class="s1">geodata/glad_ard/median_??_${B}b.vrt geodata/glad_ard/median_??_${B}b.vrt geodata/glad_ard/median_??_${B}b.vrt</span>

<span class="s1">## gap filling with the akima spline</span>
<span class="s1">pkfilter -of GTiff -co COMPRESS=LZW -co ZLEVEL=9 -nodata 0 -f smoothnodata -dz 1 -interp akima \</span>
<span class="s1">-i geodata/glad_ard/median_tseries_${B}b.vrt -o geodata/glad_ard/median_akima_${B}b_tmp.tif</span>

<span class="s1">## reselecto only the 16-day time-series in the center</span>
<span class="s1">gdal_translate  -co COMPRESS=LZW -co ZLEVEL=9 $(for b in $(seq 24 46); do echo &quot;-b $b&quot; ; done) \</span>
<span class="s1">geodata/glad_ard/median_akima_${B}b_tmp.tif geodata/glad_ard/median_akima_${B}b.tif</span>
<span class="s1">rm geodata/glad_ard/median_akima_${B}b_tmp.tif</span>

<span class="s1">## gap filling with the steffen spline</span>
<span class="s1">pkfilter -of GTiff -co COMPRESS=LZW -co ZLEVEL=9 -nodata 0 -f smoothnodata -dz 1 -interp steffen \</span>
<span class="s1">-i geodata/glad_ard/median_tseries_${B}b.vrt -o geodata/glad_ard/median_steffen_${B}b_tmp.tif</span>

<span class="s1">## reselecto only the 16-day time-series in the center</span>
<span class="s1">gdal_translate  -co COMPRESS=LZW -co ZLEVEL=9 $(for b in $(seq 24 46); do echo &quot;-b $b&quot; ; done) \</span>
<span class="s1">geodata/glad_ard/median_steffen_${B}b_tmp.tif geodata/glad_ard/median_steffen_${B}b.tif</span>
<span class="s1">rm geodata/glad_ard/median_steffen_${B}b_tmp.tif</span>
<span class="s1">&#39;</span> _
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
opening output image geodata/glad_ard/median_akima_1b_tmp.tif with 69 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
opening output image geodata/glad_ard/median_steffen_1b_tmp.tif with 69 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
<p>At this point all the immages have been re-fill.</p>
</div>
<div class="section" id="Plotting-the-temporal-interpolation-for-band-1">
<h2>Plotting the temporal interpolation for band 1<a class="headerlink" href="#Plotting-the-temporal-interpolation-for-band-1" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
R --vanilla -q
<span class="c1"># open a terminal and run this line for the installation</span>
<span class="c1"># install.packages(&quot;Rcpp&quot;)</span>
<span class="c1"># install.packages(&quot;rgdal&quot;)</span>
<span class="c1"># install.packages(&quot;raster&quot;)</span>
library<span class="o">(</span>sp<span class="o">)</span>
library<span class="o">(</span>raster<span class="o">)</span>
<span class="nv">stack</span> <span class="o">=</span> stack<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/median_steffen_1b.tif&quot;</span><span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/median_steffen_1b.png&quot;</span><span class="o">)</span>
<span class="nv">pal</span> <span class="o">=</span> colorRampPalette<span class="o">(</span>rev<span class="o">(</span>rainbow<span class="o">(</span><span class="m">20</span><span class="o">)))</span>
plot<span class="o">(</span>stack , <span class="nv">col</span><span class="o">=</span>pal<span class="o">(</span><span class="m">20</span><span class="o">))</span>
dev.off<span class="o">()</span>
<span class="nv">stack</span> <span class="o">=</span> stack<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/median_tseries_1b.vrt&quot;</span><span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/median_tseries_1b.png&quot;</span><span class="o">)</span>
<span class="nv">pal</span> <span class="o">=</span> colorRampPalette<span class="o">(</span>rev<span class="o">(</span>rainbow<span class="o">(</span><span class="m">20</span><span class="o">)))</span>
plot<span class="o">(</span>stack , <span class="nv">col</span><span class="o">=</span>pal<span class="o">(</span><span class="m">20</span><span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; # open a terminal and run this line for the installation
&gt; # install.packages(&#34;Rcpp&#34;)
&gt; # install.packages(&#34;rgdal&#34;)
&gt; # install.packages(&#34;raster&#34;)
&gt; library(sp)
&gt; library(raster)
&gt; stack = stack(&#34;geodata/glad_ard/median_steffen_1b.tif&#34;)
&gt; png(&#34;../images/median_steffen_1b.png&#34;)
&gt; pal = colorRampPalette(rev(rainbow(20)))
&gt; plot(stack , col=pal(20))
&gt; dev.off()
null device
          1
&gt; stack = stack(&#34;geodata/glad_ard/median_tseries_1b.vrt&#34;)
&gt; png(&#34;../images/median_tseries_1b.png&#34;)
&gt; pal = colorRampPalette(rev(rainbow(20)))
&gt; plot(stack , col=pal(20))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<p><strong>Before interpolation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/median_tseries_1b.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_18_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_18_0.png" />
</div>
</div>
<p><strong>After interpolation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/median_steffen_1b.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_20_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_20_0.png" />
</div>
</div>
</div>
<div class="section" id="Assessing-the-temporal-interpolation">
<h2>Assessing the temporal interpolation<a class="headerlink" href="#Assessing-the-temporal-interpolation" title="Permalink to this headline">¶</a></h2>
<p>We select one pixel in the images and we plot its values acros time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">echo</span> <span class="s2">&quot;day tseries akima steffen&quot;</span> &gt; geodata/glad_ard/day_orig_akima_steffen.txt
paste -d <span class="s2">&quot; &quot;</span> &lt;<span class="o">(</span><span class="k">for</span> day in  <span class="m">01</span> <span class="m">02</span> <span class="m">03</span> <span class="m">04</span> <span class="m">05</span> <span class="m">06</span> <span class="m">07</span> <span class="m">08</span> <span class="m">09</span> <span class="k">$(</span>seq <span class="m">10</span> <span class="m">23</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span>  expr <span class="nv">$day</span> <span class="se">\*</span> <span class="m">16</span> - <span class="m">8</span> <span class="p">;</span> <span class="k">done</span><span class="o">)</span> <span class="se">\</span>
 &lt;<span class="o">(</span>gdallocationinfo -valonly -geoloc geodata/glad_ard/median_tseries_1b.vrt       <span class="m">15</span>.2866 <span class="m">38</span>.0539 <span class="p">|</span> head -23 <span class="o">)</span> <span class="se">\</span>
 &lt;<span class="o">(</span>gdallocationinfo -valonly -geoloc geodata/glad_ard/median_akima_1b.tif         <span class="m">15</span>.2866 <span class="m">38</span>.0539<span class="o">)</span><span class="se">\</span>
 &lt;<span class="o">(</span>gdallocationinfo -valonly -geoloc geodata/glad_ard/median_steffen_1b.tif <span class="m">15</span>.2866 <span class="m">38</span>.0539<span class="o">)</span> <span class="se">\</span>
 &gt;&gt; geodata/glad_ard/day_orig_akima_steffen.txt
</pre></div>
</div>
</div>
<p>We obtained a table with 4 Columns. The zero in the second column rapresent No-Data and is the one that we had interpolated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> cat geodata/glad_ard/day_orig_akima_steffen.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
day tseries akima steffen
8 0 1028 1056
24 0 1176 1182
40 1309 1309 1309
56 0 1427 1416
72 0 1538 1522
88 1629 1629 1629
104 1554 1554 1554
120 1577 1577 1577
136 1370 1370 1370
152 1465 1465 1465
168 1466 1466 1466
184 1412 1412 1412
200 1342 1342 1342
216 1239 1239 1239
232 1376 1376 1376
248 1479 1479 1479
264 0 1421 1351
280 0 1277 1224
296 0 1107 1096
312 968 968 968
328 0 843 885
344 802 802 802
360 0 894 929
</pre></div></div>
</div>
<p>We import in R for plotting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
R --vanilla -q
<span class="nv">tseries</span> <span class="o">=</span> read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_orig_akima_steffen.txt&quot;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span> , <span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
str<span class="o">(</span>tseries<span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/plot_interpolation1.png&quot;</span><span class="o">)</span>
plot<span class="o">(</span>tseries<span class="nv">$day</span>, tseries<span class="nv">$tseries</span>, <span class="nv">pch</span><span class="o">=</span><span class="m">4</span>, <span class="nv">cex</span><span class="o">=</span><span class="m">2</span>, <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span>, <span class="nv">xlab</span><span class="o">=(</span><span class="s2">&quot;Day of the year&quot;</span><span class="o">)</span>, <span class="nv">ylab</span><span class="o">=(</span><span class="s2">&quot;Spectral digital number&quot;</span><span class="o">)</span> <span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span>, tseries<span class="nv">$steffen</span>, <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span>, <span class="nv">pch</span><span class="o">=</span><span class="m">19</span> <span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span>, tseries<span class="nv">$akima</span>, <span class="nv">pch</span><span class="o">=</span><span class="m">1</span> <span class="o">)</span>
legend<span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">1</span>,y<span class="o">=</span><span class="m">700</span>,c<span class="o">(</span><span class="s2">&quot;Original&quot;</span>,<span class="s2">&quot;Steffen interp&quot;</span>,<span class="s2">&quot;Akima interp&quot;</span><span class="o">)</span>,cex<span class="o">=</span><span class="m">1</span>.4,col<span class="o">=</span>c<span class="o">(</span><span class="s2">&quot;blue&quot;</span>,<span class="s2">&quot;red&quot;</span>,<span class="s2">&quot;black&quot;</span><span class="o">)</span>,pch<span class="o">=</span>c<span class="o">(</span><span class="m">4</span>,19,1<span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; tseries = read.table(&#34;geodata/glad_ard/day_orig_akima_steffen.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; str(tseries)
&#39;data.frame&#39;:   23 obs. of  4 variables:
 $ day    : int  8 24 40 56 72 88 104 120 136 152 ...
 $ tseries: int  0 0 1309 0 0 1629 1554 1577 1370 1465 ...
 $ akima  : int  1028 1176 1309 1427 1538 1629 1554 1577 1370 1465 ...
 $ steffen: int  1056 1182 1309 1416 1522 1629 1554 1577 1370 1465 ...
&gt; png(&#34;../images/plot_interpolation1.png&#34;)
&gt; plot(tseries$day, tseries$tseries, pch=4, cex=2, col=&#34;blue&#34;, xlab=(&#34;Day of the year&#34;), ylab=(&#34;Spectral digital number&#34;) )
&gt; points(tseries$day, tseries$steffen, col=&#34;red&#34;, pch=19 )
&gt; points(tseries$day, tseries$akima, pch=1 )
&gt; legend(x=1,y=700,c(&#34;Original&#34;,&#34;Steffen interp&#34;,&#34;Akima interp&#34;),cex=1.4,col=c(&#34;blue&#34;,&#34;red&#34;,&#34;black&#34;),pch=c(4,19,1))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/plot_interpolation1.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_27_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_27_0.png" />
</div>
</div>
<p>You can noticed that Steffen and Akima present same differences only in the interpolated pixels. The orginal values have been kept constant for both method.</p>
</div>
<div class="section" id="Savitzky–Golay-smoothing-filter">
<h2>Savitzky–Golay smoothing filter<a class="headerlink" href="#Savitzky–Golay-smoothing-filter" title="Permalink to this headline">¶</a></h2>
<p>We can use the Savitzky–Golay filter to smooth out the spectral response.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/Savitzky_Golay.gif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;IPython.core.display.Image object&gt;
</pre></div></div>
</div>
<p>Run Savitzky–Golay smoothing filter</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="nb">echo</span> <span class="m">1</span> <span class="p">|</span> xargs -n <span class="m">1</span> -P <span class="m">1</span>  bash -c <span class="s1">$&#39;</span>
<span class="s1">B=$1</span>
<span class="s1">pkfilter -co COMPRESS=LZW -co ZLEVEL=9 -f savgolay -nl 3 -nr 3 -m 2 -pad replicate -i geodata/glad_ard/median_akima_${B}b.tif -o geodata/glad_ard/median_savgolay_${B}b.tif</span>
<span class="s1">&#39;</span> _
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
opening output image geodata/glad_ard/median_savgolay_1b.tif with 23 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
</div>
<div class="section" id="Assessing-the-Savitzky–Golay-smoothing-filter">
<h2>Assessing the Savitzky–Golay smoothing filter<a class="headerlink" href="#Assessing-the-Savitzky–Golay-smoothing-filter" title="Permalink to this headline">¶</a></h2>
<p>We use the lat lon location to extract the value for the Savitzky–Golay smoothing filter and we plot against the previus values</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">echo</span> <span class="s2">&quot;savgolay&quot;</span> &gt; geodata/glad_ard/savgolay.txt
gdallocationinfo -valonly -geoloc geodata/glad_ard/median_savgolay_1b.tif <span class="m">15</span>.2866 <span class="m">38</span>.0539  &gt;&gt; geodata/glad_ard/savgolay.txt
paste -d <span class="s2">&quot; &quot;</span> geodata/glad_ard/day_orig_akima_steffen.txt geodata/glad_ard/savgolay.txt &gt; geodata/glad_ard/day_orig_akima_steffen_savgolay.txt
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> cat geodata/glad_ard/day_orig_akima_steffen_savgolay.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
day tseries akima steffen savgolay
8 0 1028 1056 1072
24 0 1176 1182 1166
40 1309 1309 1309 1294
56 0 1427 1416 1444
72 0 1538 1522 1533
88 1629 1629 1629 1600
104 1554 1554 1554 1574
120 1577 1577 1577 1517
136 1370 1370 1370 1468
152 1465 1465 1465 1450
168 1466 1466 1466 1430
184 1412 1412 1412 1398
200 1342 1342 1342 1330
216 1239 1239 1239 1328
232 1376 1376 1376 1374
248 1479 1479 1479 1418
264 0 1421 1351 1406
280 0 1277 1224 1286
296 0 1107 1096 1117
312 968 968 968 956
328 0 843 885 866
344 802 802 802 839
360 0 894 929 853
</pre></div></div>
</div>
<p>We import in R for plotting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
R --vanilla -q
<span class="nv">tseries</span> <span class="o">=</span> read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&quot;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span> , <span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
str<span class="o">(</span>tseries<span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/plot_interpolation2.png&quot;</span><span class="o">)</span>
plot<span class="o">(</span>tseries<span class="nv">$day</span> ,  tseries<span class="nv">$tseries</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">4</span> , <span class="nv">cex</span> <span class="o">=</span> <span class="m">2</span> , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span> , <span class="nv">xlab</span><span class="o">=(</span><span class="s2">&quot;Day of the year&quot;</span><span class="o">)</span> , <span class="nv">ylab</span><span class="o">=(</span><span class="s2">&quot;Spectral digital number&quot;</span><span class="o">)</span> <span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span> , tseries<span class="nv">$steffen</span>  , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">19</span> <span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span> , tseries<span class="nv">$akima</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">1</span> <span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span> , tseries<span class="nv">$savgolay</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">3</span> , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">)</span>
legend<span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">1</span>,y<span class="o">=</span><span class="m">700</span>,c<span class="o">(</span><span class="s2">&quot;Original&quot;</span>,<span class="s2">&quot;Steffen interp&quot;</span>,<span class="s2">&quot;Akima interp&quot;</span>,<span class="s2">&quot;Savitzky-Golay smoothness&quot;</span><span class="o">)</span>,cex<span class="o">=</span><span class="m">1</span>.4,col<span class="o">=</span>c<span class="o">(</span><span class="s2">&quot;blue&quot;</span>,<span class="s2">&quot;red&quot;</span>,<span class="s2">&quot;black&quot;</span>,col<span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">)</span>,pch<span class="o">=</span>c<span class="o">(</span><span class="m">4</span>,19,1,3<span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; tseries = read.table(&#34;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; str(tseries)
&#39;data.frame&#39;:   23 obs. of  5 variables:
 $ day     : int  8 24 40 56 72 88 104 120 136 152 ...
 $ tseries : int  0 0 1309 0 0 1629 1554 1577 1370 1465 ...
 $ akima   : int  1028 1176 1309 1427 1538 1629 1554 1577 1370 1465 ...
 $ steffen : int  1056 1182 1309 1416 1522 1629 1554 1577 1370 1465 ...
 $ savgolay: int  1072 1166 1294 1444 1533 1600 1574 1517 1468 1450 ...
&gt; png(&#34;../images/plot_interpolation2.png&#34;)
&gt; plot(tseries$day ,  tseries$tseries , pch=4 , cex = 2 , col=&#34;blue&#34; , xlab=(&#34;Day of the year&#34;) , ylab=(&#34;Spectral digital number&#34;) )
&gt; points(tseries$day , tseries$steffen  , col=&#34;red&#34; , pch=19 )
&gt; points(tseries$day , tseries$akima , pch=1 )
&gt; points(tseries$day , tseries$savgolay , pch=3 , col=&#34;green&#34;)
&gt; legend(x=1,y=700,c(&#34;Original&#34;,&#34;Steffen interp&#34;,&#34;Akima interp&#34;,&#34;Savitzky-Golay smoothness&#34;),cex=1.4,col=c(&#34;blue&#34;,&#34;red&#34;,&#34;black&#34;,col=&#34;green&#34;),pch=c(4,19,1,3))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/plot_interpolation2.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_38_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_38_0.png" />
</div>
</div>
</div>
<div class="section" id="Wavelet-prediction">
<h2>Wavelet prediction<a class="headerlink" href="#Wavelet-prediction" title="Permalink to this headline">¶</a></h2>
<p>We use the Wavelet tecnique to predic the value for the 15 of each month</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="nb">echo</span> <span class="m">1</span> <span class="p">|</span> xargs -n <span class="m">1</span> -P <span class="m">1</span>  bash -c <span class="s1">$&#39;</span>
<span class="s1">B=$1</span>
<span class="s1">pkfilter -of GTiff -co COMPRESS=LZW -co ZLEVEL=9 \</span>
<span class="s1">$(for day in  01 02 03 04 05 06 07 08 09 $( seq 10 23 )  ; do  echo &quot;-win&quot;  $(expr $day \\* 16  - 8) ; done) \</span>
<span class="s1">$(for day in  01 02 03 04 05 06 07 08 09 10 11 12   ; do  echo &quot;-wout&quot;  $(expr $day \\* 31  - 15) &quot;-fwhm&quot; 50  ; done  )  \</span>
<span class="s1">-i geodata/glad_ard/median_akima_${B}b.tif  -o geodata/glad_ard/median_akima_wavelet_${B}b.tif</span>
<span class="s1">&#39;</span> _
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
opening output image geodata/glad_ard/median_akima_wavelet_1b.tif with 12 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">echo</span> <span class="s2">&quot;day wavelet&quot;</span> &gt; geodata/glad_ard/day_wavelet.txt
paste -d <span class="s2">&quot; &quot;</span> &lt;<span class="o">(</span>  <span class="k">for</span> day in  <span class="m">01</span> <span class="m">02</span> <span class="m">03</span> <span class="m">04</span> <span class="m">05</span> <span class="m">06</span> <span class="m">07</span> <span class="m">08</span> <span class="m">09</span> <span class="m">10</span> <span class="m">11</span> <span class="m">12</span>   <span class="p">;</span> <span class="k">do</span>    expr <span class="nv">$day</span> <span class="se">\*</span> <span class="m">31</span>  - <span class="m">15</span>  <span class="p">;</span> <span class="k">done</span>   <span class="o">)</span> <span class="se">\</span>
&lt;<span class="o">(</span>gdallocationinfo -valonly  -geoloc geodata/glad_ard/median_akima_wavelet_1b.tif <span class="m">15</span>.2866 <span class="m">38</span>.0539 <span class="o">)</span>  &gt;&gt; geodata/glad_ard/day_wavelet.txt
cat geodata/glad_ard/day_wavelet.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
day wavelet
16 1204
47 1363
78 1526
109 1542
140 1467
171 1424
202 1353
233 1369
264 1350
295 1129
326 915
357 842
</pre></div></div>
</div>
<p>We import in R for plotting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
R --vanilla -q
<span class="nv">tseries1</span> <span class="o">=</span> read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&quot;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span> , <span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
<span class="nv">tseries2</span> <span class="o">=</span> read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_wavelet.txt&quot;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span> , <span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/plot_interpolation3.png&quot;</span> <span class="o">)</span>
plot<span class="o">(</span>tseries1<span class="nv">$day</span> ,  tseries1<span class="nv">$tseries</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">4</span> , <span class="nv">cex</span> <span class="o">=</span> <span class="m">2</span> , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span> , <span class="nv">xlab</span><span class="o">=(</span><span class="s2">&quot;Day of the year&quot;</span><span class="o">)</span> , <span class="nv">ylab</span><span class="o">=(</span><span class="s2">&quot;Spectral digital number&quot;</span><span class="o">)</span> <span class="o">)</span>
points<span class="o">(</span>tseries1<span class="nv">$day</span> , tseries1<span class="nv">$steffen</span>  , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">19</span> <span class="o">)</span>
points<span class="o">(</span>tseries1<span class="nv">$day</span> , tseries1<span class="nv">$akima</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">1</span> <span class="o">)</span>
points<span class="o">(</span>tseries1<span class="nv">$day</span> , tseries1<span class="nv">$savgolay</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">3</span> , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">)</span>
points<span class="o">(</span>tseries2<span class="nv">$day</span> , tseries2<span class="nv">$wavelet</span> , <span class="nv">pch</span><span class="o">=</span><span class="m">5</span> , <span class="nv">col</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="o">)</span>
legend<span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">1</span>,y<span class="o">=</span><span class="m">700</span>,c<span class="o">(</span><span class="s2">&quot;Original&quot;</span>,<span class="s2">&quot;Steffen interp&quot;</span>,<span class="s2">&quot;Akima interp&quot;</span>,<span class="s2">&quot;Savitzky-Golay smoothness&quot;</span>,<span class="s2">&quot;Wavelet prediction&quot;</span><span class="o">)</span>,cex<span class="o">=</span><span class="m">1</span>.4,col<span class="o">=</span>c<span class="o">(</span><span class="s2">&quot;blue&quot;</span>,<span class="s2">&quot;red&quot;</span>,<span class="s2">&quot;black&quot;</span>,<span class="s2">&quot;green&quot;</span>,<span class="s2">&quot;orange&quot;</span><span class="o">)</span>,pch<span class="o">=</span>c<span class="o">(</span><span class="m">4</span>,19,1,3,5<span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; tseries1 = read.table(&#34;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; tseries2 = read.table(&#34;geodata/glad_ard/day_wavelet.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; png(&#34;../images/plot_interpolation3.png&#34; )
&gt; plot(tseries1$day ,  tseries1$tseries , pch=4 , cex = 2 , col=&#34;blue&#34; , xlab=(&#34;Day of the year&#34;) , ylab=(&#34;Spectral digital number&#34;) )
&gt; points(tseries1$day , tseries1$steffen  , col=&#34;red&#34; , pch=19 )
&gt; points(tseries1$day , tseries1$akima , pch=1 )
&gt; points(tseries1$day , tseries1$savgolay , pch=3 , col=&#34;green&#34;)
&gt; points(tseries2$day , tseries2$wavelet , pch=5 , col=&#34;orange&#34;)
&gt; legend(x=1,y=700,c(&#34;Original&#34;,&#34;Steffen interp&#34;,&#34;Akima interp&#34;,&#34;Savitzky-Golay smoothness&#34;,&#34;Wavelet prediction&#34;),cex=1.4,col=c(&#34;blue&#34;,&#34;red&#34;,&#34;black&#34;,&#34;green&#34;,&#34;orange&#34;),pch=c(4,19,1,3,5))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/plot_interpolation3.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_44_0.png" src="../build/doctrees/nbsphinx/CASESTUDY_121_temporal_interpolation_44_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="122_pred_NP.html" class="btn btn-neutral float-right" title="# NP Modelling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="120_Data_type_GTiff.html" class="btn btn-neutral float-left" title="Data type in GTiff" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Giuseppe Amatulli

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>