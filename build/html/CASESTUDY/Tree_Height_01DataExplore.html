<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estimation of tree height using GEDI dataset - Data explore &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR)" href="Tree_Height_02SVM_pred.html" />
    <link rel="prev" title="LSTM Network" href="NN-day3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Spatial Ecology's code documentation
            <img src="../_static/SE_compact.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2022.html">GeoComp &amp; ML 2022 course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_Colab_for_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_OSGeoLive_for_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_OSGeoLive_curso_para_Ecologia_Espacial.html">Prepare OSGeoLive para el curso de ecología espacial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../AWK/awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../R/R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Geo_Python.html">Python &amp; GeoComputation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_intro.html">GRASS Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_hydro.html">Using GRASS for stream-network extraction and basins delineation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CASE STUDY</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1"><a class="reference internal" href="temporal_interpolation.html">Temporal interpolation of landsat images</a></li>
<li class="toctree-l1"><a class="reference internal" href="DTW.html">Dynamic Time Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="pred_NP.html">Estimating nitrogen and phosphorus concentrations in streams and rivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day1.html">Estimating nitrogen concentrations in streams and rivers using NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day2.html">Autoencoder (AE), Variational Autoencoder (VAE) and Generative Adversarial Network (GAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day3.html">LSTM Network</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Estimation of tree height using GEDI dataset - Data explore</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Getting-the-dataset">Getting the dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#GEDI-features">GEDI features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Data-presentation">Data presentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Available-txt-files">Available txt files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Available-geo-raster-files">Available geo raster files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Geo-raster-files-description.">Geo raster files description.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Assessing-variable-autocorrelation">Assessing variable autocorrelation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_02SVM_pred.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_03RF_pred.html">Estimation of tree height using GEDI dataset - Random Forest prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04Perceptron_pred.html">Estimation of tree height using GEDI dataset - Perceptron 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04Perceptron_pred_clean.html">Estimation of tree height using GEDI dataset - Clean Data - Perceptron 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_05NeuralNets_pred.html">Estimation of tree height using GEDI dataset - Perceptron 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Students Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../STUDENTSPROJECTS/index.html">1. 2021 SWEDEN</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OUTDOOR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../OUTDOOR/outdoor_orientering.html">Do not get lost in the wilderness</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TALKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TALKS/intelligent_modelling.html">Intelligent modelling in time and space: combine GeoComputation and Machine Learning for  environmental application.</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/video.html">Video tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/Compiling_OTB.html">Compiling OTB from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spatial Ecology's code documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">&lt;no title&gt;</a> &raquo;</li>
      <li>Estimation of tree height using GEDI dataset - Data explore</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/CASESTUDY/Tree_Height_01DataExplore.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Estimation-of-tree-height-using-GEDI-dataset---Data-explore">
<h1>Estimation of tree height using GEDI dataset - Data explore<a class="headerlink" href="#Estimation-of-tree-height-using-GEDI-dataset---Data-explore" title="Permalink to this headline"></a></h1>
<section id="Getting-the-dataset">
<h2>Getting the dataset<a class="headerlink" href="#Getting-the-dataset" title="Permalink to this headline"></a></h2>
<p>For the here presented page donwolad the following dataset.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd ~/SE_data
git pull
rsync -hvrPt --ignore-existing ~/SE_data/* /media/sf_LVM_shared/my_SE_data
cd  /media/sf_LVM_shared/my_SE_data/exercise
pip install gdown
gdown --id 1Y60EuLsfmTICTX-U_FxcE1odNAf04bd-
tar -xvzf tree_height.tar.gz
source ~/juplab_env/bin/activate
## allow to use system python packages
sed &#39;s/false/true/g&#39; ~/juplab_env/pyvenv.cfg &gt; ~/juplab_env/pyvenv_tmp.cfg ;
mv ~/juplab_env/pyvenv_tmp.cfg ~/juplab_env/pyvenv.cfg
# install missing python libraries
pip3 install numpy==1.18
pip3 install ipywidgets --upgrade
pip3 install scikit-gstat
# start the jupter-lab
jupyter-lab Tree_Height_01DataExplore.ipynb
</pre></div>
</div>
</section>
<section id="GEDI-features">
<h2>GEDI features<a class="headerlink" href="#GEDI-features" title="Permalink to this headline"></a></h2>
<p>The Global Ecosystem Dynamics Investigation (GEDI) mission aims to characterize ecosystem structure and dynamics to enable radically improved quantification of biomass. The GEDI instrument, attached to the International Space Station (ISS), collects data globally between 51.6° N and 51.6° S latitudes at the highest resolution and densest sampling of the 3-dimensional structure of the Earth.</p>
<p>GEDI’s Level 2A Geolocated Elevation and Height Metrics Product (GEDI02_A) is primarily composed of Relative Height (RH) metrics of canopy height stored at different percentiles.</p>
<p>The GEDI02_A product is provided in HDF5 format and has a spatial resolution (average footprint) of 25 meters. The GEDI02_A data product contains 156 layers for each of the eight beams, including ground elevation, canopy top height, relative return energy metrics (e.g., canopy vertical structure), and many other interpreted products from the return waveforms.</p>
<p>The <a class="reference external" href="https://git.earthdata.nasa.gov/projects/LPDUR/repos/gedi-subsetter/browse">GEDI_Subsetter.py</a> allows the conversion of the HDF5 format in to txt files. During the conversion several parameters can be extracted. The full list can be found at <a class="reference external" href="https://lpdaac.usgs.gov/documents/982/gedi_l2a_dictionary_P003_v2.html">https://lpdaac.usgs.gov/documents/982/gedi_l2a_dictionary_P003_v2.html</a> , and a general description is stored at <a class="reference external" href="https://lpdaac.usgs.gov/documents/986/GEDI02_UserGuide_V2.pdf">https://lpdaac.usgs.gov/documents/986/GEDI02_UserGuide_V2.pdf</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show_hist</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">skgstat</span> <span class="k">as</span> <span class="nn">skg</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/tree_height_path_map.png&quot;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_4_0.png" class="no-scaled-link" src="../_images/CASESTUDY_Tree_Height_01DataExplore_4_0.png" style="width: 500px; height: 300px;" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/tree_height_study_area.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_5_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_5_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/tree_height_study_area_selected.png&quot;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_6_0.png" class="no-scaled-link" src="../_images/CASESTUDY_Tree_Height_01DataExplore_6_0.png" style="width: 500px; height: 300px;" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/tree_height_beam.jpg&quot;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_7_0.jpg" class="no-scaled-link" src="../_images/CASESTUDY_Tree_Height_01DataExplore_7_0.jpg" style="width: 500px; height: 300px;" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/tree_height_pulse_distribution.png&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_8_0.png" class="no-scaled-link" src="../_images/CASESTUDY_Tree_Height_01DataExplore_8_0.png" style="width: 600px; height: 300px;" />
</div>
</div>
</section>
<section id="Data-presentation">
<h2>Data presentation<a class="headerlink" href="#Data-presentation" title="Permalink to this headline"></a></h2>
<section id="Available-txt-files">
<h3>Available txt files<a class="headerlink" href="#Available-txt-files" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> ls tree_height/txt/*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tree_height/txt/eu_x_y_height_predictors_select.txt
tree_height/txt/eu_x_y_height_select.txt
tree_height/txt/eu_x_y_predictors_select.txt
tree_height/txt/eu_x_y_select.txt
tree_height/txt/eu_y_x_select_6algorithms_fullTable.txt
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> wc -l tree_height/txt/*
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  1267240 tree_height/txt/eu_x_y_height_predictors_select.txt
  1267240 tree_height/txt/eu_x_y_height_select.txt
  1267240 tree_height/txt/eu_x_y_predictors_select.txt
  1267239 tree_height/txt/eu_x_y_select.txt
  1267240 tree_height/txt/eu_y_x_select_6algorithms_fullTable.txt
  6336199 total
</pre></div></div>
</div>
<div class="line-block">
<div class="line"><strong>File storing point location (longitude and latitude).</strong></div>
<div class="line">Such file can be used with “gdallocationinfo” to extract enviromental predictor at each point. The points have been already clean by removing all the points that falls in agricolture area, urban/built-up area, and water. In the immage below those areas are labeled in white.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> head tree_height/txt/eu_x_y_select.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6.050001 49.727499
6.0500017 49.922155
6.0500021 48.602377
6.0500089 48.151979
6.0500102 49.58841
6.0500143 48.608456
6.0500165 48.571401
6.0500189 49.921613
6.0500201 48.822645
6.0500238 49.847522
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">points</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_vector/eu_x_y_height_select.gpkg&quot;</span><span class="p">)</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/treecover.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">rasterio</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">raster</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">points</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0812f99bb0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_15_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_15_1.png" />
</div>
</div>
<p><strong>File storing tree hight (cm) obtained by 6 algorithms, with their associate quality flags.</strong> The quality flags can be used to refine and select the best tree height estimation and use it as tree height observation.</p>
<ul class="simple">
<li><p>a?_95: tree hight (cm) at 95 quintile, for each algorithm</p></li>
<li><p>min_rh_95: minimum value of tree hight (cm) ammong the 6 algorithms</p></li>
<li><p>max_rh_95: maximum value of tree hight (cm) ammong the 6 algorithms</p></li>
<li><p>BEAM: 1-4 coverage beam = lower power (worse) ; 5-8 power beam = higher power (better)</p></li>
<li><p>digital_elev: digital mdoel elevation</p></li>
<li><p>elev_low: elevation of center of lowest mode</p></li>
<li><p>qc_a?: quality_flag for six algorithms quality_flag = 1 (better); = 0 (worse)</p></li>
<li><p>se_a?: sensitivity for six algorithms sensitivity &lt; 0.95 (worse); sensitivity &gt; 0.95 (better )</p></li>
<li><p>deg_fg: (degrade_flag) not-degraded 0 (better) ; degraded &gt; 0 (worse)</p></li>
<li><p>solar_ele: solar elevation. &gt; 0 day (worse); &lt; 0 night (better)</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_6algorithms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tree_height/txt/eu_y_x_select_6algorithms_fullTable.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">height_6algorithms</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>a1_95</th>
      <th>a2_95</th>
      <th>a3_95</th>
      <th>a4_95</th>
      <th>a5_95</th>
      <th>a6_95</th>
      <th>min_rh_95</th>
      <th>max_rh_95</th>
      <th>BEAM</th>
      <th>digital_elev</th>
      <th>elev_low</th>
      <th>qc_a1</th>
      <th>qc_a2</th>
      <th>qc_a3</th>
      <th>qc_a4</th>
      <th>qc_a5</th>
      <th>qc_a6</th>
      <th>se_a1</th>
      <th>se_a2</th>
      <th>se_a3</th>
      <th>se_a4</th>
      <th>se_a5</th>
      <th>se_a6</th>
      <th>deg_fg</th>
      <th>solar_ele</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.050001</td>
      <td>49.727499</td>
      <td>3139</td>
      <td>3139</td>
      <td>3139</td>
      <td>3120</td>
      <td>3139</td>
      <td>3139</td>
      <td>3120</td>
      <td>3139</td>
      <td>5</td>
      <td>410.0</td>
      <td>383.72153</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.962</td>
      <td>0.984</td>
      <td>0.968</td>
      <td>0.962</td>
      <td>0.989</td>
      <td>0.979</td>
      <td>0</td>
      <td>17.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>6.050002</td>
      <td>49.922155</td>
      <td>1022</td>
      <td>2303</td>
      <td>970</td>
      <td>872</td>
      <td>5596</td>
      <td>1524</td>
      <td>872</td>
      <td>5596</td>
      <td>5</td>
      <td>290.0</td>
      <td>2374.14110</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.948</td>
      <td>0.990</td>
      <td>0.960</td>
      <td>0.948</td>
      <td>0.994</td>
      <td>0.980</td>
      <td>0</td>
      <td>43.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6.050002</td>
      <td>48.602377</td>
      <td>380</td>
      <td>1336</td>
      <td>332</td>
      <td>362</td>
      <td>1336</td>
      <td>1340</td>
      <td>332</td>
      <td>1340</td>
      <td>4</td>
      <td>440.0</td>
      <td>435.97781</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.947</td>
      <td>0.975</td>
      <td>0.956</td>
      <td>0.947</td>
      <td>0.981</td>
      <td>0.968</td>
      <td>0</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>6.050009</td>
      <td>48.151979</td>
      <td>3153</td>
      <td>3142</td>
      <td>3142</td>
      <td>3127</td>
      <td>3138</td>
      <td>3142</td>
      <td>3127</td>
      <td>3153</td>
      <td>2</td>
      <td>450.0</td>
      <td>422.00537</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.930</td>
      <td>0.970</td>
      <td>0.943</td>
      <td>0.930</td>
      <td>0.978</td>
      <td>0.962</td>
      <td>0</td>
      <td>-14.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>6.050010</td>
      <td>49.588410</td>
      <td>666</td>
      <td>4221</td>
      <td>651</td>
      <td>33</td>
      <td>5611</td>
      <td>2723</td>
      <td>33</td>
      <td>5611</td>
      <td>8</td>
      <td>370.0</td>
      <td>2413.74830</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.941</td>
      <td>0.983</td>
      <td>0.946</td>
      <td>0.941</td>
      <td>0.992</td>
      <td>0.969</td>
      <td>0</td>
      <td>22.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>6.050014</td>
      <td>48.608456</td>
      <td>787</td>
      <td>1179</td>
      <td>1187</td>
      <td>761</td>
      <td>1833</td>
      <td>1833</td>
      <td>761</td>
      <td>1833</td>
      <td>3</td>
      <td>420.0</td>
      <td>415.51581</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.952</td>
      <td>0.979</td>
      <td>0.961</td>
      <td>0.952</td>
      <td>0.986</td>
      <td>0.975</td>
      <td>0</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="n">height_6algorithms</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>a1_95</th>
      <th>a2_95</th>
      <th>a3_95</th>
      <th>a4_95</th>
      <th>a5_95</th>
      <th>a6_95</th>
      <th>min_rh_95</th>
      <th>max_rh_95</th>
      <th>BEAM</th>
      <th>digital_elev</th>
      <th>elev_low</th>
      <th>qc_a1</th>
      <th>qc_a2</th>
      <th>qc_a3</th>
      <th>qc_a4</th>
      <th>qc_a5</th>
      <th>qc_a6</th>
      <th>se_a1</th>
      <th>se_a2</th>
      <th>se_a3</th>
      <th>se_a4</th>
      <th>se_a5</th>
      <th>se_a6</th>
      <th>deg_fg</th>
      <th>solar_ele</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
      <td>1267239.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>633620.00</td>
      <td>7.97</td>
      <td>49.37</td>
      <td>1807.40</td>
      <td>2164.35</td>
      <td>1885.92</td>
      <td>1587.37</td>
      <td>2692.24</td>
      <td>2129.05</td>
      <td>1582.89</td>
      <td>2703.53</td>
      <td>4.75</td>
      <td>289.22</td>
      <td>491.06</td>
      <td>0.80</td>
      <td>0.91</td>
      <td>0.85</td>
      <td>0.80</td>
      <td>0.92</td>
      <td>0.90</td>
      <td>0.93</td>
      <td>0.97</td>
      <td>0.95</td>
      <td>0.93</td>
      <td>0.98</td>
      <td>0.96</td>
      <td>12.46</td>
      <td>-1.33</td>
    </tr>
    <tr>
      <th>std</th>
      <td>365820.53</td>
      <td>1.10</td>
      <td>0.47</td>
      <td>1034.72</td>
      <td>1107.12</td>
      <td>1013.52</td>
      <td>1058.24</td>
      <td>1310.33</td>
      <td>1045.41</td>
      <td>1056.13</td>
      <td>1322.65</td>
      <td>2.29</td>
      <td>10363.92</td>
      <td>528.74</td>
      <td>0.40</td>
      <td>0.28</td>
      <td>0.35</td>
      <td>0.40</td>
      <td>0.26</td>
      <td>0.30</td>
      <td>0.44</td>
      <td>0.19</td>
      <td>0.36</td>
      <td>0.44</td>
      <td>0.14</td>
      <td>0.25</td>
      <td>25.89</td>
      <td>30.75</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.00</td>
      <td>6.05</td>
      <td>47.98</td>
      <td>115.00</td>
      <td>82.00</td>
      <td>37.00</td>
      <td>3.00</td>
      <td>78.00</td>
      <td>82.00</td>
      <td>3.00</td>
      <td>116.00</td>
      <td>1.00</td>
      <td>-1000000.00</td>
      <td>114.87</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-411.76</td>
      <td>-178.46</td>
      <td>-339.98</td>
      <td>-411.76</td>
      <td>-124.62</td>
      <td>-232.30</td>
      <td>0.00</td>
      <td>-63.60</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>316810.50</td>
      <td>7.03</td>
      <td>49.06</td>
      <td>882.00</td>
      <td>1474.00</td>
      <td>1095.00</td>
      <td>488.00</td>
      <td>1921.00</td>
      <td>1457.00</td>
      <td>486.00</td>
      <td>1928.00</td>
      <td>3.00</td>
      <td>320.00</td>
      <td>309.49</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.92</td>
      <td>0.97</td>
      <td>0.94</td>
      <td>0.92</td>
      <td>0.98</td>
      <td>0.96</td>
      <td>0.00</td>
      <td>-23.40</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>633620.00</td>
      <td>7.84</td>
      <td>49.51</td>
      <td>1899.00</td>
      <td>2240.00</td>
      <td>1960.00</td>
      <td>1650.00</td>
      <td>2706.00</td>
      <td>2230.00</td>
      <td>1644.00</td>
      <td>2711.00</td>
      <td>5.00</td>
      <td>390.00</td>
      <td>386.05</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.95</td>
      <td>0.98</td>
      <td>0.96</td>
      <td>0.95</td>
      <td>0.99</td>
      <td>0.97</td>
      <td>0.00</td>
      <td>-4.90</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>950429.50</td>
      <td>8.98</td>
      <td>49.73</td>
      <td>2590.00</td>
      <td>2817.00</td>
      <td>2626.00</td>
      <td>2472.00</td>
      <td>3414.00</td>
      <td>2812.00</td>
      <td>2468.00</td>
      <td>3416.00</td>
      <td>7.00</td>
      <td>470.00</td>
      <td>476.89</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.97</td>
      <td>0.99</td>
      <td>0.97</td>
      <td>0.97</td>
      <td>0.99</td>
      <td>0.98</td>
      <td>0.00</td>
      <td>23.30</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1267239.00</td>
      <td>9.95</td>
      <td>49.95</td>
      <td>14359.00</td>
      <td>16070.00</td>
      <td>14469.00</td>
      <td>13620.00</td>
      <td>18000.00</td>
      <td>18299.00</td>
      <td>13620.00</td>
      <td>18299.00</td>
      <td>8.00</td>
      <td>1200.00</td>
      <td>8566.18</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>181.09</td>
      <td>84.12</td>
      <td>153.38</td>
      <td>181.09</td>
      <td>63.34</td>
      <td>111.83</td>
      <td>80.00</td>
      <td>64.00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Count observation during the day (&gt;0) and during the night (&lt;0)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s2">&quot;solar_ele&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>   <span class="c1"># night (better)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
700460
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s2">&quot;solar_ele&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>   <span class="c1"># day (worse)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
566779
</pre></div></div>
</div>
<p>Count uniq degraged (&gt;0) or not-degraded (0) observation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s2">&quot;deg_fg&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0     967716
70    139223
30     48378
5      44063
80     42052
50     16666
9       5815
71      1406
1       1368
35       481
39        71
Name: deg_fg, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">height_6algorithms</span><span class="p">[</span><span class="s2">&quot;solar_ele&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-35.10    17572
-35.20    11174
-20.60    10390
-16.80     9658
25.60      7223
          ...
10.00         2
-0.40         1
-60.40        1
42.10         1
-32.40        1
Name: solar_ele, Length: 1101, dtype: int64
</pre></div></div>
</div>
<p><strong>File storing point location and tree height. The height is obtained as average of the 4 algorithms.</strong> Among the 6 algorithms we calculate minimum and maximum of heith values, then we calculate the mean excluding the minimum and the maximum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> head tree_height/txt/eu_x_y_height_select.txt
<span class="o">!</span> paste -d <span class="s2">&quot; &quot;</span>  tree_height/txt/eu_x_y_height_select.txt &gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ID X Y h
1 6.050001 49.727499 3139
2 6.0500017 49.922155 1454.75
3 6.0500021 48.602377 853.5
4 6.0500089 48.151979 3141
5 6.0500102 49.58841 2065.25
6 6.0500143 48.608456 1246.5
7 6.0500165 48.571401 2938.75
8 6.0500189 49.921613 3294.75
9 6.0500201 48.822645 1623.5
/bin/bash: -c: line 0: syntax error near unexpected token `newline&#39;
/bin/bash: -c: line 0: ` paste -d &#34; &#34;  tree_height/txt/eu_x_y_height_select.txt &gt;&#39;
</pre></div></div>
</div>
</section>
<section id="Available-geo-raster-files">
<h3>Available geo raster files<a class="headerlink" href="#Available-geo-raster-files" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> ls tree_height/geodata_raster
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BLDFIE_WeigAver.tif    glad_ard_SVVI_med.tif
CECSOL_WeigAver.tif    glad_ard_SVVI_min.tif
CHELSA_bio18.tif       latitude.tif
CHELSA_bio4.tif        longitude.tif
convergence.tif        northness.tif
cti.tif                ORCDRC_WeigAver.tif
dev-magnitude.tif      outlet_dist_dw_basin.tif
eastness.tif           SBIO3_Isothermality_5_15cm.tif
elev.tif               SBIO4_Temperature_Seasonality_5_15cm.tif
forestheight.tif       treecover.tif
glad_ard_SVVI_max.tif
</pre></div></div>
</div>
<p>The geo raster have been standarized in terms of extent and pixel resolution, using <em>gdal_translate</em> and <em>gdal_edit.py</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> gdalinfo tree_height/geodata_raster/glad_ard_SVVI_min.tif
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Driver: GTiff/GeoTIFF
Files: tree_height/geodata_raster/glad_ard_SVVI_min.tif
Size is 16000, 8400
Coordinate System is:
GEOGCRS[&#34;WGS 84&#34;,
    DATUM[&#34;World Geodetic System 1984&#34;,
        ELLIPSOID[&#34;WGS 84&#34;,6378137,298.257223563,
            LENGTHUNIT[&#34;metre&#34;,1]]],
    PRIMEM[&#34;Greenwich&#34;,0,
        ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&#34;geodetic latitude (Lat)&#34;,north,
            ORDER[1],
            ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
        AXIS[&#34;geodetic longitude (Lon)&#34;,east,
            ORDER[2],
            ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
    ID[&#34;EPSG&#34;,4326]]
Data axis to CRS axis mapping: 2,1
Origin = (6.000000000000000,50.000000000000000)
Pixel Size = (0.000250000000000,-0.000250000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_DATETIME=2022:04:25 04:05:10
  TIFFTAG_DOCUMENTNAME=/vast/palmer/home.grace/ga254/SE_data/exercise/tree_height/geodata_raster/glad_ard_SVVI_min.tif
  TIFFTAG_SOFTWARE=pktools 2.6.7.6 by Pieter Kempeneers
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (   6.0000000,  50.0000000) (  6d 0&#39; 0.00&#34;E, 50d 0&#39; 0.00&#34;N)
Lower Left  (   6.0000000,  47.9000000) (  6d 0&#39; 0.00&#34;E, 47d54&#39; 0.00&#34;N)
Upper Right (  10.0000000,  50.0000000) ( 10d 0&#39; 0.00&#34;E, 50d 0&#39; 0.00&#34;N)
Lower Right (  10.0000000,  47.9000000) ( 10d 0&#39; 0.00&#34;E, 47d54&#39; 0.00&#34;N)
Center      (   8.0000000,  48.9500000) (  8d 0&#39; 0.00&#34;E, 48d57&#39; 0.00&#34;N)
Band 1 Block=16000x1 Type=Float32, ColorInterp=Gray
  NoData Value=-9999
</pre></div></div>
</div>
<p>The urban building, agricolture land and water has been maskout using <em>pksetmask</em> and set as No-datga. In the following maps it is rappresented in white color. Point location has been moved accordingly.</p>
</section>
<section id="Geo-raster-files-description.">
<h3>Geo raster files description.<a class="headerlink" href="#Geo-raster-files-description." title="Permalink to this headline"></a></h3>
<p><strong>Spectral Variability Vegetation Index obtained from the</strong><a class="reference external" href="https://glad.umd.edu/ard/glad-landsat-ard-tools">GLAD ARD</a><strong>dataset.</strong></p>
<ul class="simple">
<li><p>glad_ard_SVVI_min.tif: Spectral Variability Vegetation Index colculated using a 3 years temporal minimum composite.</p></li>
<li><p>glad_ard_SVVI_med.tif: Spectral Variability Vegetation Index colculated using a 3 years temporal median composite.</p></li>
<li><p>glad_ard_SVVI_max.tif: Spectral Variability Vegetation Index colculated using a 3 years temporal maximum composite.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/glad_ard_SVVI_min.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/glad_ard_SVVI_med.tif&quot;</span><span class="p">)</span>
<span class="n">src3</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/glad_ard_SVVI_max.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">,</span><span class="n">src3p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;glad_ard_SVVI_min.tif&#39;</span> <span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=+</span><span class="mi">500</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span> <span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;glad_ard_SVVI_med.tif&#39;</span> <span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=+</span><span class="mi">500</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span> <span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src3p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;glad_ard_SVVI_max.tif&#39;</span> <span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=+</span><span class="mi">500</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e84ef9640&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_33_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_33_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">,</span><span class="n">src3p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;glad_ard_SVVI_min.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;glad_ard_SVVI_med.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src3p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;glad_ard_SVVI_max.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_34_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_34_0.png" />
</div>
</div>
<p><strong>Climate data obained from the</strong><a class="reference external" href="https://chelsa-climate.org/bioclim/">CHELSA</a><strong>dataset.</strong></p>
<ul class="simple">
<li><p>CHELSA_bio18.tif: mean monthly precipitation amount of the warmest quarter</p></li>
<li><p>CHELSA_bio4.tif: temperature seasonality (standard deviation of the monthly mean temperatures)</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/CHELSA_bio4.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/CHELSA_bio18.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">src1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;CHELSA_bio4&#39;</span>  <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">src2</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;CHELSA_bio18&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e84aca3d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_36_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_36_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;CHELSA_bio4.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;CHELSA_bio18.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_37_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_37_0.png" />
</div>
</div>
<p><strong>Soil data obained from the</strong><a class="reference external" href="https://soilgrids.org/">SOILGRID</a></p>
<ul class="simple">
<li><p>BLDFIE_WeigAver.tif: Bulk density (fine earth) in kg / cubic-meter (weigheted average as function for the depth)</p></li>
<li><p>CECSOL_WeigAver.tif: Cation exchange capacity of soil in cmolc/kg (weigheted average as function for the depth)</p></li>
<li><p>ORCDRC_WeigAver.tif: Soil organic carbon content (fine earth fraction) in g per kg (weigheted average as function for the depth)</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/BLDFIE_WeigAver.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/CECSOL_WeigAver.tif&quot;</span><span class="p">)</span>
<span class="n">src3</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/ORCDRC_WeigAver.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">,</span><span class="n">src3p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;BLDFIE_WeigAver.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;CECSOL_WeigAver.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src3p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ORCDRC_WeigAver.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e84759fd0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_39_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_39_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">,</span><span class="n">src3p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;BLDFIE_WeigAver.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;CECSOL_WeigAver.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src3p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ORCDRC_WeigAver.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_40_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_40_0.png" />
</div>
</div>
<p><strong>Geomorphological data obtained from</strong><a class="reference external" href="http://spatial-ecology.net/docs/build/html/GEODATA/geomorpho90m/geomorpho90m.html">geomorpho90m</a></p>
<ul class="simple">
<li><p>elev.tif: elevation</p></li>
<li><p>convergence.tif: convergence</p></li>
<li><p>northness.tif: northness</p></li>
<li><p>eastness.tif: eastness</p></li>
<li><p>dev-magnitude.tif: Maximum multiscaledeviation</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/elev.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/convergence.tif&quot;</span><span class="p">)</span>
<span class="n">src3</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/northness.tif&quot;</span><span class="p">)</span>
<span class="n">src4</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/eastness.tif&quot;</span><span class="p">)</span>
<span class="n">src5</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/dev-magnitude.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">,</span><span class="n">src3p</span><span class="p">,</span><span class="n">src4p</span><span class="p">,</span><span class="n">src5p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;elev.tif&#39;</span> <span class="p">,</span>  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;convergence.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src3p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;northness.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src4</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src4p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;eastness.tif&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src5p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;dev-magnitude.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e821d8af0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_42_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_42_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">,</span><span class="n">src3p</span><span class="p">,</span><span class="n">src4p</span><span class="p">,</span><span class="n">src5p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;elev.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;convergence.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src3p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;northness.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src4</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src4p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;eastness.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src5p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;dev-magnitude.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_43_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_43_0.png" />
</div>
</div>
<p><strong>Hydrography data obtained from</strong><a class="reference external" href="https://essd.copernicus.org/preprints/essd-2022-9/">hydromorpho90m</a></p>
<ul class="simple">
<li><p>cti.tif:Compound topographic index</p></li>
<li><p>outlet_dist_dw_basin.tif: Distance between focal grid cell and the outlet grid cell in the network</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/cti.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/outlet_dist_dw_basin.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">src1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;cti.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">src2</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;outlet_dist_dw_basin.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e81c9a850&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_45_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_45_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;cti.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;outlet_dist_dw_basin.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_46_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_46_0.png" />
</div>
</div>
<p><strong>Soil data obtained from</strong><a class="reference external" href="https://zenodo.org/record/4558732#.YmqPg3VfiV4">Global Soil Bioclimatic variables</a></p>
<ul class="simple">
<li><p>SBIO3_Isothermality_5_15cm.tif</p></li>
<li><p>SBIO4_Temperature_Seasonality_5_15cm.tif</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/SBIO3_Isothermality_5_15cm.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/SBIO4_Temperature_Seasonality_5_15cm.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">((</span><span class="n">src1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SBIO3_Isothermality_5_15cm.tif&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">src2</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SBIO4_Temperature_Seasonality_5_15cm.tif&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e65713df0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_48_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_48_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;SBIO3_Isothermality_5_15cm.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;SBIO4_Temperature_Seasonality_5_15cm.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_49_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_49_0.png" />
</div>
</div>
<p><strong>Forest cover in percentage obtained from</strong><a class="reference external" href="https://earthenginepartners.appspot.com/science-2013-global-forest/download_v1.7.html">Global Forest Change</a></p>
<ul class="simple">
<li><p>treecover.tif: canopy cover in percentage</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/treecover.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">src1p</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;treecover.tif&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span> <span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e65468b50&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_51_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_51_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;treecover.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_52_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_52_0.png" />
</div>
</div>
<p><strong>Forest height in percentage obtained from</strong><a class="reference external" href="https://glad.umd.edu/dataset/gedi">Forest Height</a></p>
<p>The <a class="reference external" href="https://glad.umd.edu/dataset/gedi">Global Forest Canopy Height, 2019</a> map has been release in 2020 (scientific publication <a class="reference external" href="https://doi.org/10.1016/j.rse.2020.112165">https://doi.org/10.1016/j.rse.2020.112165</a>). The authors use a regression tree model that was calibrated and applied to each individual Landsat GLAD ARD tile (1 × 1◦) in a “moving window” mode. Such tree height estimation is storede in forestheight.tiff and in the table as <em>forestheight</em> column. We will try to beats such estimation using a more advance ML tecnques and
different enviromental predictors that better express the ecolocacal condition.</p>
<ul class="simple">
<li><p>forestheight.tif</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/forestheight.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">src1p</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;forestheight.tiff&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f5e652e1670&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_54_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_54_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">src1p</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;forestheight.tif&quot;</span>  <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_55_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_55_0.png" />
</div>
</div>
<p><strong>Latitude and longittude obtained from GRASS (r.latlong)[https://grass.osgeo.org/grass78/manuals/r.latlong.html]</strong></p>
<ul class="simple">
<li><p>longitude.tif</p></li>
<li><p>latitude.tif</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">src1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/longitude.tif&quot;</span><span class="p">)</span>
<span class="n">src2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;tree_height/geodata_raster/latitude.tif&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span> <span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;longitude.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;latitude.tif&#39;</span> <span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_rainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0840c522e0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_57_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_57_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">src1p</span><span class="p">,</span><span class="n">src2p</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src1p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;longitude.tif&quot;</span><span class="p">)</span>
<span class="n">show_hist</span><span class="p">(</span> <span class="n">src2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">src2p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;latitude.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_58_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_58_0.png" />
</div>
</div>
<p><strong>File storing enviromental predictors at each point location.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tree_height/txt/eu_x_y_height_predictors_select.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>h</th>
      <th>BLDFIE_WeigAver</th>
      <th>CECSOL_WeigAver</th>
      <th>CHELSA_bio18</th>
      <th>CHELSA_bio4</th>
      <th>convergence</th>
      <th>cti</th>
      <th>dev-magnitude</th>
      <th>eastness</th>
      <th>elev</th>
      <th>forestheight</th>
      <th>glad_ard_SVVI_max</th>
      <th>glad_ard_SVVI_med</th>
      <th>glad_ard_SVVI_min</th>
      <th>northness</th>
      <th>ORCDRC_WeigAver</th>
      <th>outlet_dist_dw_basin</th>
      <th>SBIO3_Isothermality_5_15cm</th>
      <th>SBIO4_Temperature_Seasonality_5_15cm</th>
      <th>treecover</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.05</td>
      <td>49.73</td>
      <td>3139.00</td>
      <td>1540</td>
      <td>13</td>
      <td>2113</td>
      <td>5893</td>
      <td>-10.49</td>
      <td>-238043120</td>
      <td>1.16</td>
      <td>0.07</td>
      <td>353.98</td>
      <td>23</td>
      <td>276.87</td>
      <td>46.44</td>
      <td>347.67</td>
      <td>0.04</td>
      <td>9</td>
      <td>780403</td>
      <td>19.80</td>
      <td>440.67</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>6.05</td>
      <td>49.92</td>
      <td>1454.75</td>
      <td>1491</td>
      <td>12</td>
      <td>1993</td>
      <td>5912</td>
      <td>33.27</td>
      <td>-208915344</td>
      <td>-1.76</td>
      <td>0.27</td>
      <td>267.51</td>
      <td>19</td>
      <td>-49.53</td>
      <td>19.55</td>
      <td>-130.54</td>
      <td>0.18</td>
      <td>16</td>
      <td>772777</td>
      <td>20.89</td>
      <td>457.76</td>
      <td>85</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>6.05</td>
      <td>48.60</td>
      <td>853.50</td>
      <td>1521</td>
      <td>17</td>
      <td>2124</td>
      <td>5983</td>
      <td>0.05</td>
      <td>-137479792</td>
      <td>1.91</td>
      <td>-0.02</td>
      <td>389.75</td>
      <td>21</td>
      <td>93.26</td>
      <td>50.74</td>
      <td>384.52</td>
      <td>0.04</td>
      <td>14</td>
      <td>898820</td>
      <td>20.70</td>
      <td>481.88</td>
      <td>62</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>6.05</td>
      <td>48.15</td>
      <td>3141.00</td>
      <td>1526</td>
      <td>16</td>
      <td>2569</td>
      <td>6130</td>
      <td>-33.65</td>
      <td>-267223072</td>
      <td>0.97</td>
      <td>0.07</td>
      <td>380.21</td>
      <td>27</td>
      <td>542.40</td>
      <td>202.26</td>
      <td>386.16</td>
      <td>0.01</td>
      <td>15</td>
      <td>831824</td>
      <td>19.38</td>
      <td>479.41</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>6.05</td>
      <td>49.59</td>
      <td>2065.25</td>
      <td>1547</td>
      <td>14</td>
      <td>2108</td>
      <td>5923</td>
      <td>27.49</td>
      <td>-107809368</td>
      <td>-0.16</td>
      <td>0.01</td>
      <td>308.04</td>
      <td>25</td>
      <td>136.05</td>
      <td>146.84</td>
      <td>198.13</td>
      <td>0.03</td>
      <td>17</td>
      <td>796962</td>
      <td>18.78</td>
      <td>457.88</td>
      <td>85</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>6.05</td>
      <td>48.61</td>
      <td>1246.50</td>
      <td>1515</td>
      <td>19</td>
      <td>2124</td>
      <td>6010</td>
      <td>-1.60</td>
      <td>17384282</td>
      <td>1.45</td>
      <td>-0.02</td>
      <td>364.53</td>
      <td>18</td>
      <td>221.34</td>
      <td>247.39</td>
      <td>480.39</td>
      <td>0.04</td>
      <td>14</td>
      <td>897945</td>
      <td>19.40</td>
      <td>474.33</td>
      <td>62</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.5f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>h</th>
      <th>BLDFIE_WeigAver</th>
      <th>CECSOL_WeigAver</th>
      <th>CHELSA_bio18</th>
      <th>CHELSA_bio4</th>
      <th>convergence</th>
      <th>cti</th>
      <th>dev-magnitude</th>
      <th>eastness</th>
      <th>elev</th>
      <th>forestheight</th>
      <th>glad_ard_SVVI_max</th>
      <th>glad_ard_SVVI_med</th>
      <th>glad_ard_SVVI_min</th>
      <th>northness</th>
      <th>ORCDRC_WeigAver</th>
      <th>outlet_dist_dw_basin</th>
      <th>SBIO3_Isothermality_5_15cm</th>
      <th>SBIO4_Temperature_Seasonality_5_15cm</th>
      <th>treecover</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
      <td>1267239.00000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>633620.00000</td>
      <td>7.96654</td>
      <td>49.36511</td>
      <td>1994.97683</td>
      <td>1502.39574</td>
      <td>13.68642</td>
      <td>2310.15649</td>
      <td>6293.88506</td>
      <td>-0.14166</td>
      <td>-149126079.37575</td>
      <td>0.25312</td>
      <td>-0.00370</td>
      <td>338.88664</td>
      <td>20.75837</td>
      <td>250.98824</td>
      <td>119.72647</td>
      <td>148.13463</td>
      <td>0.00737</td>
      <td>13.97081</td>
      <td>749213.04208</td>
      <td>19.79155</td>
      <td>476.60503</td>
      <td>77.64616</td>
    </tr>
    <tr>
      <th>std</th>
      <td>365820.53323</td>
      <td>1.10181</td>
      <td>0.46899</td>
      <td>977.86026</td>
      <td>44.27063</td>
      <td>2.21764</td>
      <td>366.82038</td>
      <td>224.88881</td>
      <td>23.15530</td>
      <td>166804129.24955</td>
      <td>1.31914</td>
      <td>0.10254</td>
      <td>130.18989</td>
      <td>7.31751</td>
      <td>349.75421</td>
      <td>257.31665</td>
      <td>267.01116</td>
      <td>0.10150</td>
      <td>7.08598</td>
      <td>100361.51781</td>
      <td>1.31156</td>
      <td>27.05428</td>
      <td>21.02552</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.00000</td>
      <td>6.05000</td>
      <td>47.97635</td>
      <td>84.75000</td>
      <td>1216.00000</td>
      <td>6.00000</td>
      <td>1553.00000</td>
      <td>5503.00000</td>
      <td>-81.28032</td>
      <td>-474056768.00000</td>
      <td>-5.47250</td>
      <td>-0.63450</td>
      <td>82.19376</td>
      <td>0.00000</td>
      <td>-865.58301</td>
      <td>-699.90332</td>
      <td>-842.19458</td>
      <td>-0.52740</td>
      <td>3.00000</td>
      <td>540427.00000</td>
      <td>14.61014</td>
      <td>394.21213</td>
      <td>1.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>316810.50000</td>
      <td>7.02639</td>
      <td>49.05567</td>
      <td>1326.75000</td>
      <td>1491.00000</td>
      <td>12.00000</td>
      <td>2078.00000</td>
      <td>6149.00000</td>
      <td>-15.25398</td>
      <td>-259747944.00000</td>
      <td>-0.99220</td>
      <td>-0.05173</td>
      <td>259.10744</td>
      <td>19.00000</td>
      <td>16.96252</td>
      <td>-43.99414</td>
      <td>-37.99170</td>
      <td>-0.04133</td>
      <td>9.00000</td>
      <td>674957.00000</td>
      <td>18.90800</td>
      <td>458.58015</td>
      <td>75.00000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>633620.00000</td>
      <td>7.84351</td>
      <td>49.51040</td>
      <td>2078.00000</td>
      <td>1518.00000</td>
      <td>13.00000</td>
      <td>2242.00000</td>
      <td>6304.00000</td>
      <td>-0.66545</td>
      <td>-188826192.00000</td>
      <td>0.46544</td>
      <td>-0.00116</td>
      <td>331.79755</td>
      <td>24.00000</td>
      <td>162.78882</td>
      <td>70.64990</td>
      <td>182.67358</td>
      <td>0.00359</td>
      <td>12.00000</td>
      <td>742105.00000</td>
      <td>19.76031</td>
      <td>473.55383</td>
      <td>85.00000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>950429.50000</td>
      <td>8.97501</td>
      <td>49.73179</td>
      <td>2676.00000</td>
      <td>1531.00000</td>
      <td>15.00000</td>
      <td>2457.00000</td>
      <td>6477.00000</td>
      <td>15.50443</td>
      <td>-84776040.00000</td>
      <td>1.31942</td>
      <td>0.04273</td>
      <td>408.29001</td>
      <td>26.00000</td>
      <td>405.89746</td>
      <td>220.47534</td>
      <td>324.65247</td>
      <td>0.05970</td>
      <td>16.00000</td>
      <td>811864.00000</td>
      <td>20.62271</td>
      <td>491.08063</td>
      <td>89.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1267239.00000</td>
      <td>9.95000</td>
      <td>49.95000</td>
      <td>14481.00000</td>
      <td>1599.00000</td>
      <td>38.00000</td>
      <td>4618.00000</td>
      <td>6814.00000</td>
      <td>79.13613</td>
      <td>1393578752.00000</td>
      <td>11.05419</td>
      <td>0.56048</td>
      <td>1097.69751</td>
      <td>34.00000</td>
      <td>4506.54102</td>
      <td>4149.77930</td>
      <td>3570.01855</td>
      <td>0.55303</td>
      <td>139.00000</td>
      <td>1028934.00000</td>
      <td>26.08103</td>
      <td>598.17474</td>
      <td>100.00000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Assessing-variable-autocorrelation">
<h3>Assessing variable autocorrelation<a class="headerlink" href="#Assessing-variable-autocorrelation" title="Permalink to this headline"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_sample</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;h&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">predictors_sample</span> <span class="p">,</span>  <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scatter_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_63_0.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_63_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_sample</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;BLDFIE_WeigAver&quot;</span><span class="p">,</span><span class="s2">&quot;CECSOL_WeigAver&quot;</span><span class="p">,</span><span class="s2">&quot;ORCDRC_WeigAver&quot;</span><span class="p">,</span><span class="s2">&quot;CHELSA_bio18&quot;</span><span class="p">,</span><span class="s2">&quot;CHELSA_bio4&quot;</span><span class="p">,</span><span class="s2">&quot;SBIO3_Isothermality_5_15cm&quot;</span><span class="p">,</span><span class="s2">&quot;SBIO4_Temperature_Seasonality_5_15cm&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">predictors_sample</span> <span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scatter_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x7f08401be370&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_64_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_64_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_sample</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;elev&quot;</span><span class="p">,</span><span class="s2">&quot;convergence&quot;</span><span class="p">,</span><span class="s2">&quot;dev-magnitude&quot;</span><span class="p">,</span><span class="s2">&quot;eastness&quot;</span><span class="p">,</span><span class="s2">&quot;northness&quot;</span><span class="p">,</span><span class="s2">&quot;outlet_dist_dw_basin&quot;</span><span class="p">,</span><span class="s2">&quot;cti&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">predictors_sample</span> <span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scatter_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x7f08295929d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_65_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_65_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_sample</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[[</span><span class="s2">&quot;h&quot;</span><span class="p">,</span><span class="s2">&quot;glad_ard_SVVI_min&quot;</span><span class="p">,</span><span class="s2">&quot;glad_ard_SVVI_med&quot;</span><span class="p">,</span><span class="s2">&quot;glad_ard_SVVI_max&quot;</span> <span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">predictors_sample</span> <span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scatter_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;.2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;seaborn.axisgrid.PairGrid at 0x7f0841b35ca0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_66_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_66_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### Assessing spatial autocorrelation</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xy_val</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;tree_height/txt/eu_x_y_height_select.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="n">xy_val_sample</span> <span class="o">=</span> <span class="n">xy_val</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">xy_val_sample</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>X</th>
      <th>Y</th>
      <th>h</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>929641</th>
      <td>929642</td>
      <td>8.91998</td>
      <td>49.49045</td>
      <td>4016.50000</td>
    </tr>
    <tr>
      <th>457286</th>
      <td>457287</td>
      <td>7.35023</td>
      <td>49.03289</td>
      <td>710.75000</td>
    </tr>
    <tr>
      <th>148816</th>
      <td>148817</td>
      <td>6.59051</td>
      <td>49.84644</td>
      <td>1146.00000</td>
    </tr>
    <tr>
      <th>254250</th>
      <td>254251</td>
      <td>6.87187</td>
      <td>49.27212</td>
      <td>1548.75000</td>
    </tr>
    <tr>
      <th>713899</th>
      <td>713900</td>
      <td>8.20808</td>
      <td>48.75449</td>
      <td>1212.50000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">V</span> <span class="o">=</span> <span class="n">skg</span><span class="o">.</span><span class="n">Variogram</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xy_val_sample</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">xy_val_sample</span><span class="o">.</span><span class="n">Y</span><span class="p">))</span> <span class="p">,</span> <span class="n">xy_val_sample</span><span class="o">.</span><span class="n">h</span> <span class="p">,</span>  <span class="n">maxlag</span> <span class="o">=</span> <span class="s1">&#39;median&#39;</span> <span class="p">,</span>  <span class="n">n_lags</span><span class="o">=</span><span class="mi">50</span> <span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/selv/.local/lib/python3.8/site-packages/skgstat/plotting/variogram_plot.py:123: UserWarning:

Matplotlib is currently using module://matplotlib_inline.backend_inline, which is a non-GUI backend, so cannot show the figure.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_Tree_Height_01DataExplore_69_1.png" src="../_images/CASESTUDY_Tree_Height_01DataExplore_69_1.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="NN-day3.html" class="btn btn-neutral float-left" title="LSTM Network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Tree_Height_02SVM_pred.html" class="btn btn-neutral float-right" title="Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Giuseppe Amatulli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>