

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Temporal interpolation of landsat images &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dynamic Time Warping" href="DTW.html" />
    <link rel="prev" title="Data type in GTiff" href="Data_type_GTiff.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Spatial Ecology's code documentation
              <img src="../_static/SE_compact.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2022.html">GeoComp &amp; ML 2022 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_modelling_10-11_2022.html">GeoComp &amp; Modelling 2022 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2023.html">GeoComp &amp; ML 2023 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2024.html">GeoComp &amp; ML 2024 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_GEO-OPEN-HACK-2024_06_2024.html">GEO-OPEN-HACK-2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_11-12_2024.html">GeoComp 2024 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_geoanlysis_04_2025.html">Geo Comp/Analysis 2025 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../COURSESAROUNDTHEWORLD/course_geocomp_ml_09-11_2025.html">GeoComp &amp; ML 2025 course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_Ubuntu24.04_for_Spatial_Ecology_course.html">Prepare Ubuntu 24.04 for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_Colab_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VIRTUALMACHINE/Setting_OSGeoLive_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BASH/bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../AWK/awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GDAL/gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pyjeo_introduction1.html">Introduction to pyjeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pyjeo_introduction2.html">pyjeo: an open source image processing library in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pyjeo_pktools.html">Performing raster and vector operations in Python using pyjeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PKTOOLS/pyjeo_upscaling_surf.html">Scaling-up: batch processing on the cluster with pyjeo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../R/R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/PythonEnvs.html">Python environments or how to survive to your journey in the geodata space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Geo_Python.html">Python &amp; GeoComputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Python_data_analysis_SM.html">Python data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/Python_geospatial_data_analysis_SM.html">Python geospatial data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/RasterIO_Intro.html">RasterIO for dummies: a brief intro to a <em>pythonic</em> raster library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/RasterIO_Intro.html#2.-Preparing-the-dataset-for-next-ML-exercises-via-rasterio">2. Preparing the dataset for next ML exercises via rasterio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/RasterIO_Intro.html#3.-Beyond-the-basics">3. Beyond the basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PYTHON/OGCSQL.html">Generalities about OGC Geospatial extensions for SQL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_intro.html">GRASS Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_newproject.html">Start a new GRASS project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_hydro.html">Using GRASS for stream-network extraction and basins delineation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/grass_hydro_colab.html">Using GRASS for stream-network extraction and basins delineation in Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/SDM1_MWood_gecomp4GRASS.html">SDM1 : Montane woodcreper - Gecomputation for the Random Forest model using GRASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GRASS/SDM1_MWood_GRASSmodel.html">SDM1 : Montane woodcreper - Random Forest Model using GRASS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">HIGH PERFORMANCE COMPUTING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../HPC/hpc_setting.html">Geocomputation at High Performance Computing Cluster (HPC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HPC/hpc_setting_grass.html">Use of GRASS in HPC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASSIGNMENTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ASSIGNMENTS/assignment_fall2022_solutions.html">Assignments Fall 2022</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CASE STUDY</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_gecomp4GRASS.html">SDM1 : Montane woodcreper - Gecomputation for the Random Forest model using GRASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM1_MWood_GRASSmodel.html">SDM1 : Montane woodcreper - Random Forest Model using GRASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Temporal interpolation of landsat images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Data-download">Data download</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Image-characteristics">Image characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Temporal-composite">Temporal composite</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Temporal-interpolation">Temporal interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Plotting-the-temporal-interpolation-for-band-1">Plotting the temporal interpolation for band 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Assessing-the-temporal-interpolation">Assessing the temporal interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Savitzky–Golay-smoothing-filter">Savitzky–Golay smoothing filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Assessing-the-Savitzky–Golay-smoothing-filter">Assessing the Savitzky–Golay smoothing filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Wavelet-prediction">Wavelet prediction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DTW.html">Dynamic Time Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="pred_NP.html">Estimating nitrogen and phosphorus concentrations in streams and rivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day1.html">Estimating nitrogen concentrations in streams and rivers using NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day2.html">Autoencoder (AE), Variational Autoencoder (VAE) and Generative Adversarial Network (GAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN-day3.html">LSTM Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_01DataExplore.html">Estimation of tree height using GEDI dataset - Data explore</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_02Predictors_extraction.html">Estimation of tree height using GEDI dataset - Predictors extraction at point location</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_03RF_pred.html">Estimation of tree height using GEDI dataset - Random Forest prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04SVM_pred_2022.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR) - 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04SVM_pred_2023.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR) - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04SVM_pred_2024.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR) - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_04SVM_pred_2024.html#Exercise:-explore-the-other-parameters-offered-by-the-SVM-library-and-try-to-make-the-model-better.-Some-suggestions:">Exercise: explore the other parameters offered by the SVM library and try to make the model better. Some suggestions:</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_05Perceptron_pred_2022.html">Estimation of tree height using GEDI dataset - Perceptron 1 - 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_05Perceptron_intro_2023.html">Estimation of tree height using GEDI dataset - Perceptron 1 - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_05Perceptron_intro_2024.html">Estimation of tree height using GEDI dataset - Perceptron - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_06Perceptron_pred_2023.html">Estimation of tree height using GEDI dataset - Perceptron tree prediction - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_06Perceptron_complete_2024.html">Estimation of tree height using GEDI dataset - Perceptron complete - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_05Perceptron_pred_clean_2022.html">Estimation of tree height using GEDI dataset - Clean Data - Perceptron 2 - 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_06NeuralNets_pred.html">Estimation of tree height using GEDI dataset - Neural Network 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tree_Height_07FeedForward_Networks_2024.html">Estimation of tree height using GEDI dataset - Neural Network 1 - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="NNs_pt3_SHAP.html">Neural Nets (pt.3), Interpretability and Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="CNN_satelite_2022.html">Using Multi-layer Perceptron and Convolutional Neural Networks for Satellite image classification - 2022.</a></li>
<li class="toctree-l1"><a class="reference internal" href="CNN_satelite_2023.html">Using Multi-layer Perceptron and Convolutional Neural Networks for Satellite image classification - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="CNN_satelite_2023.html#Using-CNNs-for-a-image-dataset">Using CNNs for a image dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="foundation_model_IIASA2024.html">Prithvi 100M model</a></li>
<li class="toctree-l1"><a class="reference internal" href="foundation_model_IIASA2024.html#Proposed-exercises">Proposed exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN_Unsupervised_2024.html">Autoencoder (AE), Variational Autoencoder (VAE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN_Unsupervised_2024.html#Implementing-an-Autoencoder">Implementing an Autoencoder</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN_Unsupervised_2024.html#Autoencoding-MNIST">Autoencoding MNIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN_Unsupervised_2024.html#Section-2">Section 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="NN_Unsupervised_2024.html#Section-3---Generative-Models">Section 3 - Generative Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="LSTMs_tutorial.html">Using LSTM for time-series predictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="CNN_satelite_with_GPT_code_2023.html">Using GPT to implement a Convolutional Neural Networks for Satellite image classification.</a></li>
<li class="toctree-l1"><a class="reference internal" href="Classification_pyjeo_sklearn_2023.html">Classification in Python using pyjeo and sklearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="GEEviaPython_2023.html">Google Earth Engine use via Python, containers and other mythical beasts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Students Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../STUDENTSPROJECTS/index.html">1. 2021 SWEDEN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../STUDENTSPROJECTS/index.html#matera">2. 2022 MATERA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OUTDOOR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../OUTDOOR/outdoor_orientering.html">Do not get lost in the wilderness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OUTDOOR/outdoor_info.html">Shelter locations close to Gioia del Colle (BA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OUTDOOR/bike_accomodation.html">Accomodation in Gioia del Colle (BA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OUTDOOR/puglia_discover.html">Discover Puglia by bike!</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TALKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TALKS/intelligent_modelling.html">Intelligent modelling in time and space: combine GeoComputation and Machine Learning for  environmental application.</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/video.html">Video tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADMIN/Compiling_OTB.html">Compiling OTB from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spatial Ecology's code documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">&lt;no title&gt;</a></li>
      <li class="breadcrumb-item active">Temporal interpolation of landsat images</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/CASESTUDY/temporal_interpolation.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Temporal-interpolation-of-landsat-images">
<h1>Temporal interpolation of landsat images<a class="headerlink" href="#Temporal-interpolation-of-landsat-images" title="Link to this heading"></a></h1>
<p>The Landsat Analysis Ready Data (GLAD ARD) developed by the Global Land Analysis and Discovery (GLAD) provides spatially and temporally consistent inputs for land cover mapping and change detection. The GLAD ARD represent a 16-day time-series of tiled Landsat normalized surface reflectance from 1997 to present (source <a class="reference external" href="https://glad.umd.edu/book/overview">https://glad.umd.edu/book/overview</a>).</p>
<p>The GLAD ARD data can be download from the <a class="reference external" href="https://glad.umd.edu/dataset/landsat_v1.1/">https://glad.umd.edu/dataset/landsat_v1.1/</a> previous autentifcation. For this exercise we are going to use a portion of TILE 015E_38N, which is located in the south of Italy (Sicily), for the year <strong>2018, 2019, 2020</strong>.</p>
<p>The temporal series for each tile is labeled following this numerical nomenclature.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>head<span class="w"> </span>-43<span class="w">  </span>geodata/glad_ard/16d_intervals.csv<span class="w">  </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-6
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2017 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874
2018 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897
2019 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 920
2020 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943
2021 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966
2022 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989
</pre></div></div>
</div>
<p>Where the first column identify the year, and the others the 16-day time-series.</p>
<p>For example the below figure depict three images for the <strong>876, 899, 922</strong> time-frame (second 16-day time-serie).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/glad_ard_876_899_922_crop.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_3_0.png" src="../_images/CASESTUDY_temporal_interpolation_3_0.png" />
</div>
</div>
<section id="Data-download">
<h2>Data download<a class="headerlink" href="#Data-download" title="Link to this heading"></a></h2>
<p>Per convenience the images have been downloaded and cropped already with the following lines.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for INTER in $(grep -e ^2018 -e ^2019 -e ^2020 geodata/glad_ard//16d_intervals.csv | awk &#39;{ $1=&quot;&quot;; print $0}&#39;) ; do
curl --connect-timeout 600 -u user:password -X GET https://glad.umd.edu/dataset/landsat_v1.1/38N/015E_38N/$INTER.tif -o geodata/glad_ard/$INTER.tif
gdal_translate -co COMPRESS=DEFLATE -co ZLEVEL=9  -projwin 15.24 38.11 15.34 38 geodata/glad_ard/$INTER.tif geodata/glad_ard/${INTER}_crop.tif
done
</pre></div>
</div>
</section>
<section id="Image-characteristics">
<h2>Image characteristics<a class="headerlink" href="#Image-characteristics" title="Link to this heading"></a></h2>
<p>The images have the following characteristic:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>gdalinfo<span class="w"> </span>-mm<span class="w">   </span>geodata/glad_ard/922_crop.tif
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Driver: GTiff/GeoTIFF
Files: geodata/glad_ard/922_crop.tif
Size is 400, 440
Coordinate System is:
GEOGCRS[&#34;WGS 84&#34;,
    DATUM[&#34;World Geodetic System 1984&#34;,
        ELLIPSOID[&#34;WGS 84&#34;,6378137,298.257223563,
            LENGTHUNIT[&#34;metre&#34;,1]]],
    PRIMEM[&#34;Greenwich&#34;,0,
        ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&#34;geodetic latitude (Lat)&#34;,north,
            ORDER[1],
            ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
        AXIS[&#34;geodetic longitude (Lon)&#34;,east,
            ORDER[2],
            ANGLEUNIT[&#34;degree&#34;,0.0174532925199433]],
    ID[&#34;EPSG&#34;,4326]]
Data axis to CRS axis mapping: 2,1
Origin = (15.240000000000000,38.109999999999999)
Pixel Size = (0.000250000000000,-0.000250000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  15.2400000,  38.1100000) ( 15d14&#39;24.00&#34;E, 38d 6&#39;36.00&#34;N)
Lower Left  (  15.2400000,  38.0000000) ( 15d14&#39;24.00&#34;E, 38d 0&#39; 0.00&#34;N)
Upper Right (  15.3400000,  38.1100000) ( 15d20&#39;24.00&#34;E, 38d 6&#39;36.00&#34;N)
Lower Right (  15.3400000,  38.0000000) ( 15d20&#39;24.00&#34;E, 38d 0&#39; 0.00&#34;N)
Center      (  15.2900000,  38.0550000) ( 15d17&#39;24.00&#34;E, 38d 3&#39;18.00&#34;N)
Band 1 Block=400x1 Type=UInt16, ColorInterp=Gray
    Computed Min/Max=1.000,10685.000
Band 2 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=707.000,11421.000
Band 3 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=597.000,12197.000
Band 4 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=1448.000,22767.000
Band 5 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=2175.000,17715.000
Band 6 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=1665.000,13789.000
Band 7 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=26477.000,30289.000
Band 8 Block=400x1 Type=UInt16, ColorInterp=Undefined
    Computed Min/Max=1.000,14.000
</pre></div></div>
</div>
<p><strong>Bands features</strong></p>
<ul class="simple">
<li><p>1 Normalized surface reflectance of blue band</p></li>
<li><p>2 Normalized surface reflectance of green band</p></li>
<li><p>3 Normalized surface reflectance of red band</p></li>
<li><p>4 Normalized surface reflectance of NIR band</p></li>
<li><p>5 Normalized surface reflectance of SWIR1 band</p></li>
<li><p>6 Normalized surface reflectance of SWIR2 band</p></li>
<li><p>7 Normalized brightness temperature</p></li>
<li><p>8 Observation quality code (QA)</p></li>
</ul>
<p><strong>The band 8 include a Quality Assessment (QA) code</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>QA code</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Quality</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Nodata</p></td>
<td><p>stripes and out of the image</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Land</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Water</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Cloud</p></td>
<td><p>cloud contaminated</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Cloud shadow</p></td>
<td><p>shadow contaminated</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Hillshade</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Snow</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>Haze</p></td>
<td><p>cloud contaminated</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>Cloud buffer</p></td>
<td><p>cloud contaminated</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>Shadow buffer</p></td>
<td><p>shadow contaminated</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>Shadow high likelihood</p></td>
<td><p>shadow contaminated</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>Additional cloud buffer over land</p></td>
<td><p>clear-sky</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>Additional cloud buffer over water</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Additional shadow buffer over land</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>Land, water detected but not used</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>Additional cloud buffer over land, water detected but not used</p></td>
<td><p>lear-sky</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>Additional shadow buffer over land, water detected but not used</p></td>
<td><p>lear-sky</p></td>
</tr>
</tbody>
</table>
<p>The band 8 can be used to mask out areas that do not belong to land (QA=1) and water (QA=2) class.</p>
<p>In the below figures we use the same images than before and we apply a masking procedure using the band 8. The black part has pixel value equal to 0 and is labled as NoData</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/glad_ard_876_899_922_crop_msk.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_7_0.png" src="../_images/CASESTUDY_temporal_interpolation_7_0.png" />
</div>
</div>
<p>We decided to compute a temporal median in order to reduce the area with no data. In other words we have combined the images that belong to the same period (876, 899, 922) and select the median value. During the opearion we use the band 8 to select only good-quality pixels.</p>
</section>
<section id="Temporal-composite">
<h2>Temporal composite<a class="headerlink" href="#Temporal-composite" title="Link to this heading"></a></h2>
<p>For each of the 16-day time-series we composite the 3 images (from the year 2018,2019,2020) taking median among them. The composite has been done by retaining from band 8 (-bndnodata 7) only pixels that belong to land (QA=1) or water (QA=2)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash

<span class="nb">echo</span><span class="w"> </span><span class="m">01</span><span class="w"> </span><span class="m">02</span><span class="w"> </span><span class="m">03</span><span class="w"> </span><span class="m">04</span><span class="w"> </span><span class="m">05</span><span class="w"> </span><span class="m">06</span><span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">09</span><span class="w"> </span><span class="k">$(</span><span class="w"> </span>seq<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="k">)</span><span class="w">   </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>-P<span class="w"> </span><span class="m">2</span><span class="w">  </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">$&#39;</span>
<span class="s1">day=$1</span>

<span class="s1">## median composite</span>
<span class="s1">pkcomposite $( grep -e ^2019 -e ^2020 -e ^2018 geodata/glad_ard/16d_intervals.csv | awk -v day=$day \</span>
<span class="s1">\&#39;{ print $(day+1)  }\&#39; |  xargs  -I {}  -n 1 ls geodata/glad_ard/{}_crop.tif | xargs  -I {}  -n 1 echo -i  {}  ) \</span>
<span class="s1">-ot UInt16 -co COMPRESS=LZW -co ZLEVEL=9  -cr median -dstnodata 0  -bndnodata 7 \</span>
<span class="s1">-srcnodata 0  -srcnodata 3  -srcnodata 4 -srcnodata 5 -srcnodata 6 -srcnodata 7 -srcnodata 8 -srcnodata 9 \</span>
<span class="s1">-srcnodata 10 -srcnodata 11 -srcnodata 12 -srcnodata 13 -srcnodata 14 -srcnodata 15  -srcnodata 16 -srcnodata 17 \</span>
<span class="s1">-o geodata/glad_ard/median_$day.tif</span>

<span class="s1">##### The obtaine mosaic still contains 8 bands. Therefore we run gdal_translate to select only 6 bands</span>

<span class="s1">gdal_translate  -co COMPRESS=LZW -co ZLEVEL=9 -b 1 -b 2 -b 3 -b 4 -b 5 -b 6 -a_nodata 0 \</span>
<span class="s1">geodata/glad_ard/median_$day.tif  geodata/glad_ard/median_${day}_6bs.tif</span>
<span class="s1">rm geodata/glad_ard/median_$day.tif</span>
<span class="s1">&#39;</span><span class="w"> </span>_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
00...10.....20...10.30......40.20...50.....3060......7040......80.50....90....100 - done.
Input file size is 400, 440
0...10...20...30...40...5060...60...70...80...90...100 - done.
0......10..70..20.....3080.....40..90...50....100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
.0..60.10.....20....7030.....40..80...50.....9060......70100 - done.
.Input file size is 400, 440
0...10...20...30...40...50....60...70...80...90...100 - done.
0...80..10.....2090....30.....40100 - done.
Input file size is 400, 440
0....10...20...30...40...50.....60...70...80...90...100 - done.
500.....10....6020....30....40...70.50......8060.....90....70.100 - done.
.Input file size is 400, 440
0....10...20...30...40...5080...60...70...80...90...100 - done.
.0.....10.90...20.....30...40100 - done.
.Input file size is 400, 440
0....10...20...30...40...50.50....60...70...80...90...100 - done.
..060....10....20....3070....40.....8050......6090......70...80100 - done.
..Input file size is 400, 440
0.90...10...20...30...40...50......60...70...80...90...100 - done.
0...100 - done.
10Input file size is 400, 440
0.....10...20...30...40...50.20...60...70...80...90...100 - done.
.0.....1030.....20...40.30......40.50.....60.50....70...60....8070......8090......90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50100 - done.
Input file size is 400, 440
0...60...70...80...90...100 - done.
...10...20...30...40...500.....60...70...80...90...100 - done.
.10..0...20..10....30.20......4030......5040......6050.....70..60....80..70....90..80.....90.100 - done.
..Input file size is 400, 440
0...10...20...30...40...50100 - done.
...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...500......60...70...80...90...100 - done.
10..0...20..10.....3020......4030......4050......5060.....60..70....70..80....80...90..90.....100 - done.
Input file size is 400, 440
0100 - done.
Input file size is 400, 440
0...10...20...30...40...50...10...20...30...40...50...60...70...80...90...100 - done.
...60...70...80...90...100 - done.
0..0....10..10...20.20....30....40....3050....60.....4070......8050......60.90.....70...80100 - done.
.Input file size is 400, 440
0.....10...20...30...40...5090......60...70...80...90...100 - done.
0.100 - done.
Input file size is 400, 440
0....10...20...30...40...50.10...60...70...80...90...100 - done.
0.....20...10.30......40.20...50.....6030.....70....80...4090....100 - done.
Input file size is 400, 440
0...10...20...30...40...50....60...70...80...90...100 - done.
0..50...10....60.20......7030......8040.....90..50....100 - done.
Input file size is 400, 440
0...10...20...30...40...50....60...70...80...90...100 - done.
060....10....20....30.70..40....50...60....70....80.80..90.....100 - done.
Input file size is 400, 440
0....10...20...30...40...50...60...70...80...90...100 - done.
090......10100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
.0....10....2020......30.30...40.....5040.....60..50....70.60.....80.70.....90..80...100 - done.
.Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
.090......100 - done.
Input file size is 400, 440
010...10...20...30...40...50...60...70...80...90...100 - done.
...20...30...40...50...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
<p>After the temporal composite some images present areas with NoData.</p>
<p>Below the results of the median aggregation of the previus 3 images.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/glad_ard_median_02_6bs.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_12_0.png" src="../_images/CASESTUDY_temporal_interpolation_12_0.png" />
</div>
</div>
</section>
<section id="Temporal-interpolation">
<h2>Temporal interpolation<a class="headerlink" href="#Temporal-interpolation" title="Link to this heading"></a></h2>
<p>We re-fill (gap-filling) all the area labeled as NoData=0 (black area in the above immages) using temporal interpolation by means of <a class="reference external" href="https://en.wikipedia.org/wiki/Akima_spline">Akima</a> and <a class="reference external" href="https://www.weatherclasses.com/uploads/1/3/1/3/131359169/steffen_interpolation_paper.pdf">Steffen</a> algorithm.</p>
<p><a class="reference external" href="http://spatial-ecology.net/docs/source/lectures/lect_20210427_Approximation.pdf">Approximation</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash

<span class="c1"># for semplicity we concentrate in only on band 1</span>
<span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>-P<span class="w"> </span><span class="m">1</span><span class="w">  </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">$&#39;</span>
<span class="s1">B=$1 # band</span>

<span class="s1">## extract one band for all the 16-day time-series</span>
<span class="s1">for day in 01 02 03 04 05 06 07 08 09 $( seq 10 23 ) ; do</span>
<span class="s1">gdalbuildvrt -srcnodata 0 -vrtnodata 0 -overwrite -b $B geodata/glad_ard/median_${day}_${B}b.vrt \</span>
<span class="s1">geodata/glad_ard/median_${day}_6bs.tif</span>
<span class="s1">done</span>

<span class="s1">## replicate 3 times the 16-day time-series to avoid temporal border effect</span>
<span class="s1">gdalbuildvrt -srcnodata 0 -vrtnodata 0 -separate  -overwrite geodata/glad_ard/median_tseries_${B}b.vrt \</span>
<span class="s1">geodata/glad_ard/median_??_${B}b.vrt geodata/glad_ard/median_??_${B}b.vrt geodata/glad_ard/median_??_${B}b.vrt</span>

<span class="s1">## gap filling with the akima spline</span>
<span class="s1">pkfilter -of GTiff -co COMPRESS=LZW -co ZLEVEL=9 -nodata 0 -f smoothnodata -dz 1 -interp akima \</span>
<span class="s1">-i geodata/glad_ard/median_tseries_${B}b.vrt -o geodata/glad_ard/median_akima_${B}b_tmp.tif</span>

<span class="s1">## reselecto only the 16-day time-series in the center</span>
<span class="s1">gdal_translate  -co COMPRESS=LZW -co ZLEVEL=9 $(for b in $(seq 24 46); do echo &quot;-b $b&quot; ; done) \</span>
<span class="s1">geodata/glad_ard/median_akima_${B}b_tmp.tif geodata/glad_ard/median_akima_${B}b.tif</span>
<span class="s1">rm geodata/glad_ard/median_akima_${B}b_tmp.tif</span>

<span class="s1">## gap filling with the steffen spline</span>
<span class="s1">pkfilter -of GTiff -co COMPRESS=LZW -co ZLEVEL=9 -nodata 0 -f smoothnodata -dz 1 -interp steffen \</span>
<span class="s1">-i geodata/glad_ard/median_tseries_${B}b.vrt -o geodata/glad_ard/median_steffen_${B}b_tmp.tif</span>

<span class="s1">## reselecto only the 16-day time-series in the center</span>
<span class="s1">gdal_translate  -co COMPRESS=LZW -co ZLEVEL=9 $(for b in $(seq 24 46); do echo &quot;-b $b&quot; ; done) \</span>
<span class="s1">geodata/glad_ard/median_steffen_${B}b_tmp.tif geodata/glad_ard/median_steffen_${B}b.tif</span>
<span class="s1">rm geodata/glad_ard/median_steffen_${B}b_tmp.tif</span>
<span class="s1">&#39;</span><span class="w"> </span>_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
opening output image geodata/glad_ard/median_akima_1b_tmp.tif with 69 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
opening output image geodata/glad_ard/median_steffen_1b_tmp.tif with 69 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
Input file size is 400, 440
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
<p>At this point all the immages have been re-fill.</p>
</section>
<section id="Plotting-the-temporal-interpolation-for-band-1">
<h2>Plotting the temporal interpolation for band 1<a class="headerlink" href="#Plotting-the-temporal-interpolation-for-band-1" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
R<span class="w"> </span>--vanilla<span class="w"> </span>-q
<span class="c1"># open a terminal and run this line for the installation</span>
<span class="c1"># install.packages(&quot;Rcpp&quot;)</span>
<span class="c1"># install.packages(&quot;rgdal&quot;)</span>
<span class="c1"># install.packages(&quot;raster&quot;)</span>
library<span class="o">(</span>sp<span class="o">)</span>
library<span class="o">(</span>raster<span class="o">)</span>
<span class="nv">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>stack<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/median_steffen_1b.tif&quot;</span><span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/median_steffen_1b.png&quot;</span><span class="o">)</span>
<span class="nv">pal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>colorRampPalette<span class="o">(</span>rev<span class="o">(</span>rainbow<span class="o">(</span><span class="m">20</span><span class="o">)))</span>
plot<span class="o">(</span>stack<span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span>pal<span class="o">(</span><span class="m">20</span><span class="o">))</span>
dev.off<span class="o">()</span>
<span class="nv">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>stack<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/median_tseries_1b.vrt&quot;</span><span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/median_tseries_1b.png&quot;</span><span class="o">)</span>
<span class="nv">pal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>colorRampPalette<span class="o">(</span>rev<span class="o">(</span>rainbow<span class="o">(</span><span class="m">20</span><span class="o">)))</span>
plot<span class="o">(</span>stack<span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span>pal<span class="o">(</span><span class="m">20</span><span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; # open a terminal and run this line for the installation
&gt; # install.packages(&#34;Rcpp&#34;)
&gt; # install.packages(&#34;rgdal&#34;)
&gt; # install.packages(&#34;raster&#34;)
&gt; library(sp)
&gt; library(raster)
&gt; stack = stack(&#34;geodata/glad_ard/median_steffen_1b.tif&#34;)
&gt; png(&#34;../images/median_steffen_1b.png&#34;)
&gt; pal = colorRampPalette(rev(rainbow(20)))
&gt; plot(stack , col=pal(20))
&gt; dev.off()
null device
          1
&gt; stack = stack(&#34;geodata/glad_ard/median_tseries_1b.vrt&#34;)
&gt; png(&#34;../images/median_tseries_1b.png&#34;)
&gt; pal = colorRampPalette(rev(rainbow(20)))
&gt; plot(stack , col=pal(20))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<p><strong>Before interpolation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/median_tseries_1b.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_18_0.png" src="../_images/CASESTUDY_temporal_interpolation_18_0.png" />
</div>
</div>
<p><strong>After interpolation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/median_steffen_1b.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_20_0.png" src="../_images/CASESTUDY_temporal_interpolation_20_0.png" />
</div>
</div>
</section>
<section id="Assessing-the-temporal-interpolation">
<h2>Assessing the temporal interpolation<a class="headerlink" href="#Assessing-the-temporal-interpolation" title="Link to this heading"></a></h2>
<p>We select one pixel in the images and we plot its values acros time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;day tseries akima steffen&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>geodata/glad_ard/day_orig_akima_steffen.txt
paste<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span>&lt;<span class="o">(</span><span class="k">for</span><span class="w"> </span>day<span class="w"> </span><span class="k">in</span><span class="w">  </span><span class="m">01</span><span class="w"> </span><span class="m">02</span><span class="w"> </span><span class="m">03</span><span class="w"> </span><span class="m">04</span><span class="w"> </span><span class="m">05</span><span class="w"> </span><span class="m">06</span><span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">09</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">23</span><span class="k">)</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">  </span>expr<span class="w"> </span><span class="nv">$day</span><span class="w"> </span><span class="se">\*</span><span class="w"> </span><span class="m">16</span><span class="w"> </span>-<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="o">)</span><span class="w"> </span><span class="se">\</span>
<span class="w"> </span>&lt;<span class="o">(</span>gdallocationinfo<span class="w"> </span>-valonly<span class="w"> </span>-geoloc<span class="w"> </span>geodata/glad_ard/median_tseries_1b.vrt<span class="w">       </span><span class="m">15</span>.2866<span class="w"> </span><span class="m">38</span>.0539<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-23<span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="se">\</span>
<span class="w"> </span>&lt;<span class="o">(</span>gdallocationinfo<span class="w"> </span>-valonly<span class="w"> </span>-geoloc<span class="w"> </span>geodata/glad_ard/median_akima_1b.tif<span class="w">         </span><span class="m">15</span>.2866<span class="w"> </span><span class="m">38</span>.0539<span class="o">)</span><span class="se">\</span>
<span class="w"> </span>&lt;<span class="o">(</span>gdallocationinfo<span class="w"> </span>-valonly<span class="w"> </span>-geoloc<span class="w"> </span>geodata/glad_ard/median_steffen_1b.tif<span class="w"> </span><span class="m">15</span>.2866<span class="w"> </span><span class="m">38</span>.0539<span class="o">)</span><span class="w"> </span><span class="se">\</span>
<span class="w"> </span>&gt;&gt;<span class="w"> </span>geodata/glad_ard/day_orig_akima_steffen.txt
</pre></div>
</div>
</div>
<p>We obtained a table with 4 Columns. The zero in the second column rapresent No-Data and is the one that we had interpolated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>cat<span class="w"> </span>geodata/glad_ard/day_orig_akima_steffen.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
day tseries akima steffen
8 0 1028 1056
24 0 1176 1182
40 1309 1309 1309
56 0 1427 1416
72 0 1538 1522
88 1629 1629 1629
104 1554 1554 1554
120 1577 1577 1577
136 1370 1370 1370
152 1465 1465 1465
168 1466 1466 1466
184 1412 1412 1412
200 1342 1342 1342
216 1239 1239 1239
232 1376 1376 1376
248 1479 1479 1479
264 0 1421 1351
280 0 1277 1224
296 0 1107 1096
312 968 968 968
328 0 843 885
344 802 802 802
360 0 894 929
</pre></div></div>
</div>
<p>We import in R for plotting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
R<span class="w"> </span>--vanilla<span class="w"> </span>-q
<span class="nv">tseries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_orig_akima_steffen.txt&quot;</span>,<span class="w"> </span><span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
str<span class="o">(</span>tseries<span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/plot_interpolation1.png&quot;</span><span class="o">)</span>
plot<span class="o">(</span>tseries<span class="nv">$day</span>,<span class="w"> </span>tseries<span class="nv">$tseries</span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">4</span>,<span class="w"> </span><span class="nv">cex</span><span class="o">=</span><span class="m">2</span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span>,<span class="w"> </span><span class="nv">xlab</span><span class="o">=(</span><span class="s2">&quot;Day of the year&quot;</span><span class="o">)</span>,<span class="w"> </span><span class="nv">ylab</span><span class="o">=(</span><span class="s2">&quot;Spectral digital number&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span>,<span class="w"> </span>tseries<span class="nv">$steffen</span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">19</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span>,<span class="w"> </span>tseries<span class="nv">$akima</span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="o">)</span>
legend<span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">1</span>,y<span class="o">=</span><span class="m">700</span>,c<span class="o">(</span><span class="s2">&quot;Original&quot;</span>,<span class="s2">&quot;Steffen interp&quot;</span>,<span class="s2">&quot;Akima interp&quot;</span><span class="o">)</span>,cex<span class="o">=</span><span class="m">1</span>.4,col<span class="o">=</span>c<span class="o">(</span><span class="s2">&quot;blue&quot;</span>,<span class="s2">&quot;red&quot;</span>,<span class="s2">&quot;black&quot;</span><span class="o">)</span>,pch<span class="o">=</span>c<span class="o">(</span><span class="m">4</span>,19,1<span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; tseries = read.table(&#34;geodata/glad_ard/day_orig_akima_steffen.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; str(tseries)
&#39;data.frame&#39;:   23 obs. of  4 variables:
 $ day    : int  8 24 40 56 72 88 104 120 136 152 ...
 $ tseries: int  0 0 1309 0 0 1629 1554 1577 1370 1465 ...
 $ akima  : int  1028 1176 1309 1427 1538 1629 1554 1577 1370 1465 ...
 $ steffen: int  1056 1182 1309 1416 1522 1629 1554 1577 1370 1465 ...
&gt; png(&#34;../images/plot_interpolation1.png&#34;)
&gt; plot(tseries$day, tseries$tseries, pch=4, cex=2, col=&#34;blue&#34;, xlab=(&#34;Day of the year&#34;), ylab=(&#34;Spectral digital number&#34;) )
&gt; points(tseries$day, tseries$steffen, col=&#34;red&#34;, pch=19 )
&gt; points(tseries$day, tseries$akima, pch=1 )
&gt; legend(x=1,y=700,c(&#34;Original&#34;,&#34;Steffen interp&#34;,&#34;Akima interp&#34;),cex=1.4,col=c(&#34;blue&#34;,&#34;red&#34;,&#34;black&#34;),pch=c(4,19,1))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/plot_interpolation1.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_27_0.png" src="../_images/CASESTUDY_temporal_interpolation_27_0.png" />
</div>
</div>
<p>You can noticed that Steffen and Akima present same differences only in the interpolated pixels. The orginal values have been kept constant for both method.</p>
</section>
<section id="Savitzky–Golay-smoothing-filter">
<h2>Savitzky–Golay smoothing filter<a class="headerlink" href="#Savitzky–Golay-smoothing-filter" title="Link to this heading"></a></h2>
<p>We can use the Savitzky–Golay filter to smooth out the spectral response.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/Savitzky_Golay.gif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;IPython.core.display.Image object&gt;
</pre></div></div>
</div>
<p>Run Savitzky–Golay smoothing filter</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash

<span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>-P<span class="w"> </span><span class="m">1</span><span class="w">  </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">$&#39;</span>
<span class="s1">B=$1</span>
<span class="s1">pkfilter -co COMPRESS=LZW -co ZLEVEL=9 -f savgolay -nl 3 -nr 3 -m 2 -pad replicate -i geodata/glad_ard/median_akima_${B}b.tif -o geodata/glad_ard/median_savgolay_${B}b.tif</span>
<span class="s1">&#39;</span><span class="w"> </span>_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
opening output image geodata/glad_ard/median_savgolay_1b.tif with 23 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
</section>
<section id="Assessing-the-Savitzky–Golay-smoothing-filter">
<h2>Assessing the Savitzky–Golay smoothing filter<a class="headerlink" href="#Assessing-the-Savitzky–Golay-smoothing-filter" title="Link to this heading"></a></h2>
<p>We use the lat lon location to extract the value for the Savitzky–Golay smoothing filter and we plot against the previus values</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;savgolay&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>geodata/glad_ard/savgolay.txt
gdallocationinfo<span class="w"> </span>-valonly<span class="w"> </span>-geoloc<span class="w"> </span>geodata/glad_ard/median_savgolay_1b.tif<span class="w"> </span><span class="m">15</span>.2866<span class="w"> </span><span class="m">38</span>.0539<span class="w">  </span>&gt;&gt;<span class="w"> </span>geodata/glad_ard/savgolay.txt
paste<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span>geodata/glad_ard/day_orig_akima_steffen.txt<span class="w"> </span>geodata/glad_ard/savgolay.txt<span class="w"> </span>&gt;<span class="w"> </span>geodata/glad_ard/day_orig_akima_steffen_savgolay.txt
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>cat<span class="w"> </span>geodata/glad_ard/day_orig_akima_steffen_savgolay.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
day tseries akima steffen savgolay
8 0 1028 1056 1072
24 0 1176 1182 1166
40 1309 1309 1309 1294
56 0 1427 1416 1444
72 0 1538 1522 1533
88 1629 1629 1629 1600
104 1554 1554 1554 1574
120 1577 1577 1577 1517
136 1370 1370 1370 1468
152 1465 1465 1465 1450
168 1466 1466 1466 1430
184 1412 1412 1412 1398
200 1342 1342 1342 1330
216 1239 1239 1239 1328
232 1376 1376 1376 1374
248 1479 1479 1479 1418
264 0 1421 1351 1406
280 0 1277 1224 1286
296 0 1107 1096 1117
312 968 968 968 956
328 0 843 885 866
344 802 802 802 839
360 0 894 929 853
</pre></div></div>
</div>
<p>We import in R for plotting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
R<span class="w"> </span>--vanilla<span class="w"> </span>-q
<span class="nv">tseries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&quot;</span>,<span class="w"> </span><span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
str<span class="o">(</span>tseries<span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/plot_interpolation2.png&quot;</span><span class="o">)</span>
plot<span class="o">(</span>tseries<span class="nv">$day</span><span class="w"> </span>,<span class="w">  </span>tseries<span class="nv">$tseries</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">4</span><span class="w"> </span>,<span class="w"> </span><span class="nv">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">xlab</span><span class="o">=(</span><span class="s2">&quot;Day of the year&quot;</span><span class="o">)</span><span class="w"> </span>,<span class="w"> </span><span class="nv">ylab</span><span class="o">=(</span><span class="s2">&quot;Spectral digital number&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries<span class="nv">$steffen</span><span class="w">  </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">19</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries<span class="nv">$akima</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries<span class="nv">$savgolay</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">)</span>
legend<span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">1</span>,y<span class="o">=</span><span class="m">700</span>,c<span class="o">(</span><span class="s2">&quot;Original&quot;</span>,<span class="s2">&quot;Steffen interp&quot;</span>,<span class="s2">&quot;Akima interp&quot;</span>,<span class="s2">&quot;Savitzky-Golay smoothness&quot;</span><span class="o">)</span>,cex<span class="o">=</span><span class="m">1</span>.4,col<span class="o">=</span>c<span class="o">(</span><span class="s2">&quot;blue&quot;</span>,<span class="s2">&quot;red&quot;</span>,<span class="s2">&quot;black&quot;</span>,col<span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">)</span>,pch<span class="o">=</span>c<span class="o">(</span><span class="m">4</span>,19,1,3<span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; tseries = read.table(&#34;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; str(tseries)
&#39;data.frame&#39;:   23 obs. of  5 variables:
 $ day     : int  8 24 40 56 72 88 104 120 136 152 ...
 $ tseries : int  0 0 1309 0 0 1629 1554 1577 1370 1465 ...
 $ akima   : int  1028 1176 1309 1427 1538 1629 1554 1577 1370 1465 ...
 $ steffen : int  1056 1182 1309 1416 1522 1629 1554 1577 1370 1465 ...
 $ savgolay: int  1072 1166 1294 1444 1533 1600 1574 1517 1468 1450 ...
&gt; png(&#34;../images/plot_interpolation2.png&#34;)
&gt; plot(tseries$day ,  tseries$tseries , pch=4 , cex = 2 , col=&#34;blue&#34; , xlab=(&#34;Day of the year&#34;) , ylab=(&#34;Spectral digital number&#34;) )
&gt; points(tseries$day , tseries$steffen  , col=&#34;red&#34; , pch=19 )
&gt; points(tseries$day , tseries$akima , pch=1 )
&gt; points(tseries$day , tseries$savgolay , pch=3 , col=&#34;green&#34;)
&gt; legend(x=1,y=700,c(&#34;Original&#34;,&#34;Steffen interp&#34;,&#34;Akima interp&#34;,&#34;Savitzky-Golay smoothness&#34;),cex=1.4,col=c(&#34;blue&#34;,&#34;red&#34;,&#34;black&#34;,col=&#34;green&#34;),pch=c(4,19,1,3))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/plot_interpolation2.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_38_0.png" src="../_images/CASESTUDY_temporal_interpolation_38_0.png" />
</div>
</div>
</section>
<section id="Wavelet-prediction">
<h2>Wavelet prediction<a class="headerlink" href="#Wavelet-prediction" title="Link to this heading"></a></h2>
<p>We use the Wavelet tecnique to predic the value for the 15 of each month</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash

<span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>-P<span class="w"> </span><span class="m">1</span><span class="w">  </span>bash<span class="w"> </span>-c<span class="w"> </span><span class="s1">$&#39;</span>
<span class="s1">B=$1</span>
<span class="s1">pkfilter -of GTiff -co COMPRESS=LZW -co ZLEVEL=9 \</span>
<span class="s1">$(for day in  01 02 03 04 05 06 07 08 09 $( seq 10 23 )  ; do  echo &quot;-win&quot;  $(expr $day \\* 16  - 8) ; done) \</span>
<span class="s1">$(for day in  01 02 03 04 05 06 07 08 09 10 11 12   ; do  echo &quot;-wout&quot;  $(expr $day \\* 31  - 15) &quot;-fwhm&quot; 50  ; done  )  \</span>
<span class="s1">-i geodata/glad_ard/median_akima_${B}b.tif  -o geodata/glad_ard/median_akima_wavelet_${B}b.tif</span>
<span class="s1">&#39;</span><span class="w"> </span>_
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
opening output image geodata/glad_ard/median_akima_wavelet_1b.tif with 12 bands
0...10...20...30...40...50...60...70...80...90...100 - done.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;day wavelet&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>geodata/glad_ard/day_wavelet.txt
paste<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span>&lt;<span class="o">(</span><span class="w">  </span><span class="k">for</span><span class="w"> </span>day<span class="w"> </span><span class="k">in</span><span class="w">  </span><span class="m">01</span><span class="w"> </span><span class="m">02</span><span class="w"> </span><span class="m">03</span><span class="w"> </span><span class="m">04</span><span class="w"> </span><span class="m">05</span><span class="w"> </span><span class="m">06</span><span class="w"> </span><span class="m">07</span><span class="w"> </span><span class="m">08</span><span class="w"> </span><span class="m">09</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">12</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w">    </span>expr<span class="w"> </span><span class="nv">$day</span><span class="w"> </span><span class="se">\*</span><span class="w"> </span><span class="m">31</span><span class="w">  </span>-<span class="w"> </span><span class="m">15</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w">   </span><span class="o">)</span><span class="w"> </span><span class="se">\</span>
&lt;<span class="o">(</span>gdallocationinfo<span class="w"> </span>-valonly<span class="w">  </span>-geoloc<span class="w"> </span>geodata/glad_ard/median_akima_wavelet_1b.tif<span class="w"> </span><span class="m">15</span>.2866<span class="w"> </span><span class="m">38</span>.0539<span class="w"> </span><span class="o">)</span><span class="w">  </span>&gt;&gt;<span class="w"> </span>geodata/glad_ard/day_wavelet.txt
cat<span class="w"> </span>geodata/glad_ard/day_wavelet.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
day wavelet
16 1204
47 1363
78 1526
109 1542
140 1467
171 1424
202 1353
233 1369
264 1350
295 1129
326 915
357 842
</pre></div></div>
</div>
<p>We import in R for plotting</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash
R<span class="w"> </span>--vanilla<span class="w"> </span>-q
<span class="nv">tseries1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&quot;</span>,<span class="w"> </span><span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
<span class="nv">tseries2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>read.table<span class="o">(</span><span class="s2">&quot;geodata/glad_ard/day_wavelet.txt&quot;</span>,<span class="w"> </span><span class="nv">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">header</span><span class="o">=</span>TRUE<span class="o">)</span>
png<span class="o">(</span><span class="s2">&quot;../images/plot_interpolation3.png&quot;</span><span class="w"> </span><span class="o">)</span>
plot<span class="o">(</span>tseries1<span class="nv">$day</span><span class="w"> </span>,<span class="w">  </span>tseries1<span class="nv">$tseries</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">4</span><span class="w"> </span>,<span class="w"> </span><span class="nv">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">xlab</span><span class="o">=(</span><span class="s2">&quot;Day of the year&quot;</span><span class="o">)</span><span class="w"> </span>,<span class="w"> </span><span class="nv">ylab</span><span class="o">=(</span><span class="s2">&quot;Spectral digital number&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries1<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries1<span class="nv">$steffen</span><span class="w">  </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">19</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries1<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries1<span class="nv">$akima</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="o">)</span>
points<span class="o">(</span>tseries1<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries1<span class="nv">$savgolay</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">3</span><span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">)</span>
points<span class="o">(</span>tseries2<span class="nv">$day</span><span class="w"> </span>,<span class="w"> </span>tseries2<span class="nv">$wavelet</span><span class="w"> </span>,<span class="w"> </span><span class="nv">pch</span><span class="o">=</span><span class="m">5</span><span class="w"> </span>,<span class="w"> </span><span class="nv">col</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="o">)</span>
legend<span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">1</span>,y<span class="o">=</span><span class="m">700</span>,c<span class="o">(</span><span class="s2">&quot;Original&quot;</span>,<span class="s2">&quot;Steffen interp&quot;</span>,<span class="s2">&quot;Akima interp&quot;</span>,<span class="s2">&quot;Savitzky-Golay smoothness&quot;</span>,<span class="s2">&quot;Wavelet prediction&quot;</span><span class="o">)</span>,cex<span class="o">=</span><span class="m">1</span>.4,col<span class="o">=</span>c<span class="o">(</span><span class="s2">&quot;blue&quot;</span>,<span class="s2">&quot;red&quot;</span>,<span class="s2">&quot;black&quot;</span>,<span class="s2">&quot;green&quot;</span>,<span class="s2">&quot;orange&quot;</span><span class="o">)</span>,pch<span class="o">=</span>c<span class="o">(</span><span class="m">4</span>,19,1,3,5<span class="o">))</span>
dev.off<span class="o">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&gt; tseries1 = read.table(&#34;geodata/glad_ard/day_orig_akima_steffen_savgolay.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; tseries2 = read.table(&#34;geodata/glad_ard/day_wavelet.txt&#34;, sep=&#34; &#34; , header=TRUE)
&gt; png(&#34;../images/plot_interpolation3.png&#34; )
&gt; plot(tseries1$day ,  tseries1$tseries , pch=4 , cex = 2 , col=&#34;blue&#34; , xlab=(&#34;Day of the year&#34;) , ylab=(&#34;Spectral digital number&#34;) )
&gt; points(tseries1$day , tseries1$steffen  , col=&#34;red&#34; , pch=19 )
&gt; points(tseries1$day , tseries1$akima , pch=1 )
&gt; points(tseries1$day , tseries1$savgolay , pch=3 , col=&#34;green&#34;)
&gt; points(tseries2$day , tseries2$wavelet , pch=5 , col=&#34;orange&#34;)
&gt; legend(x=1,y=700,c(&#34;Original&#34;,&#34;Steffen interp&#34;,&#34;Akima interp&#34;,&#34;Savitzky-Golay smoothness&#34;,&#34;Wavelet prediction&#34;),cex=1.4,col=c(&#34;blue&#34;,&#34;red&#34;,&#34;black&#34;,&#34;green&#34;,&#34;orange&#34;),pch=c(4,19,1,3,5))
&gt; dev.off()
null device
          1
&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;../images/plot_interpolation3.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/CASESTUDY_temporal_interpolation_44_0.png" src="../_images/CASESTUDY_temporal_interpolation_44_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Data_type_GTiff.html" class="btn btn-neutral float-left" title="Data type in GTiff" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="DTW.html" class="btn btn-neutral float-right" title="Dynamic Time Warping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Giuseppe Amatulli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>