<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.10. Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.11. Hyeyoung Sim: Clustering Electric Vehicle Charging Pattern with DTW and EV Charging energy demand Prediction with LSTM" href="Clustering_Electric_Vehicle_Charging_Pattern_with_DTW_and_EV_Charging_energy_demand_Prediction_with_LSTM_Hyeyoung_Sim.html" />
    <link rel="prev" title="2.9. Txomin Bornaetxea: Modeling debris flow source areas" href="Modeling_debris_flow_source_areas_Txomin_Bornaetxea.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Spatial Ecology's code documentation
            <img src="../../_static/SE_compact.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2022.html">GeoComp &amp; ML 2022 course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_Colab_for_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_OSGeoLive_for_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_OSGeoLive_curso_para_Ecologia_Espacial.html">Prepare OSGeoLive para el curso de ecolog√≠a espacial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AWK/awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GDAL/gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GDAL/gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_introduction.html">Introdction to pyjeo: installation and raster visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_pktools.html">Performing raster and vector operations in Python using pyjeo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../R/R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Geo_Python.html">Python &amp; GeoComputation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_intro.html">GRASS Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_hydro.html">Using GRASS for stream-network extraction and basins delineation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CASE STUDY</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/temporal_interpolation.html">Temporal interpolation of landsat images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/DTW.html">Dynamic Time Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/pred_NP.html">Estimating nitrogen and phosphorus concentrations in streams and rivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day1.html">Estimating nitrogen concentrations in streams and rivers using NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day2.html">Autoencoder (AE), Variational Autoencoder (VAE) and Generative Adversarial Network (GAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day3.html">LSTM Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_01DataExplore.html">Estimation of tree height using GEDI dataset - Data explore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_02SVM_pred.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_03RF_pred.html">Estimation of tree height using GEDI dataset - Random Forest prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04Perceptron_pred.html">Estimation of tree height using GEDI dataset - Perceptron 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04Perceptron_pred_clean.html">Estimation of tree height using GEDI dataset - Clean Data - Perceptron 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_05NeuralNets_pred.html">Estimation of tree height using GEDI dataset - Neural Network 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NNs_pt3_SHAP.html">Neural Nets (pt.3), Interpretability and Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/CNN_satelite.html">Using Multi-layer Perceptron and Convolutional Neural Networks for Satellite image classification.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html">The real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#LSTM-for-Regression-Using-the-Window-Method">LSTM for Regression Using the Window Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#LSTM-for-Regression-with-Time-Steps">LSTM for Regression with Time Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#LSTM-with-Memory-Between-Batches">LSTM with Memory Between Batches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#Stacked-LSTMs-with-Memory-Between-Batches">Stacked LSTMs with Memory Between Batches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#Adding-Early-Stopping">Adding Early Stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#Multivariate-Time-series---Data">Multivariate Time-series - Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Students Projects</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">1. 2021 SWEDEN</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#matera">2. 2022 MATERA</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Damaged_trees_classification_RF_Janusz_Godziek.html">2.1. Janusz Godziek: Damaged vs undamaged trees - Random Forest classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="Stream_Network_Abstraction_Alonso_Gonzalez.html">2.2. Alonso Gonzalez: Stream Network Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Images_shadow_removal_Sebastian_Walter.html">2.3. Sebastian Walter: Images shadow removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="Using_a_LSTM_network_and_SHAP_to_determine_the_impact_of_drought_Florian_Ells%C3%A4%C3%9Fer.html">2.4. Florian Ells√§√üer: Using a LSTM network and SHAP to determine the impact of drought and season on winter wheat</a></li>
<li class="toctree-l2"><a class="reference internal" href="Spectral_clustering_of_freshwater_habitats_Maria_%C3%9Cblacker.html">2.5. Maria √úblacker: Spectral clustering of freshwater habitats</a></li>
<li class="toctree-l2"><a class="reference internal" href="Species_Distribution_Model_with_Random_Forest_Afroditi_Grigoropoulou.html">2.6. Afroditi Grigoropoulou: Species Distribution Model with Random Forest</a></li>
<li class="toctree-l2"><a class="reference internal" href="Topographic_and_hydrological_influence_on_vegetation_in_an_arid_environment_Gidske_L_Andersen.html">2.7. Gidske L. Andersen: Topographic and hydrological influence on vegetation in an arid environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="Distributionof_Fresh_water_Biodiversity_AcrossCuba_Yusdiel_Torres.html">2.8. Yusdiel Torres-Cambas: Distribution of freshwater biodiversity across Cuba</a></li>
<li class="toctree-l2"><a class="reference internal" href="Modeling_debris_flow_source_areas_Txomin_Bornaetxea.html">2.9. Txomin Bornaetxea: Modeling debris flow source areas</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.10. Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Project-Description">2.10.1. Project Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Data-Description">2.10.2. Data Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Random-Forest-Regression-(RFR)">2.10.3. Random Forest Regression (RFR)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Support-Vector-Machine-for-Regression-(SVR)">2.10.3.1. Support Vector Machine for Regression (SVR)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Feedfoward-neural-network-(FF-NN)">2.10.4. Feedfoward neural network (FF-NN)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Predict-the-raster-using-RFR">2.10.4.1. Predict the raster using RFR</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Clustering_Electric_Vehicle_Charging_Pattern_with_DTW_and_EV_Charging_energy_demand_Prediction_with_LSTM_Hyeyoung_Sim.html">2.11. Hyeyoung Sim: Clustering Electric Vehicle Charging Pattern with DTW and EV Charging energy demand Prediction with LSTM</a></li>
<li class="toctree-l2"><a class="reference internal" href="Classification_of_different_tree_species_plantations_using_deep_learning_Hemalatha_Velappan.html">2.12. Hemalatha Velappan: Classification of different tree species plantations using deep learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="Ships_and_economic_activity_a_starter_Myriam_Marending.html">2.13. Myriam Marending: Ships and economic activity: a starter</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OUTDOOR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OUTDOOR/outdoor_orientering.html">Do not get lost in the wilderness</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TALKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TALKS/intelligent_modelling.html">Intelligent modelling in time and space: combine GeoComputation and Machine Learning for  environmental application.</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/video.html">Video tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/Compiling_OTB.html">Compiling OTB from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Spatial Ecology's code documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html"><span class="section-number">1. </span>2021 SWEDEN</a> &raquo;</li>
      <li><span class="section-number">2.10. </span>Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/STUDENTSPROJECTS/Proj_2022_Matera/Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Ritwika-Mukhopadhyay:-Comparative-Analysis-of-the-prediction-of-AGB-using-Random-Forest-Regression,-Support-Vector-Machine-for-Regression-&amp;-FeedForward-Neural-Network">
<h1><span class="section-number">2.10. </span>Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network<a class="headerlink" href="#Ritwika-Mukhopadhyay:-Comparative-Analysis-of-the-prediction-of-AGB-using-Random-Forest-Regression,-Support-Vector-Machine-for-Regression-&-FeedForward-Neural-Network" title="Permalink to this headline">ÔÉÅ</a></h1>
<div class="line-block">
<div class="line"><a class="reference external" href="http://spatial-ecology.net/docs/source/STUDENTSPROJECTS/Proj_2022_Matera/Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay.pdf">Presentation</a></div>
<div class="line"><a class="reference external" href="https://youtu.be/5KthbToljUc">Video recording</a></div>
</div>
<section id="Project-Description">
<h2><span class="section-number">2.10.1. </span>Project Description<a class="headerlink" href="#Project-Description" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>The main objective was to predict forest aboveground biomass (AGB) with the metrics derived from airborne laser scanner (ALS) data. The field data for the sample plots were collected by Swedish National Forest Inventory (NFI) and a sub-area was selected from the entire forest region for this case study. Three models were compared on their efficiencies of AGB prediction - random forest regression (RFR), support vector machine for regression (SVR) and feed forward neural network (FF-NN). Finally
the AGB predictions were extrapolated for the entire region using the wall-to-wall maps for the RFR.</p>
</section>
<section id="Data-Description">
<h2><span class="section-number">2.10.2. </span>Data Description<a class="headerlink" href="#Data-Description" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>Field reference and ALS data were collected during the years 2015-19.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import libraries</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">pyspatialml</span> <span class="kn">import</span> <span class="n">Raster</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span><span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span> <span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">6.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import dataset</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;txt/NFI_all_T2.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># change column name</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">predictors</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;dev-magnitude&#39;</span><span class="p">:</span><span class="s1">&#39;devmagnitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Elev P80&#39;</span><span class="p">:</span><span class="s1">&#39;p80&#39;</span><span class="p">,</span> <span class="s1">&#39;Canopy relief ratio&#39;</span><span class="p">:</span><span class="s1">&#39;crr&#39;</span><span class="p">}</span> <span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Taxar</th>
      <th>TraktNr</th>
      <th>PalslagNr</th>
      <th>DelytaNr</th>
      <th>IsPermanen</th>
      <th>Ostkoordin</th>
      <th>Nordkoordi</th>
      <th>Lan</th>
      <th>Lan_kort</th>
      <th>Agoslag</th>
      <th>Internatio</th>
      <th>TorrviktSt</th>
      <th>TorrviktGr</th>
      <th>TorrviktRo</th>
      <th>TorrviktAl</th>
      <th>TotalAGB</th>
      <th>id</th>
      <th>datum</th>
      <th>kommentar</th>
      <th>flyghojd</th>
      <th>flyghastig</th>
      <th>overtackni</th>
      <th>punkttathe</th>
      <th>skannerid</th>
      <th>skannerfab</th>
      <th>skannermod</th>
      <th>oppningsvi</th>
      <th>pulsfrekve</th>
      <th>skanningsf</th>
      <th>uteffekt</th>
      <th>square</th>
      <th>Block</th>
      <th>SkannDat</th>
      <th>N</th>
      <th>E</th>
      <th>Las_Namn</th>
      <th>Skanner2</th>
      <th>Region</th>
      <th>LOV_AVL</th>
      <th>NEAR_FID</th>
      <th>NEAR_DIST</th>
      <th>DataFile</th>
      <th>FileTitle</th>
      <th>Total return count</th>
      <th>Total return count above 1.50</th>
      <th>Return 1 count above 1.50</th>
      <th>Return 2 count above 1.50</th>
      <th>Return 3 count above 1.50</th>
      <th>Return 4 count above 1.50</th>
      <th>Return 5 count above 1.50</th>
      <th>Return 6 count above 1.50</th>
      <th>Return 7 count above 1.50</th>
      <th>Return 8 count above 1.50</th>
      <th>Return 9 count above 1.50</th>
      <th>Other return count above 1.50</th>
      <th>Elev minimum</th>
      <th>Elev maximum</th>
      <th>Elev mean</th>
      <th>Elev mode</th>
      <th>Elev stddev</th>
      <th>Elev variance</th>
      <th>Elev CV</th>
      <th>Elev IQ</th>
      <th>Elev skewness</th>
      <th>Elev kurtosis</th>
      <th>Elev AAD</th>
      <th>Elev MAD median</th>
      <th>Elev MAD mode</th>
      <th>Elev L1</th>
      <th>Elev L2</th>
      <th>Elev L3</th>
      <th>Elev L4</th>
      <th>Elev L CV</th>
      <th>Elev L skewness</th>
      <th>Elev L kurtosis</th>
      <th>Elev P01</th>
      <th>Elev P05</th>
      <th>Elev P10</th>
      <th>Elev P20</th>
      <th>Elev P25</th>
      <th>Elev P30</th>
      <th>Elev P40</th>
      <th>Elev P50</th>
      <th>Elev P60</th>
      <th>Elev P70</th>
      <th>Elev P75</th>
      <th>p80</th>
      <th>Elev P90</th>
      <th>Elev P95</th>
      <th>Elev P99</th>
      <th>crr</th>
      <th>Elev SQRT mean SQ</th>
      <th>Elev CURT mean CUBE</th>
      <th>Int minimum</th>
      <th>Int maximum</th>
      <th>Int mean</th>
      <th>Int mode</th>
      <th>Int stddev</th>
      <th>Int variance</th>
      <th>Int CV</th>
      <th>Int IQ</th>
      <th>Int skewness</th>
      <th>Int kurtosis</th>
      <th>Int AAD</th>
      <th>Int L1</th>
      <th>Int L2</th>
      <th>Int L3</th>
      <th>Int L4</th>
      <th>Int L CV</th>
      <th>Int L skewness</th>
      <th>Int L kurtosis</th>
      <th>Int P01</th>
      <th>Int P05</th>
      <th>Int P10</th>
      <th>Int P20</th>
      <th>Int P25</th>
      <th>Int P30</th>
      <th>Int P40</th>
      <th>Int P50</th>
      <th>Int P60</th>
      <th>Int P70</th>
      <th>Int P75</th>
      <th>Int P80</th>
      <th>Int P90</th>
      <th>Int P95</th>
      <th>Int P99</th>
      <th>Percentage first returns above 1.50</th>
      <th>Percentage all returns above 1.50</th>
      <th>(All returns above 1.50) / (Total first returns) * 100</th>
      <th>First returns above 1.50</th>
      <th>All returns above 1.50</th>
      <th>Percentage first returns above mean</th>
      <th>Percentage first returns above mode</th>
      <th>Percentage all returns above mean</th>
      <th>Percentage all returns above mode</th>
      <th>(All returns above mean) / (Total first returns) * 100</th>
      <th>(All returns above mode) / (Total first returns) * 100</th>
      <th>First returns above mean</th>
      <th>First returns above mode</th>
      <th>All returns above mean</th>
      <th>All returns above mode</th>
      <th>Total first returns</th>
      <th>Total all returns</th>
      <th>Profile area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017</td>
      <td>5625</td>
      <td>403</td>
      <td>0</td>
      <td>1</td>
      <td>494081</td>
      <td>6237269</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>65732.439490</td>
      <td>19624.546900</td>
      <td>27261.210090</td>
      <td>112618.19650</td>
      <td>112.618197</td>
      <td>5313</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62350_4925_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6235000</td>
      <td>492500</td>
      <td>19A016_62350_4925_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3962</td>
      <td>231</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62350_4925_20175625403</td>
      <td>811</td>
      <td>440</td>
      <td>358</td>
      <td>75</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.51</td>
      <td>17.270000</td>
      <td>8.205409</td>
      <td>2.010317</td>
      <td>4.592859</td>
      <td>21.094352</td>
      <td>0.559735</td>
      <td>8.515000</td>
      <td>0.154795</td>
      <td>1.664221</td>
      <td>4.068788</td>
      <td>4.300000</td>
      <td>6.054683</td>
      <td>8.205409</td>
      <td>2.638618</td>
      <td>0.137448</td>
      <td>-0.104379</td>
      <td>0.321571</td>
      <td>0.052091</td>
      <td>-0.039558</td>
      <td>1.5600</td>
      <td>2.029500</td>
      <td>2.379000</td>
      <td>3.278000</td>
      <td>3.7500</td>
      <td>4.224</td>
      <td>6.342</td>
      <td>8.065001</td>
      <td>10.006000</td>
      <td>11.785000</td>
      <td>12.265000</td>
      <td>12.850000</td>
      <td>14.574000</td>
      <td>15.250000</td>
      <td>16.839298</td>
      <td>0.424836</td>
      <td>9.400806</td>
      <td>10.277259</td>
      <td>127</td>
      <td>1622</td>
      <td>382.668182</td>
      <td>174.460317</td>
      <td>248.884736</td>
      <td>6.194361e+04</td>
      <td>0.650393</td>
      <td>234.00</td>
      <td>2.060984</td>
      <td>7.754890</td>
      <td>177.008058</td>
      <td>382.668182</td>
      <td>120.554711</td>
      <td>46.633416</td>
      <td>25.590377</td>
      <td>0.315037</td>
      <td>0.386824</td>
      <td>0.212272</td>
      <td>147.119995</td>
      <td>168.650009</td>
      <td>185.400009</td>
      <td>207.000000</td>
      <td>216.00</td>
      <td>229.000000</td>
      <td>261.000000</td>
      <td>305.5</td>
      <td>351.000000</td>
      <td>414.000000</td>
      <td>450.00</td>
      <td>495.000000</td>
      <td>686.000061</td>
      <td>958.000000</td>
      <td>1302.879883</td>
      <td>73.210634</td>
      <td>54.254007</td>
      <td>89.979550</td>
      <td>358</td>
      <td>440</td>
      <td>40.899796</td>
      <td>69.734151</td>
      <td>26.140567</td>
      <td>51.664612</td>
      <td>43.353783</td>
      <td>85.685072</td>
      <td>200</td>
      <td>341</td>
      <td>212</td>
      <td>419</td>
      <td>489</td>
      <td>811</td>
      <td>26.578549</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>5627</td>
      <td>103</td>
      <td>0</td>
      <td>1</td>
      <td>476547</td>
      <td>6239273</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>151893.416500</td>
      <td>54522.253650</td>
      <td>65733.906210</td>
      <td>272149.57640</td>
      <td>272.149576</td>
      <td>5302</td>
      <td>20190417</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8236</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>38</td>
      <td>100</td>
      <td>62375_4750_25</td>
      <td>19A016</td>
      <td>43572</td>
      <td>6237500</td>
      <td>475000</td>
      <td>19A016_62375_4750_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4131</td>
      <td>727</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4750_20175627103</td>
      <td>915</td>
      <td>747</td>
      <td>444</td>
      <td>267</td>
      <td>35</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.51</td>
      <td>20.660000</td>
      <td>10.357416</td>
      <td>6.981429</td>
      <td>5.829134</td>
      <td>33.978801</td>
      <td>0.562798</td>
      <td>11.200000</td>
      <td>0.238884</td>
      <td>1.580427</td>
      <td>5.221311</td>
      <td>4.590000</td>
      <td>3.948572</td>
      <td>10.357416</td>
      <td>3.317782</td>
      <td>0.237466</td>
      <td>-0.157953</td>
      <td>0.320329</td>
      <td>0.071574</td>
      <td>-0.047608</td>
      <td>1.6846</td>
      <td>2.190000</td>
      <td>3.252000</td>
      <td>4.762000</td>
      <td>5.4800</td>
      <td>6.000</td>
      <td>7.080</td>
      <td>8.740000</td>
      <td>11.148000</td>
      <td>15.642000</td>
      <td>16.680000</td>
      <td>17.459999</td>
      <td>18.514000</td>
      <td>19.020000</td>
      <td>19.832399</td>
      <td>0.462006</td>
      <td>11.883156</td>
      <td>13.030966</td>
      <td>0</td>
      <td>11226</td>
      <td>496.734940</td>
      <td>178.190476</td>
      <td>636.854131</td>
      <td>4.055832e+05</td>
      <td>1.282080</td>
      <td>347.00</td>
      <td>12.983658</td>
      <td>216.318892</td>
      <td>266.425316</td>
      <td>496.734940</td>
      <td>186.958346</td>
      <td>75.122169</td>
      <td>52.911774</td>
      <td>0.376374</td>
      <td>0.401812</td>
      <td>0.283014</td>
      <td>126.000000</td>
      <td>153.000000</td>
      <td>171.000000</td>
      <td>221.000000</td>
      <td>241.00</td>
      <td>271.000000</td>
      <td>321.000000</td>
      <td>389.0</td>
      <td>461.000000</td>
      <td>535.600098</td>
      <td>588.00</td>
      <td>658.599915</td>
      <td>880.400146</td>
      <td>1140.800171</td>
      <td>1513.998901</td>
      <td>94.067797</td>
      <td>81.639344</td>
      <td>158.262712</td>
      <td>444</td>
      <td>747</td>
      <td>63.559322</td>
      <td>74.788136</td>
      <td>35.519126</td>
      <td>50.491803</td>
      <td>68.855932</td>
      <td>97.881356</td>
      <td>300</td>
      <td>353</td>
      <td>325</td>
      <td>462</td>
      <td>472</td>
      <td>915</td>
      <td>42.011135</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017</td>
      <td>5627</td>
      <td>303</td>
      <td>0</td>
      <td>1</td>
      <td>476282</td>
      <td>6238964</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>117919.147600</td>
      <td>47228.877970</td>
      <td>54722.666020</td>
      <td>219870.69160</td>
      <td>219.870692</td>
      <td>5302</td>
      <td>20190417</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8236</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>38</td>
      <td>100</td>
      <td>62375_4750_25</td>
      <td>19A016</td>
      <td>43572</td>
      <td>6237500</td>
      <td>475000</td>
      <td>19A016_62375_4750_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4131</td>
      <td>1036</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4750_20175627303</td>
      <td>850</td>
      <td>622</td>
      <td>457</td>
      <td>150</td>
      <td>14</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.63</td>
      <td>22.910000</td>
      <td>15.888280</td>
      <td>17.505555</td>
      <td>3.493125</td>
      <td>12.201924</td>
      <td>0.219855</td>
      <td>4.424999</td>
      <td>-0.698497</td>
      <td>3.820452</td>
      <td>2.754330</td>
      <td>2.230000</td>
      <td>2.330000</td>
      <td>15.888280</td>
      <td>1.941699</td>
      <td>-0.204725</td>
      <td>0.247727</td>
      <td>0.122210</td>
      <td>-0.105436</td>
      <td>0.127583</td>
      <td>6.9882</td>
      <td>9.630000</td>
      <td>11.464000</td>
      <td>13.197999</td>
      <td>13.8750</td>
      <td>14.269</td>
      <td>15.334</td>
      <td>16.240000</td>
      <td>17.120001</td>
      <td>17.896999</td>
      <td>18.299999</td>
      <td>18.858000</td>
      <td>20.077000</td>
      <td>21.019001</td>
      <td>22.095800</td>
      <td>0.670032</td>
      <td>16.267137</td>
      <td>16.584793</td>
      <td>0</td>
      <td>11301</td>
      <td>899.315113</td>
      <td>179.380952</td>
      <td>1332.791523</td>
      <td>1.776333e+06</td>
      <td>1.482007</td>
      <td>749.75</td>
      <td>6.679569</td>
      <td>51.795140</td>
      <td>569.119467</td>
      <td>899.315113</td>
      <td>404.862192</td>
      <td>175.600160</td>
      <td>134.662758</td>
      <td>0.450189</td>
      <td>0.433728</td>
      <td>0.332614</td>
      <td>150.000000</td>
      <td>181.000000</td>
      <td>211.599991</td>
      <td>289.000000</td>
      <td>343.00</td>
      <td>399.200012</td>
      <td>527.799927</td>
      <td>661.5</td>
      <td>837.400024</td>
      <td>1013.000000</td>
      <td>1092.75</td>
      <td>1235.000000</td>
      <td>1456.000244</td>
      <td>1666.950195</td>
      <td>11150.000000</td>
      <td>96.210526</td>
      <td>73.176471</td>
      <td>130.947368</td>
      <td>457</td>
      <td>622</td>
      <td>65.684211</td>
      <td>45.052632</td>
      <td>40.117647</td>
      <td>26.588235</td>
      <td>71.789474</td>
      <td>47.578947</td>
      <td>312</td>
      <td>214</td>
      <td>341</td>
      <td>226</td>
      <td>475</td>
      <td>850</td>
      <td>52.436067</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017</td>
      <td>5627</td>
      <td>403</td>
      <td>0</td>
      <td>1</td>
      <td>476268</td>
      <td>6239247</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>5548.218087</td>
      <td>6461.110215</td>
      <td>3287.615349</td>
      <td>15296.94365</td>
      <td>15.296944</td>
      <td>5302</td>
      <td>20190417</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8236</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>38</td>
      <td>100</td>
      <td>62375_4750_25</td>
      <td>19A016</td>
      <td>43572</td>
      <td>6237500</td>
      <td>475000</td>
      <td>19A016_62375_4750_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4131</td>
      <td>753</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4750_20175627403</td>
      <td>506</td>
      <td>133</td>
      <td>133</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.53</td>
      <td>4.290000</td>
      <td>2.787895</td>
      <td>2.318571</td>
      <td>0.752301</td>
      <td>0.565956</td>
      <td>0.269845</td>
      <td>1.110000</td>
      <td>0.220942</td>
      <td>2.063202</td>
      <td>0.631294</td>
      <td>0.570000</td>
      <td>0.601429</td>
      <td>2.787895</td>
      <td>0.433357</td>
      <td>0.023836</td>
      <td>0.018626</td>
      <td>0.155442</td>
      <td>0.055002</td>
      <td>0.042981</td>
      <td>1.5728</td>
      <td>1.696000</td>
      <td>1.790000</td>
      <td>1.998000</td>
      <td>2.1900</td>
      <td>2.310</td>
      <td>2.524</td>
      <td>2.810000</td>
      <td>3.004000</td>
      <td>3.220000</td>
      <td>3.300000</td>
      <td>3.412000</td>
      <td>3.900000</td>
      <td>4.128000</td>
      <td>4.260400</td>
      <td>0.455759</td>
      <td>2.886877</td>
      <td>2.979856</td>
      <td>208</td>
      <td>2211</td>
      <td>960.150376</td>
      <td>748.492063</td>
      <td>504.494894</td>
      <td>2.545151e+05</td>
      <td>0.525433</td>
      <td>573.00</td>
      <td>0.897953</td>
      <td>2.909312</td>
      <td>398.217762</td>
      <td>960.150376</td>
      <td>276.435976</td>
      <td>61.394064</td>
      <td>34.786777</td>
      <td>0.287909</td>
      <td>0.222091</td>
      <td>0.125840</td>
      <td>259.320007</td>
      <td>342.200012</td>
      <td>404.799988</td>
      <td>519.000000</td>
      <td>623.00</td>
      <td>679.000000</td>
      <td>758.599976</td>
      <td>834.0</td>
      <td>921.199890</td>
      <td>1048.200073</td>
      <td>1196.00</td>
      <td>1388.599854</td>
      <td>1802.600220</td>
      <td>2008.000000</td>
      <td>2207.799805</td>
      <td>28.913043</td>
      <td>26.284585</td>
      <td>28.913043</td>
      <td>133</td>
      <td>133</td>
      <td>14.565217</td>
      <td>20.000000</td>
      <td>13.241107</td>
      <td>18.181818</td>
      <td>14.565217</td>
      <td>20.000000</td>
      <td>67</td>
      <td>92</td>
      <td>67</td>
      <td>92</td>
      <td>460</td>
      <td>506</td>
      <td>21.417354</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>5621</td>
      <td>303</td>
      <td>0</td>
      <td>1</td>
      <td>486266</td>
      <td>6239102</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>129641.806700</td>
      <td>32159.673020</td>
      <td>53546.801660</td>
      <td>215348.28140</td>
      <td>215.348281</td>
      <td>5308</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62375_4850_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6237500</td>
      <td>485000</td>
      <td>19A016_62375_4850_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4139</td>
      <td>898</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4850_20195621303</td>
      <td>828</td>
      <td>386</td>
      <td>309</td>
      <td>73</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.93</td>
      <td>27.760000</td>
      <td>19.996762</td>
      <td>24.480000</td>
      <td>5.801991</td>
      <td>33.663104</td>
      <td>0.290147</td>
      <td>6.467499</td>
      <td>-1.381331</td>
      <td>4.499651</td>
      <td>4.380333</td>
      <td>3.139999</td>
      <td>3.090000</td>
      <td>19.996762</td>
      <td>3.036699</td>
      <td>-0.877424</td>
      <td>0.486469</td>
      <td>0.151860</td>
      <td>-0.288940</td>
      <td>0.160197</td>
      <td>2.0740</td>
      <td>6.145000</td>
      <td>11.005000</td>
      <td>16.719999</td>
      <td>17.8225</td>
      <td>18.510</td>
      <td>20.270</td>
      <td>21.430000</td>
      <td>22.690001</td>
      <td>23.889999</td>
      <td>24.289999</td>
      <td>24.680000</td>
      <td>25.360001</td>
      <td>26.160000</td>
      <td>26.907499</td>
      <td>0.699449</td>
      <td>20.819375</td>
      <td>21.356894</td>
      <td>110</td>
      <td>1671</td>
      <td>310.647668</td>
      <td>184.333333</td>
      <td>213.085850</td>
      <td>4.540558e+04</td>
      <td>0.685941</td>
      <td>106.75</td>
      <td>2.970778</td>
      <td>12.852277</td>
      <td>128.962522</td>
      <td>310.647668</td>
      <td>88.865245</td>
      <td>43.558159</td>
      <td>31.810547</td>
      <td>0.286064</td>
      <td>0.490160</td>
      <td>0.357964</td>
      <td>142.649994</td>
      <td>152.000000</td>
      <td>169.000000</td>
      <td>189.000000</td>
      <td>199.25</td>
      <td>207.000000</td>
      <td>225.000000</td>
      <td>252.0</td>
      <td>271.000000</td>
      <td>292.000000</td>
      <td>306.00</td>
      <td>333.000000</td>
      <td>519.500000</td>
      <td>793.000000</td>
      <td>1155.549927</td>
      <td>66.594828</td>
      <td>46.618357</td>
      <td>83.189655</td>
      <td>309</td>
      <td>386</td>
      <td>47.629310</td>
      <td>19.396552</td>
      <td>28.502415</td>
      <td>10.869565</td>
      <td>50.862069</td>
      <td>19.396552</td>
      <td>221</td>
      <td>90</td>
      <td>236</td>
      <td>90</td>
      <td>464</td>
      <td>828</td>
      <td>34.031342</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2015</td>
      <td>5625</td>
      <td>103</td>
      <td>0</td>
      <td>1</td>
      <td>491538</td>
      <td>6239446</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>58841.982320</td>
      <td>30217.391890</td>
      <td>29542.145070</td>
      <td>118601.51930</td>
      <td>118.601519</td>
      <td>5311</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62375_4900_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6237500</td>
      <td>490000</td>
      <td>19A016_62375_4900_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4143</td>
      <td>554</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4900_20155625103</td>
      <td>706</td>
      <td>443</td>
      <td>373</td>
      <td>70</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3.53</td>
      <td>19.280001</td>
      <td>13.715643</td>
      <td>14.280000</td>
      <td>2.795992</td>
      <td>7.817574</td>
      <td>0.203854</td>
      <td>3.620000</td>
      <td>-0.610402</td>
      <td>3.367664</td>
      <td>2.198131</td>
      <td>1.760000</td>
      <td>1.699999</td>
      <td>13.715643</td>
      <td>1.559358</td>
      <td>-0.167807</td>
      <td>0.212303</td>
      <td>0.113692</td>
      <td>-0.107613</td>
      <td>0.136148</td>
      <td>6.2176</td>
      <td>8.707001</td>
      <td>9.952000</td>
      <td>11.704000</td>
      <td>12.0500</td>
      <td>12.480</td>
      <td>13.400</td>
      <td>14.120000</td>
      <td>14.612000</td>
      <td>15.318000</td>
      <td>15.670000</td>
      <td>15.946000</td>
      <td>17.271999</td>
      <td>17.966999</td>
      <td>18.803799</td>
      <td>0.646707</td>
      <td>13.997100</td>
      <td>14.240406</td>
      <td>144</td>
      <td>13142</td>
      <td>837.264108</td>
      <td>144.000000</td>
      <td>998.447381</td>
      <td>9.968972e+05</td>
      <td>1.192512</td>
      <td>630.00</td>
      <td>9.180494</td>
      <td>103.197172</td>
      <td>428.453801</td>
      <td>837.264108</td>
      <td>305.751836</td>
      <td>99.859214</td>
      <td>79.849615</td>
      <td>0.365180</td>
      <td>0.326602</td>
      <td>0.261158</td>
      <td>161.000000</td>
      <td>216.399994</td>
      <td>270.000000</td>
      <td>364.000000</td>
      <td>415.00</td>
      <td>476.200012</td>
      <td>585.000000</td>
      <td>712.0</td>
      <td>829.000000</td>
      <td>967.000000</td>
      <td>1045.00</td>
      <td>1141.200073</td>
      <td>1374.000000</td>
      <td>1586.000000</td>
      <td>1853.038086</td>
      <td>82.705100</td>
      <td>62.747875</td>
      <td>98.226164</td>
      <td>373</td>
      <td>443</td>
      <td>52.106430</td>
      <td>44.345898</td>
      <td>34.985836</td>
      <td>29.036827</td>
      <td>54.767184</td>
      <td>45.454545</td>
      <td>235</td>
      <td>200</td>
      <td>247</td>
      <td>205</td>
      <td>451</td>
      <td>706</td>
      <td>45.625354</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2015</td>
      <td>5625</td>
      <td>203</td>
      <td>0</td>
      <td>1</td>
      <td>491548</td>
      <td>6239171</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>5311</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62375_4900_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6237500</td>
      <td>490000</td>
      <td>19A016_62375_4900_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4143</td>
      <td>829</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4900_20155625203</td>
      <td>429</td>
      <td>34</td>
      <td>34</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.51</td>
      <td>2.780000</td>
      <td>1.967353</td>
      <td>1.510000</td>
      <td>0.387121</td>
      <td>0.149862</td>
      <td>0.196772</td>
      <td>0.470000</td>
      <td>0.733778</td>
      <td>2.283787</td>
      <td>0.314844</td>
      <td>0.235000</td>
      <td>0.350000</td>
      <td>1.967353</td>
      <td>0.217282</td>
      <td>0.048339</td>
      <td>0.009820</td>
      <td>0.110444</td>
      <td>0.222471</td>
      <td>0.045193</td>
      <td>1.5166</td>
      <td>1.530000</td>
      <td>1.580000</td>
      <td>1.612000</td>
      <td>1.6425</td>
      <td>1.686</td>
      <td>1.784</td>
      <td>1.860000</td>
      <td>1.988000</td>
      <td>2.045000</td>
      <td>2.112500</td>
      <td>2.386000</td>
      <td>2.562000</td>
      <td>2.720000</td>
      <td>2.760200</td>
      <td>0.360120</td>
      <td>2.003979</td>
      <td>2.041979</td>
      <td>305</td>
      <td>11658</td>
      <td>3961.352941</td>
      <td>1566.444444</td>
      <td>4656.536624</td>
      <td>2.168333e+07</td>
      <td>1.175491</td>
      <td>8273.00</td>
      <td>1.010275</td>
      <td>2.052198</td>
      <td>4023.224913</td>
      <td>3961.352941</td>
      <td>2257.445633</td>
      <td>870.321190</td>
      <td>56.202227</td>
      <td>0.569867</td>
      <td>0.385534</td>
      <td>0.024896</td>
      <td>314.239990</td>
      <td>338.850006</td>
      <td>468.899994</td>
      <td>631.000000</td>
      <td>827.50</td>
      <td>1097.199951</td>
      <td>1617.000000</td>
      <td>1692.5</td>
      <td>1788.199951</td>
      <td>1884.900024</td>
      <td>9100.50</td>
      <td>11488.000000</td>
      <td>11572.000000</td>
      <td>11602.099610</td>
      <td>11658.000000</td>
      <td>8.114558</td>
      <td>7.925408</td>
      <td>8.114558</td>
      <td>34</td>
      <td>34</td>
      <td>3.818616</td>
      <td>7.875895</td>
      <td>3.729604</td>
      <td>7.692308</td>
      <td>3.818616</td>
      <td>7.875895</td>
      <td>16</td>
      <td>33</td>
      <td>16</td>
      <td>33</td>
      <td>419</td>
      <td>429</td>
      <td>13.492481</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2015</td>
      <td>5625</td>
      <td>403</td>
      <td>0</td>
      <td>1</td>
      <td>491254</td>
      <td>6239421</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>133254.384000</td>
      <td>54100.341430</td>
      <td>73852.081750</td>
      <td>261206.80720</td>
      <td>261.206807</td>
      <td>5311</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62375_4900_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6237500</td>
      <td>490000</td>
      <td>19A016_62375_4900_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4143</td>
      <td>579</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4900_20155625403</td>
      <td>847</td>
      <td>447</td>
      <td>336</td>
      <td>102</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.51</td>
      <td>21.379999</td>
      <td>13.186174</td>
      <td>14.125872</td>
      <td>5.084911</td>
      <td>25.856324</td>
      <td>0.385624</td>
      <td>7.275000</td>
      <td>-0.634886</td>
      <td>2.460292</td>
      <td>4.178857</td>
      <td>3.410000</td>
      <td>3.515873</td>
      <td>13.186174</td>
      <td>2.859451</td>
      <td>-0.462348</td>
      <td>0.208555</td>
      <td>0.216852</td>
      <td>-0.161691</td>
      <td>0.072935</td>
      <td>1.7846</td>
      <td>2.824000</td>
      <td>5.029999</td>
      <td>8.429999</td>
      <td>9.9550</td>
      <td>10.798</td>
      <td>12.980</td>
      <td>14.340000</td>
      <td>15.246000</td>
      <td>16.698000</td>
      <td>17.230000</td>
      <td>17.730000</td>
      <td>19.062000</td>
      <td>19.748001</td>
      <td>20.718601</td>
      <td>0.587628</td>
      <td>14.130594</td>
      <td>14.782048</td>
      <td>127</td>
      <td>11101</td>
      <td>318.008949</td>
      <td>127.000000</td>
      <td>548.385200</td>
      <td>3.007263e+05</td>
      <td>1.724433</td>
      <td>102.00</td>
      <td>17.216338</td>
      <td>335.506088</td>
      <td>144.242442</td>
      <td>318.008949</td>
      <td>99.234267</td>
      <td>60.864349</td>
      <td>52.439225</td>
      <td>0.312049</td>
      <td>0.613340</td>
      <td>0.528439</td>
      <td>144.000000</td>
      <td>161.000000</td>
      <td>178.000000</td>
      <td>195.000000</td>
      <td>203.00</td>
      <td>211.000015</td>
      <td>225.000000</td>
      <td>243.0</td>
      <td>263.000000</td>
      <td>288.000000</td>
      <td>305.00</td>
      <td>322.000000</td>
      <td>424.000000</td>
      <td>596.900208</td>
      <td>1386.540894</td>
      <td>76.190476</td>
      <td>52.774498</td>
      <td>101.360544</td>
      <td>336</td>
      <td>447</td>
      <td>49.886621</td>
      <td>45.351474</td>
      <td>30.696576</td>
      <td>27.744982</td>
      <td>58.956916</td>
      <td>53.287982</td>
      <td>220</td>
      <td>200</td>
      <td>260</td>
      <td>235</td>
      <td>441</td>
      <td>847</td>
      <td>33.417988</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2016</td>
      <td>5625</td>
      <td>103</td>
      <td>0</td>
      <td>1</td>
      <td>496555</td>
      <td>6239468</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>67022.530310</td>
      <td>16757.065520</td>
      <td>27012.147500</td>
      <td>110791.74330</td>
      <td>110.791743</td>
      <td>5315</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62375_4950_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6237500</td>
      <td>495000</td>
      <td>19A016_62375_4950_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4147</td>
      <td>532</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4950_20165625103</td>
      <td>760</td>
      <td>363</td>
      <td>307</td>
      <td>53</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.56</td>
      <td>18.690001</td>
      <td>13.465702</td>
      <td>15.427143</td>
      <td>3.669243</td>
      <td>13.463346</td>
      <td>0.272488</td>
      <td>4.679999</td>
      <td>-1.150223</td>
      <td>4.115820</td>
      <td>2.874086</td>
      <td>2.160001</td>
      <td>2.112858</td>
      <td>13.465702</td>
      <td>1.978568</td>
      <td>-0.449101</td>
      <td>0.256733</td>
      <td>0.146934</td>
      <td>-0.226983</td>
      <td>0.129757</td>
      <td>1.9854</td>
      <td>5.620000</td>
      <td>8.698000</td>
      <td>10.770000</td>
      <td>11.5500</td>
      <td>12.328</td>
      <td>13.068</td>
      <td>14.370000</td>
      <td>15.170000</td>
      <td>15.870000</td>
      <td>16.230000</td>
      <td>16.573999</td>
      <td>17.230000</td>
      <td>17.859001</td>
      <td>18.345200</td>
      <td>0.695021</td>
      <td>13.955336</td>
      <td>14.305179</td>
      <td>152</td>
      <td>11238</td>
      <td>621.096419</td>
      <td>152.000000</td>
      <td>631.573195</td>
      <td>3.988847e+05</td>
      <td>1.016868</td>
      <td>433.00</td>
      <td>13.161927</td>
      <td>220.723870</td>
      <td>275.177045</td>
      <td>621.096419</td>
      <td>193.865973</td>
      <td>51.591859</td>
      <td>38.322707</td>
      <td>0.312135</td>
      <td>0.266121</td>
      <td>0.197676</td>
      <td>170.240005</td>
      <td>216.399994</td>
      <td>238.200012</td>
      <td>297.000000</td>
      <td>351.00</td>
      <td>387.000000</td>
      <td>458.799988</td>
      <td>560.0</td>
      <td>649.000000</td>
      <td>739.000000</td>
      <td>784.00</td>
      <td>844.200073</td>
      <td>1001.000000</td>
      <td>1144.000000</td>
      <td>1447.020386</td>
      <td>62.020202</td>
      <td>47.763158</td>
      <td>73.333333</td>
      <td>307</td>
      <td>363</td>
      <td>40.808081</td>
      <td>28.080808</td>
      <td>26.842105</td>
      <td>18.289474</td>
      <td>41.212121</td>
      <td>28.080808</td>
      <td>202</td>
      <td>139</td>
      <td>204</td>
      <td>139</td>
      <td>495</td>
      <td>760</td>
      <td>34.615203</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2016</td>
      <td>5625</td>
      <td>203</td>
      <td>0</td>
      <td>1</td>
      <td>496548</td>
      <td>6239185</td>
      <td>10</td>
      <td>Blek</td>
      <td>1</td>
      <td>1</td>
      <td>65817.664140</td>
      <td>25885.144090</td>
      <td>29740.796440</td>
      <td>121443.60470</td>
      <td>121.443605</td>
      <td>5315</td>
      <td>20190406</td>
      <td></td>
      <td>3000</td>
      <td>160</td>
      <td>11</td>
      <td>1.23</td>
      <td>8238</td>
      <td>Leica</td>
      <td>ALS80-HP</td>
      <td>35</td>
      <td>278000</td>
      <td>42</td>
      <td>100</td>
      <td>62375_4950_25</td>
      <td>19A016</td>
      <td>43561</td>
      <td>6237500</td>
      <td>495000</td>
      <td>19A016_62375_4950_25.laz.laz</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>4147</td>
      <td>815</td>
      <td>D:\Projekt\ForestChangeHMB\LASdata\Skanning2_p...</td>
      <td>19A016_62375_4950_20165625203</td>
      <td>811</td>
      <td>419</td>
      <td>324</td>
      <td>88</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.90</td>
      <td>19.049999</td>
      <td>12.821241</td>
      <td>13.061111</td>
      <td>3.807565</td>
      <td>14.497555</td>
      <td>0.296973</td>
      <td>5.125000</td>
      <td>-0.701668</td>
      <td>2.988488</td>
      <td>3.014020</td>
      <td>2.590000</td>
      <td>2.618890</td>
      <td>12.821241</td>
      <td>2.127366</td>
      <td>-0.311288</td>
      <td>0.239160</td>
      <td>0.165925</td>
      <td>-0.146326</td>
      <td>0.112421</td>
      <td>2.7504</td>
      <td>4.852000</td>
      <td>7.394000</td>
      <td>9.742000</td>
      <td>10.6000</td>
      <td>11.474</td>
      <td>12.584</td>
      <td>13.250000</td>
      <td>14.190000</td>
      <td>15.102000</td>
      <td>15.725000</td>
      <td>16.326000</td>
      <td>17.346001</td>
      <td>18.070999</td>
      <td>18.723801</td>
      <td>0.636807</td>
      <td>13.373376</td>
      <td>13.795088</td>
      <td>152</td>
      <td>11238</td>
      <td>744.489260</td>
      <td>152.000000</td>
      <td>1199.026151</td>
      <td>1.437664e+06</td>
      <td>1.610535</td>
      <td>515.00</td>
      <td>7.884790</td>
      <td>68.718406</td>
      <td>438.186021</td>
      <td>744.489260</td>
      <td>312.123511</td>
      <td>154.177013</td>
      <td>122.548544</td>
      <td>0.419245</td>
      <td>0.493962</td>
      <td>0.392628</td>
      <td>181.080002</td>
      <td>216.000000</td>
      <td>245.399994</td>
      <td>301.799988</td>
      <td>333.00</td>
      <td>361.600006</td>
      <td>441.000000</td>
      <td>540.0</td>
      <td>661.000000</td>
      <td>787.000000</td>
      <td>848.00</td>
      <td>921.000000</td>
      <td>1188.800049</td>
      <td>1383.800049</td>
      <td>9459.528320</td>
      <td>62.307692</td>
      <td>51.664612</td>
      <td>80.576923</td>
      <td>324</td>
      <td>419</td>
      <td>41.538462</td>
      <td>39.230769</td>
      <td>29.099877</td>
      <td>27.620222</td>
      <td>45.384615</td>
      <td>43.076923</td>
      <td>216</td>
      <td>204</td>
      <td>236</td>
      <td>224</td>
      <td>520</td>
      <td>811</td>
      <td>35.084541</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[146]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">predictors</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[146]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
217
</pre></div></div>
</div>
<p>Plotting the target variable</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">predictors</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]),</span><span class="nb">max</span><span class="p">(</span><span class="n">predictors</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]),</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">predictors</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]),</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_9_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_9_0.png" />
</div>
</div>
<p>Clean the dataset by removing ‚Äò0‚Äô AGB values</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_sel</span> <span class="o">=</span> <span class="n">predictors</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">predictors</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<p>Plotting response variables distribution after cleaning</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">predictors_sel</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]),</span><span class="nb">max</span><span class="p">(</span><span class="n">predictors_sel</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]),</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">((</span><span class="n">predictors_sel</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]),</span><span class="n">bins</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_13_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_13_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[106]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#select the:</span>
<span class="c1">#target variable AGB</span>
<span class="c1">#predictor variables &lt;- latitude, longitude, height percentiles and intensities</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">AGB</span> <span class="o">=</span> <span class="n">predictors_sel</span><span class="p">[</span><span class="s1">&#39;TotalAGB&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">86</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">112</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">117</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">119</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">125</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">predictors_sel</span><span class="p">[</span><span class="n">predictors_sel</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">cols</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   Ostkoordin  Nordkoordi  Elev P01  Elev P05  Elev P10   Elev P20  Elev P25  \
0      494081     6237269    1.5600    2.0295     2.379   3.278000    3.7500
1      476547     6239273    1.6846    2.1900     3.252   4.762000    5.4800
2      476282     6238964    6.9882    9.6300    11.464  13.197999   13.8750
3      476268     6239247    1.5728    1.6960     1.790   1.998000    2.1900
4      486266     6239102    2.0740    6.1450    11.005  16.719999   17.8225

   Elev P30  Elev P40   Elev P50   Elev P60   Elev P70   Elev P75        p80  \
0     4.224     6.342   8.065001  10.006000  11.785000  12.265000  12.850000
1     6.000     7.080   8.740000  11.148000  15.642000  16.680000  17.459999
2    14.269    15.334  16.240000  17.120001  17.896999  18.299999  18.858000
3     2.310     2.524   2.810000   3.004000   3.220000   3.300000   3.412000
4    18.510    20.270  21.430000  22.690001  23.889999  24.289999  24.680000

    Elev P90   Elev P95   Elev P99       crr     Int P01     Int P05  \
0  14.574000  15.250000  16.839298  0.424836  147.119995  168.650009
1  18.514000  19.020000  19.832399  0.462006  126.000000  153.000000
2  20.077000  21.019001  22.095800  0.670032  150.000000  181.000000
3   3.900000   4.128000   4.260400  0.455759  259.320007  342.200012
4  25.360001  26.160000  26.907499  0.699449  142.649994  152.000000

      Int P10  Int P20  Int P25     Int P30     Int P40  Int P50     Int P60  \
0  185.400009    207.0   216.00  229.000000  261.000000    305.5  351.000000
1  171.000000    221.0   241.00  271.000000  321.000000    389.0  461.000000
2  211.599991    289.0   343.00  399.200012  527.799927    661.5  837.400024
3  404.799988    519.0   623.00  679.000000  758.599976    834.0  921.199890
4  169.000000    189.0   199.25  207.000000  225.000000    252.0  271.000000

       Int P70  Int P75      Int P80      Int P90      Int P95       Int P99
0   414.000000   450.00   495.000000   686.000061   958.000000   1302.879883
1   535.600098   588.00   658.599915   880.400146  1140.800171   1513.998901
2  1013.000000  1092.75  1235.000000  1456.000244  1666.950195  11150.000000
3  1048.200073  1196.00  1388.599854  1802.600220  2008.000000   2207.799805
4   292.000000   306.00   333.000000   519.500000   793.000000   1155.549927
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Explore the raw data - predictor variables</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_plots_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span><span class="o">+</span><span class="mi">1</span>
<span class="n">n_plots_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_plots_x</span><span class="p">,</span> <span class="n">n_plots_y</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_17_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_17_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[107]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Normalize the target variable &#39;AGB&#39; to range between 0 and 1 and to follow a normal distribution</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">QuantileTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">qt</span> <span class="o">=</span> <span class="n">QuantileTransformer</span><span class="p">(</span>
    <span class="n">n_quantiles</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">output_distribution</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">AGB</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">AGB</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">scaler_tree</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">AGB</span> <span class="o">=</span> <span class="n">scaler_tree</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">AGB</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">AGB</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/lib/python3/dist-packages/sklearn/preprocessing/_data.py:2354: UserWarning: n_quantiles (500) is greater than the total number of samples (207). n_quantiles is set to n_samples.
  warnings.warn(&#34;n_quantiles (%s) is greater than the total number &#34;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,
         1.,  1.,  3.,  3.,  5.,  7.,  9., 11., 13., 15., 17., 17., 16.,
        17., 15., 13., 11.,  9.,  7.,  5.,  3.,  3.,  1.,  1.,  1.,  0.,
         0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.]),
 array([0.  , 0.02, 0.04, 0.06, 0.08, 0.1 , 0.12, 0.14, 0.16, 0.18, 0.2 ,
        0.22, 0.24, 0.26, 0.28, 0.3 , 0.32, 0.34, 0.36, 0.38, 0.4 , 0.42,
        0.44, 0.46, 0.48, 0.5 , 0.52, 0.54, 0.56, 0.58, 0.6 , 0.62, 0.64,
        0.66, 0.68, 0.7 , 0.72, 0.74, 0.76, 0.78, 0.8 , 0.82, 0.84, 0.86,
        0.88, 0.9 , 0.92, 0.94, 0.96, 0.98, 1.  ]),
 &lt;a list of 50 Patch objects&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_19_2.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_19_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[108]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Normalize the predictor variables to range between 0 and 1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Normalize the data</span>
<span class="n">scaler_data</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">data_transformed</span> <span class="o">=</span> <span class="n">scaler_data</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">n_plots_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span><span class="o">+</span><span class="mi">1</span>
<span class="n">n_plots_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_plots_x</span><span class="p">,</span> <span class="n">n_plots_y</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_transformed</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_21_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_21_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Extract the column headers for later plotting the feature importance</span>
<span class="n">featx</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Random-Forest-Regression-(RFR)">
<h2><span class="section-number">2.10.3. </span>Random Forest Regression (RFR)<a class="headerlink" href="#Random-Forest-Regression-(RFR)" title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Data splitting into train and test subsets</span>
<span class="n">X_train_rf</span><span class="p">,</span> <span class="n">X_test_rf</span><span class="p">,</span> <span class="n">Y_train_rf</span><span class="p">,</span> <span class="n">Y_test_rf</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_transformed</span><span class="p">,</span><span class="n">AGB</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">y_train_rf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_train_rf</span><span class="p">)</span>
<span class="n">y_test_rf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_test_rf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define the RFR model</span>
<span class="n">rfReg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rfReg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_rf</span><span class="p">,</span> <span class="n">y_train_rf</span><span class="p">)</span>
<span class="n">dic_pred_RF</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_rf</span><span class="p">)</span>
<span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_rf</span><span class="p">)</span>
<span class="n">pearsonr_train_RF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">y_train_rf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">pearsonr_test_RF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">y_test_rf</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">pearsonr_all_RF</span> <span class="o">=</span> <span class="p">[</span><span class="n">pearsonr_train_RF</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">pearsonr_test_RF</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">pearsonr_all_RF</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.5850426153769053, 0.634618398346184]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># checking the oob score</span>
<span class="n">rfReg</span><span class="o">.</span><span class="n">oob_score_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.4477686796959137
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[481]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the model performance for the training set</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_train_rf</span><span class="p">,</span><span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;training AGB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;training predicted AGB&#39;</span><span class="p">)</span>
<span class="n">ident</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span><span class="n">ident</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[481]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f47ae1d04c0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_27_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_27_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[482]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the model performance for the test set</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test_rf</span><span class="p">,</span><span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;testing AGB&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;testing predicted AGB&#39;</span><span class="p">)</span>
<span class="n">ident</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span><span class="n">ident</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[482]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7f47ae409520&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_28_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_28_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Compute the feature importance for the predictor variables</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">impt</span> <span class="o">=</span> <span class="p">[</span><span class="n">rfReg</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">tree</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">estimators_</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">impt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ind</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([30, 29, 26, 23, 22, 25, 24, 21, 27, 17, 28, 32,  0,  8, 20,  5, 31,
        6,  7, 13,  2, 14, 10,  1, 11, 16, 19, 18,  9,  3,  4, 15, 12])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">featx</span><span class="p">)),</span><span class="n">impt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ind</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">impt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ind</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">featx</span><span class="p">)),</span><span class="n">featx</span><span class="p">[</span><span class="n">ind</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_32_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_32_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Absolute Error (MAE):&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_test_rf</span><span class="p">,</span> <span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error (MSE):&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test_rf</span><span class="p">,</span> <span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Root Mean Squared Error (RMSE):&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test_rf</span><span class="p">,</span> <span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R^2:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">Y_test_rf</span><span class="p">,</span> <span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean Absolute Error (MAE): 0.04844966911077575
Mean Squared Error (MSE): 0.003917523367916487
Root Mean Squared Error (RMSE): 0.06259012196757957
R^2: 0.5984579817055615
</pre></div></div>
</div>
<section id="Support-Vector-Machine-for-Regression-(SVR)">
<h3><span class="section-number">2.10.3.1. </span>Support Vector Machine for Regression (SVR)<a class="headerlink" href="#Support-Vector-Machine-for-Regression-(SVR)" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Dataset splitting into train and test data subsets</span>
<span class="n">X_train_svr</span><span class="p">,</span> <span class="n">X_test_svr</span><span class="p">,</span> <span class="n">y_train_svr</span><span class="p">,</span> <span class="n">y_test_svr</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_transformed</span><span class="p">,</span><span class="n">AGB</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_train.shape:</span><span class="si">{}</span><span class="s1">, X_test.shape:</span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train_svr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test_svr</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_train_svr</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_svr</span><span class="p">)</span>
<span class="n">X_test_svr</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_svr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
X_train.shape:(103, 33), X_test.shape:(104, 33)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define the SVR model</span>
<span class="n">svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_svr</span><span class="p">,</span> <span class="n">y_train_svr</span><span class="p">)</span> <span class="c1"># Fit the SVR model according to the given training data.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy of SVR on training set: </span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_svr</span><span class="p">,</span> <span class="n">y_train_svr</span><span class="p">)))</span> <span class="c1"># Returns the coefficient of determination (R^2) of the prediction.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy of SVR on test set: </span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_svr</span><span class="p">,</span> <span class="n">y_test_svr</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy of SVR on training set: 0.62139
Accuracy of SVR on test set: 0.56197
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[117]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Predict for the train and the test datasets</span>
<span class="n">dic_pred_svr</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dic_pred_svr</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_svr</span><span class="p">)</span>
<span class="n">dic_pred_svr</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_svr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[118]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Root Mean Squared Error (RMSE):&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">dic_pred_svr</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">y_test_svr</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R^2:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_svr</span><span class="p">,</span><span class="n">dic_pred_svr</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Root Mean Squared Error (RMSE): 0.07149401467860782
R^2: 0.5619712935228112
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[185]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#on increasing/ decreasing the test_size the svr.score was increasing but the train score was going down</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Feedfoward-neural-network-(FF-NN)">
<h2><span class="section-number">2.10.4. </span>Feedfoward neural network (FF-NN)<a class="headerlink" href="#Feedfoward-neural-network-(FF-NN)" title="Permalink to this headline">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set a random seed</span>
<span class="n">seed</span><span class="o">=</span><span class="mi">29</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">manual_seed_all</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Split the dataset into train and test subsets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_transformed</span><span class="p">,</span><span class="n">AGB</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_train.shape: </span><span class="si">{}</span><span class="s1">, X_test.shape: </span><span class="si">{}</span><span class="s1">, y_train.shape: </span><span class="si">{}</span><span class="s1">, y_test.shape: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_train.min: </span><span class="si">{}</span><span class="s1">, X_test.shape: </span><span class="si">{}</span><span class="s1">, y_train.shape: </span><span class="si">{}</span><span class="s1">, y_test.shape: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X_test</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_test</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_train.max: </span><span class="si">{}</span><span class="s1">, X_test.shape: </span><span class="si">{}</span><span class="s1">, y_train.shape: </span><span class="si">{}</span><span class="s1">, y_test.shape: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">X_test</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y_train</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y_test</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
X_train.shape: torch.Size([62, 33]), X_test.shape: torch.Size([145, 33]), y_train.shape: torch.Size([62]), y_test.shape: torch.Size([145])
X_train.min: 0.0, X_test.shape: 0.0, y_train.shape: 0.0, y_test.shape: 0.25131121277809143
X_train.max: 1.0, X_test.shape: 1.0, y_train.shape: 0.7247803211212158, y_test.shape: 1.0
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define the FeedForward Neural Network</span>
<span class="k">class</span> <span class="nc">Feedforward</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Feedforward</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">=</span> <span class="n">input_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span>  <span class="o">=</span> <span class="n">hidden_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">)</span>
        <span class="c1"># self.fc3 = torch.nn.Linear(self.hidden_size, self.hidden_size)</span>
        <span class="c1"># self.fc4 = torch.nn.Linear(self.hidden_size, self.hidden_size)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
        <span class="c1">#self.tanh = torch.nn.Tanh()</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">hidden</span><span class="p">))</span>
        <span class="c1"># hidden = self.relu(self.fc3(hidden))</span>
        <span class="c1"># hidden = self.relu(self.fc4(hidden))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">hidden</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># FF-NN model.train()</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">hid_dim_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">512</span><span class="p">]</span><span class="c1">#,256</span>
<span class="n">lr_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span><span class="c1">#,0.5,1]</span>

<span class="c1">#Let&#39;s create a place to save these models, so we can</span>
<span class="n">path_to_save_models</span> <span class="o">=</span> <span class="s1">&#39;./models&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_to_save_models</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path_to_save_models</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hid_dim</span> <span class="ow">in</span> <span class="n">hid_dim_range</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">lr</span> <span class="ow">in</span> <span class="n">lr_range</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">hid_dim: </span><span class="si">{}</span><span class="s1">, lr: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hid_dim</span><span class="p">,</span> <span class="n">lr</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;model&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deleting previous model&#39;</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">model</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">optimizer</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Feedforward</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="n">hid_dim</span><span class="p">)</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="p">)</span>

        <span class="n">all_loss_train</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">all_loss_val</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="c1"># Forward pass</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
            <span class="c1"># Compute Loss</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_train</span><span class="p">)</span>

            <span class="c1"># Backward pass</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">all_loss_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

            <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
                <span class="c1"># Compute Loss</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_test</span><span class="p">)</span>
                <span class="n">all_loss_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

                <span class="k">if</span> <span class="n">epoch</span><span class="o">%</span><span class="k">100</span>==0:
                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1">, train_loss: </span><span class="si">{:.4f}</span><span class="s1">, val_loss: </span><span class="si">{:.4f}</span><span class="s1">, r_value: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span><span class="n">all_loss_train</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">all_loss_val</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">r_value</span><span class="p">))</span>

        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">all_loss_train</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">all_loss_val</span><span class="p">))</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;slope: </span><span class="si">{:.4f}</span><span class="s1">, r_value: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">r_value</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">name_to_save</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_save_models</span><span class="p">,</span><span class="s1">&#39;model_SGD_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_lr&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_hid_dim&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">hid_dim</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving model to &#39;</span><span class="p">,</span> <span class="n">name_to_save</span><span class="p">)</span>
        <span class="n">model_state</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;state_dict&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
                    <span class="s1">&#39;optimizer&#39;</span> <span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="p">}</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_state</span><span class="p">,</span> <span class="n">name_to_save</span> <span class="o">+</span><span class="s1">&#39;.pt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

hid_dim: 512, lr: 0.01
Epoch 0, train_loss: 0.0135, val_loss: 0.0112, r_value: -0.5676
Epoch 100, train_loss: 0.0128, val_loss: 0.0106, r_value: 0.1132
Epoch 200, train_loss: 0.0121, val_loss: 0.0101, r_value: 0.5879
Epoch 300, train_loss: 0.0116, val_loss: 0.0096, r_value: 0.6581
Epoch 400, train_loss: 0.0111, val_loss: 0.0091, r_value: 0.6764
Epoch 500, train_loss: 0.0107, val_loss: 0.0087, r_value: 0.6844
Epoch 600, train_loss: 0.0103, val_loss: 0.0084, r_value: 0.6887
Epoch 700, train_loss: 0.0100, val_loss: 0.0080, r_value: 0.6915
Epoch 800, train_loss: 0.0097, val_loss: 0.0077, r_value: 0.6936
Epoch 900, train_loss: 0.0094, val_loss: 0.0075, r_value: 0.6956
Epoch 1000, train_loss: 0.0091, val_loss: 0.0072, r_value: 0.6972
Epoch 1100, train_loss: 0.0089, val_loss: 0.0070, r_value: 0.6988
Epoch 1200, train_loss: 0.0087, val_loss: 0.0068, r_value: 0.7003
Epoch 1300, train_loss: 0.0085, val_loss: 0.0066, r_value: 0.7017
Epoch 1400, train_loss: 0.0084, val_loss: 0.0065, r_value: 0.7031
Epoch 1500, train_loss: 0.0082, val_loss: 0.0063, r_value: 0.7045
Epoch 1600, train_loss: 0.0081, val_loss: 0.0062, r_value: 0.7058
Epoch 1700, train_loss: 0.0080, val_loss: 0.0061, r_value: 0.7071
Epoch 1800, train_loss: 0.0079, val_loss: 0.0060, r_value: 0.7084
Epoch 1900, train_loss: 0.0078, val_loss: 0.0059, r_value: 0.7096
Epoch 2000, train_loss: 0.0077, val_loss: 0.0058, r_value: 0.7109
Epoch 2100, train_loss: 0.0076, val_loss: 0.0057, r_value: 0.7121
Epoch 2200, train_loss: 0.0075, val_loss: 0.0057, r_value: 0.7135
Epoch 2300, train_loss: 0.0074, val_loss: 0.0056, r_value: 0.7148
Epoch 2400, train_loss: 0.0074, val_loss: 0.0055, r_value: 0.7162
Epoch 2500, train_loss: 0.0073, val_loss: 0.0055, r_value: 0.7175
Epoch 2600, train_loss: 0.0073, val_loss: 0.0054, r_value: 0.7189
Epoch 2700, train_loss: 0.0072, val_loss: 0.0054, r_value: 0.7203
Epoch 2800, train_loss: 0.0071, val_loss: 0.0053, r_value: 0.7217
Epoch 2900, train_loss: 0.0071, val_loss: 0.0053, r_value: 0.7231
Epoch 3000, train_loss: 0.0070, val_loss: 0.0052, r_value: 0.7244
Epoch 3100, train_loss: 0.0070, val_loss: 0.0052, r_value: 0.7257
Epoch 3200, train_loss: 0.0069, val_loss: 0.0052, r_value: 0.7270
Epoch 3300, train_loss: 0.0069, val_loss: 0.0051, r_value: 0.7282
Epoch 3400, train_loss: 0.0069, val_loss: 0.0051, r_value: 0.7294
Epoch 3500, train_loss: 0.0068, val_loss: 0.0051, r_value: 0.7306
Epoch 3600, train_loss: 0.0068, val_loss: 0.0051, r_value: 0.7318
Epoch 3700, train_loss: 0.0067, val_loss: 0.0050, r_value: 0.7329
Epoch 3800, train_loss: 0.0067, val_loss: 0.0050, r_value: 0.7341
Epoch 3900, train_loss: 0.0067, val_loss: 0.0050, r_value: 0.7352
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_44_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_44_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_4000_lr0.01_hid_dim512
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define the function to compute model statistics</span>
<span class="k">def</span> <span class="nf">make_preds</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">):</span>
    <span class="n">trainPredict</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">testPredict</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">trainScore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">trainPredict</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train Score: </span><span class="si">%.2f</span><span class="s1"> RMSE&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">trainScore</span><span class="p">))</span>
    <span class="c1">#print(&#39;Train R^2: &#39;, r2_score(y_train, trainPredict))</span>
    <span class="n">testScore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">testPredict</span><span class="p">))</span>
    <span class="c1">#print(&#39;Train R^2: &#39;, r2_score(y_test, testPredict))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TMetrics RMSE: </span><span class="si">%.2f</span><span class="s1"> RMSE&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">testScore</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">trainPredict</span><span class="p">,</span> <span class="n">testPredict</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Model statistics</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">make_preds</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train Score: 0.08 RMSE
TMetrics RMSE: 0.07 RMSE
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># To compute the feature importance for the predictor variables</span>
<span class="kn">import</span> <span class="nn">shap</span>

<span class="n">test_set</span><span class="o">=</span> <span class="n">X_test</span>
<span class="n">test_labels</span><span class="o">=</span> <span class="n">y_test</span>

<span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">DeepExplainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
<span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#SHAP global interpretation</span>
<span class="c1"># The summary plot shows the most important features and the magnitude of their impact on the model. It is the global interpretation.</span>

<span class="nb">print</span><span class="p">(</span><span class="n">shap_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">plot_type</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">feature_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">max_display</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(145, 33)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_48_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_48_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[119]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Tabular rerpesentation of the model statistics summary of the above 3 models used (RFR, SVR, FF-NN)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">([[</span><span class="s1">&#39;RFR&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_rf</span><span class="p">,</span> <span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span>
<span class="nb">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_rf</span><span class="p">,</span> <span class="n">dic_pred_RF</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;SVR&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_svr</span><span class="p">,</span> <span class="n">dic_pred_svr</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span>
<span class="nb">round</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_svr</span><span class="p">,</span><span class="n">dic_pred_svr</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;FeedF NN&#39;</span><span class="p">,</span> <span class="s1">&#39;0.07&#39;</span><span class="p">,</span> <span class="mf">0.59</span><span class="p">]],</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Algorithm&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;R^2&#39;</span><span class="p">]))</span> <span class="c1">#[&#39;GLM&#39;, 63.49, 0.45]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Algorithm      RMSE    R^2
-----------  ------  -----
RFR            0.06   0.6
SVR            0.07   0.56
FeedF NN       0.07   0.59
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[120]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># RFR and FF-NN was performing very similar with R^2 and RMSE values either similar/higher/lower compared to eachother.</span>
<span class="c1">#Therefore, the data represented in the above table is for one random instance.</span>
</pre></div>
</div>
</div>
<section id="Predict-the-raster-using-RFR">
<h3><span class="section-number">2.10.4.1. </span>Predict the raster using RFR<a class="headerlink" href="#Predict-the-raster-using-RFR" title="Permalink to this headline">ÔÉÅ</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Define RFR with the 2 predictor variables corresponding to the available rasters</span>
<span class="n">X_rf2</span> <span class="o">=</span> <span class="n">predictors_sel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">86</span><span class="p">,</span><span class="mi">90</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">Y_rf2</span> <span class="o">=</span> <span class="n">predictors_sel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">15</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_train_rf2</span><span class="p">,</span> <span class="n">X_test_rf2</span><span class="p">,</span> <span class="n">Y_train_rf2</span><span class="p">,</span> <span class="n">Y_test_rf2</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_rf2</span><span class="p">,</span> <span class="n">Y_rf2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">y_train_rf2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_train_rf2</span><span class="p">)</span>
<span class="n">y_test_rf2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_test_rf2</span><span class="p">)</span>
<span class="n">rfReg_rf2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rfReg_rf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_rf2</span><span class="p">,</span> <span class="n">y_train_rf2</span><span class="p">);</span>
<span class="n">dic_pred_rf2</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dic_pred_rf2</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg_rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_rf2</span><span class="p">)</span>
<span class="n">dic_pred_rf2</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg_rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_rf2</span><span class="p">)</span>
<span class="c1">#print(&#39;Mean Absolute Error (MAE):&#39;, metrics.mean_absolute_error(y_test_rf2, dic_pred_rf2[&#39;test&#39;]))</span>
<span class="c1">#print(&#39;Mean Squared Error (MSE):&#39;, metrics.mean_squared_error(y_test_rf2, dic_pred_rf2[&#39;test&#39;]))</span>
<span class="c1">#print(&#39;Root Mean Squared Error (RMSE):&#39;, metrics.mean_squared_error(y_test_rf2, dic_pred_rf2[&#39;test&#39;], squared=False))</span>
<span class="c1">#print(&#39;R^2:&#39;, metrics.r2_score(y_test_rf2, dic_pred_rf2[&#39;test&#39;]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean Absolute Error (MAE): 41.108253168570315
Mean Squared Error (MSE): 2699.6832371086425
Root Mean Squared Error (RMSE): 51.95847608531877
R^2: 0.6374537638503947
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Bash commands to crop the rasters for extracting a sub-area from the study region</span>
<span class="c1">#%%bash</span>
<span class="c1">#gdalwarp -cutline sub-area.shp -crop_to_cutline -dstalpha P80_t2.tif p80_t2_crop.tif</span>
<span class="c1">#gdalwarp -cutline sub-area.shp -crop_to_cutline -dstalpha CanopyReliefRatio_t2.tif crr_t2_crop.tif</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Import rasters</span>
<span class="n">p80</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;../images/p80_t2_crop.tif&quot;</span><span class="p">)</span>
<span class="n">crr</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;../images/crr_t2_crop.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Stack the 2 raster layers correspong to the predictor variables</span>
<span class="c1">#predictors_rasters = [p80,crr]</span>
<span class="n">stack</span> <span class="o">=</span> <span class="n">Raster</span><span class="p">(</span><span class="n">p80</span><span class="p">,</span><span class="n">crr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Check the dimension of the raster stack to be given as input to the RFR</span>
<span class="n">stack</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Predict the raster for the target variable &#39;AGB&#39;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">rfReg_rf2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int16&#39;</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pyspatialml.raster.Raster object at 0x7f7588ea6820&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plot the resultin g map</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;plasma&quot;</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_58_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay_58_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Modeling_debris_flow_source_areas_Txomin_Bornaetxea.html" class="btn btn-neutral float-left" title="2.9. Txomin Bornaetxea: Modeling debris flow source areas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Clustering_Electric_Vehicle_Charging_Pattern_with_DTW_and_EV_Charging_energy_demand_Prediction_with_LSTM_Hyeyoung_Sim.html" class="btn btn-neutral float-right" title="2.11. Hyeyoung Sim: Clustering Electric Vehicle Charging Pattern with DTW and EV Charging energy demand Prediction with LSTM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Giuseppe Amatulli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>