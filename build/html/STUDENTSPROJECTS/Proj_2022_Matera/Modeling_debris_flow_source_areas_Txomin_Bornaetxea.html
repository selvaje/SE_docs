<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.6. Txomin Bornaetxea: Modeling debris flow source areas &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2.7. Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network" href="Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay.html" />
    <link rel="prev" title="2.5. Yusdiel Torres-Cambas: Distribution of freshwater biodiversity across Cuba" href="Distributionof_Fresh_water_Biodiversity_AcrossCuba_Yusdiel_Torres.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Spatial Ecology's code documentation
            <img src="../../_static/SE_compact.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2022.html">GeoComp &amp; ML 2022 course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_Colab_for_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_OSGeoLive_for_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_OSGeoLive_curso_para_Ecologia_Espacial.html">Prepare OSGeoLive para el curso de ecología espacial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AWK/awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GDAL/gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GDAL/gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_introduction.html">Introdction to pyjeo: installation and raster visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_pktools.html">Performing raster and vector operations in Python using pyjeo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../R/R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Geo_Python.html">Python &amp; GeoComputation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_intro.html">GRASS Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_hydro.html">Using GRASS for stream-network extraction and basins delineation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CASE STUDY</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/temporal_interpolation.html">Temporal interpolation of landsat images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/DTW.html">Dynamic Time Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/pred_NP.html">Estimating nitrogen and phosphorus concentrations in streams and rivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day1.html">Estimating nitrogen concentrations in streams and rivers using NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day2.html">Autoencoder (AE), Variational Autoencoder (VAE) and Generative Adversarial Network (GAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day3.html">LSTM Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_01DataExplore.html">Estimation of tree height using GEDI dataset - Data explore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_02SVM_pred.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_03RF_pred.html">Estimation of tree height using GEDI dataset - Random Forest prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04Perceptron_pred.html">Estimation of tree height using GEDI dataset - Perceptron 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04Perceptron_pred_clean.html">Estimation of tree height using GEDI dataset - Clean Data - Perceptron 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_05NeuralNets_pred.html">Estimation of tree height using GEDI dataset - Neural Network 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NNs_pt3_SHAP.html">Neural Nets (pt.3), Interpretability and Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/CNN_satelite.html">Using Multi-layer Perceptron and Convolutional Neural Networks for Satellite image classification.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html">The real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#LSTM-for-Regression-Using-the-Window-Method">LSTM for Regression Using the Window Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#LSTM-for-Regression-with-Time-Steps">LSTM for Regression with Time Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#LSTM-with-Memory-Between-Batches">LSTM with Memory Between Batches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#Stacked-LSTMs-with-Memory-Between-Batches">Stacked LSTMs with Memory Between Batches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#Adding-Early-Stopping">Adding Early Stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html#Multivariate-Time-series---Data">Multivariate Time-series - Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Students Projects</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">1. 2021 SWEDEN</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#matera">2. 2022 MATERA</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Damaged_trees_classification_RF_Janusz_Godziek.html">2.1. Janusz Godziek: Damaged vs undamaged trees - Random Forest classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="Stream_Network_Abstraction_Alonso_Gonzalez.html">2.2. Alonso Gonzalez: Stream Network Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Images_shadow_removal_Sebastian_Walter.html">2.3. Sebastian Walter: Images shadow removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="Using_a_LSTM_network_and_SHAP_to_determine_the_impact_of_drought_Florian_Ells%C3%A4%C3%9Fer.html">2.4. Florian Ellsäßer: Using a LSTM network and SHAP to determine the impact of drought and season on winter wheat</a></li>
<li class="toctree-l2"><a class="reference internal" href="Distributionof_Fresh_water_Biodiversity_AcrossCuba_Yusdiel_Torres.html">2.5. Yusdiel Torres-Cambas: Distribution of freshwater biodiversity across Cuba</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.6. Txomin Bornaetxea: Modeling debris flow source areas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.0-Objectives-of-the-project">2.6.1. <strong>1.0 Objectives of the project</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.0-Data-Pre-Processing">2.6.2. <strong>2.0 Data Pre-Processing</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#2.1--DEM-EXPLORATION-AND-COMPOSITION">2.6.2.1. 2.1- DEM EXPLORATION AND COMPOSITION</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.2--LANDSLIDE-INVENTORY-EXPLORATION-AND-EXTRACTION-OF-SOURCE-ZONES">2.6.2.2. 2.2- LANDSLIDE INVENTORY EXPLORATION AND EXTRACTION OF SOURCE ZONES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.3--GENERARION-OF-THE-SPATIAL-VARIABLES">2.6.2.3. 2.3- GENERARION OF THE SPATIAL VARIABLES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2.4--EXTRACT-THE-DATA-TABLE-FROM-RASTER-LAYERS">2.6.2.4. 2.4- EXTRACT THE DATA TABLE FROM RASTER LAYERS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#3.0-Data-Exploration">2.6.3. <strong>3.0 Data Exploration</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.0-Machine-Learning">2.6.4. <strong>4.0 Machine Learning</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#4.1-Data-set-splitting">2.6.4.1. 4.1 Data set splitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#4.2-Random-Forest">2.6.4.2. 4.2 Random Forest</a></li>
<li class="toctree-l4"><a class="reference internal" href="#4.3-Support-Vector-Machine-for-Regression-(SVR)">2.6.4.3. 4.3 Support Vector Machine for Regression (SVR)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Multilayer-Perceptron-(MP)">2.6.5. Multilayer Perceptron (MP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ML-Perceptron-CONCLUSIONS">2.6.5.1. ML Perceptron CONCLUSIONS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#GENERAL-CONCLUSIONS">2.6.6. <strong>GENERAL CONCLUSIONS</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay.html">2.7. Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OUTDOOR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OUTDOOR/outdoor_orientering.html">Do not get lost in the wilderness</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TALKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TALKS/intelligent_modelling.html">Intelligent modelling in time and space: combine GeoComputation and Machine Learning for  environmental application.</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/video.html">Video tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/Compiling_OTB.html">Compiling OTB from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Spatial Ecology's code documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html"><span class="section-number">1. </span>2021 SWEDEN</a> &raquo;</li>
      <li><span class="section-number">2.6. </span>Txomin Bornaetxea: Modeling debris flow source areas</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/STUDENTSPROJECTS/Proj_2022_Matera/Modeling_debris_flow_source_areas_Txomin_Bornaetxea.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Txomin-Bornaetxea:-Modeling-debris-flow-source-areas">
<h1><span class="section-number">2.6. </span>Txomin Bornaetxea: Modeling debris flow source areas<a class="headerlink" href="#Txomin-Bornaetxea:-Modeling-debris-flow-source-areas" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://youtu.be/R_GluB9DEz0">Video recording</a></p>
<section id="1.0-Objectives-of-the-project">
<h2><span class="section-number">2.6.1. </span><strong>1.0 Objectives of the project</strong><a class="headerlink" href="#1.0-Objectives-of-the-project" title="Permalink to this headline"></a></h2>
<p>Debris flows are a particular type of landslides that are able to transport a large amount of sediments down the slope. Commonly they present three different functional zones: <em>source</em>, <em>transportation</em> and <em>deposition</em>.</p>
<p>The objective of this project is to generate numerical models that predict the probability of a given pixel to be a debris flow souce zone. The study area for this case is placed in the Rocky Mountains of British Columbia, Canada, were medium to high mountains landscpe shows a historical landslide prone conditions.</p>
<p>The basic input data are:</p>
<ul class="simple">
<li><p>A polygon <strong>shapefile</strong> containing a large amount of landslides of different type, including debris flow separated by the functional zones.</p></li>
<li><p>A set of digital elevation layers in <strong>tif</strong> format provided by different sources.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Figures/Fig_1_Location_map.png&quot;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_3_0.png" class="no-scaled-link" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_3_0.png" style="width: 500px; height: 300px;" />
</div>
</div>
</section>
<section id="2.0-Data-Pre-Processing">
<h2><span class="section-number">2.6.2. </span><strong>2.0 Data Pre-Processing</strong><a class="headerlink" href="#2.0-Data-Pre-Processing" title="Permalink to this headline"></a></h2>
<section id="2.1--DEM-EXPLORATION-AND-COMPOSITION">
<h3><span class="section-number">2.6.2.1. </span>2.1- DEM EXPLORATION AND COMPOSITION<a class="headerlink" href="#2.1--DEM-EXPLORATION-AND-COMPOSITION" title="Permalink to this headline"></a></h3>
<p>The eastern part of the study area is covered by a DEM data set generated with LiDAR data and provided in smaller tiles with resolution 1x1 meterr. These files are in ESRI binary format <em>.adf</em>. Therefore we carried out a merging and resampling processes in order to obtain one single DEM:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

mkdir TIF_files

<span class="k">for</span> i <span class="k">in</span> <span class="k">$(</span>ls -1 <span class="p">|</span> grep -v TIF_files<span class="k">)</span><span class="p">;</span> <span class="k">do</span>

<span class="nv">input</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span>/w001001.adf<span class="k">)</span>

<span class="nv">output</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> TIF_files/<span class="si">${</span><span class="nv">i</span><span class="si">}</span>.tif<span class="k">)</span>

gdal_translate -a_srs EPSG:2955 -of GTiff <span class="nv">$input</span> <span class="nv">$output</span><span class="p">;</span>

<span class="k">done</span>

gdal_merge.py -ot Float32 -of GTiff -o mooselake_merged_1x1.tif TIF_files/*.tif

gdal_translate mooselake_merged_1x1.tif mooselake_merged_5x5.tif -tr <span class="m">5</span> <span class="m">5</span>
</pre></div>
</div>
</div>
<p>On the other hand, for the western part of the study area only the native LiDAR <em>.laz</em> files were provided. In order to generate a 5x5 <em>.tif</em> file we carried out the following work flow using <strong>pdal</strong> and <strong>gdal</strong> libraries:</p>
<ul class="simple">
<li><p><em>The complete process spent ~ 10 hours on the server [1635 .laz files]</em></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="c1"># Band 1 = min; Band 2 = max; Band 3 = mean; Band 4 = idw; Band 5= count; Band 6 = stdev</span>

<span class="nv">band_num</span><span class="o">=</span><span class="m">1</span>

<span class="nv">file_list</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

<span class="c1"># Loop to extract only class 2 points (ground points) from LAZ files</span>

<span class="k">for</span> i <span class="k">in</span> *.laz

<span class="k">do</span>
    <span class="nb">echo</span> <span class="nv">$i</span>

    <span class="nv">name</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> cut -f1 -d<span class="s1">&#39;.&#39;</span><span class="k">)</span>

    <span class="nv">name</span><span class="o">=</span><span class="nv">$name</span><span class="s2">&quot;_class2.laz&quot;</span>

    pdal translate <span class="nv">$i</span> <span class="nv">$name</span> --json class_2_filter.json

    <span class="c1"># Append the name of each file like file1 file2 file3 ...</span>

    <span class="nv">file_list</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$file_list</span><span class="s2"> </span><span class="nv">$name</span><span class="s2">&quot;</span><span class="sb">`</span>

    <span class="nb">echo</span> <span class="nv">$file_list</span>

<span class="k">done</span>

<span class="c1"># merge all the LAZ files that contain only class 2 points into one single file</span>

pdal merge <span class="nv">$file_list</span> merged_file.laz


<span class="c1">#to define the coordinate system</span>

pdal pipeline proj_deff.json

<span class="c1"># generate the multiband raster file with the measured values within each pixel with 2.5x2.5</span>

pdal pipeline to_raster.json

<span class="c1"># resample the final dtm to 5x5 resolution</span>

gdal_translate dtm_2_5_.tif dtm_5_.tif -tr <span class="m">5</span> <span class="m">5</span>

<span class="c1"># fill the void pixels by IDW interpolation</span>

gdal_fillnodata.py -md <span class="m">20</span> -of GTiff dtm_5_.tif dtm_5_idw.tif
</pre></div>
</div>
</div>
<p>Once we have the two DEM files <strong>dtm_5_idw.tif</strong> [western part] and <strong>mooselake_merged_5x5.tif</strong> [eastern part], we are going to verify that their NaData value and data Type are identical:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/dtm/
<span class="k">for</span> i <span class="k">in</span> <span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;dtm_5_idw.tif mooselake_merged_5x5.tif&quot;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> gdalinfo <span class="nv">$i</span> <span class="p">|</span> grep NoData<span class="p">;</span> <span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> i <span class="k">in</span> <span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;dtm_5_idw.tif mooselake_merged_5x5.tif&quot;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> gdalinfo <span class="nv">$i</span> <span class="p">|</span> grep Type<span class="p">;</span> <span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> i <span class="k">in</span> <span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;dtm_5_idw.tif mooselake_merged_5x5.tif&quot;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> gdalinfo <span class="nv">$i</span> <span class="p">|</span> grep Pixel<span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dtm_5_idw.tif
  NoData Value=-9999
mooselake_merged_5x5.tif
  NoData Value=-9999

dtm_5_idw.tif
Band 1 Block=14618x1 Type=Float64, ColorInterp=Gray
mooselake_merged_5x5.tif
Band 1 Block=5804x1 Type=Float64, ColorInterp=Gray

dtm_5_idw.tif
Pixel Size = (5.000000000000000,-5.000000000000000)
mooselake_merged_5x5.tif
Pixel Size = (5.000000000000000,-5.000000000000000)
</pre></div></div>
</div>
<p>Since everything seem to be correct, we combined the two layer in one single DEM using <strong>pk_composite</strong> and considering the average value when there are overlapping pixels.</p>
<ul class="simple">
<li><p><strong>Actually a more complex cleaning procedure was needed but for the sake of the example lets pretend this ideal situation</strong> <strong>:-)</strong></p></li>
<li><p>Indeed, I had to use also <strong>gdal_edit.py</strong>, <strong>pkreclass</strong>, <strong>gdal_calc.py</strong> …</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/dtm/
pkcomposite -i mooselake_merged_5x5.tif -i dtm_5_idw.tif -o /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/elevation2.tif -srcnodata -9999 -dstnodata -9999 -cr meanband
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/
gdal_edit.py -a_nodata -9999 elevation2.tif
gdalinfo -mm elevation2.tif
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show_hist</span>
<span class="n">raster</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/elevation2.tif&quot;</span><span class="p">)</span>
<span class="n">rasterio</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_14_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_14_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff9d7374cd0&gt;
</pre></div></div>
</div>
</section>
<section id="2.2--LANDSLIDE-INVENTORY-EXPLORATION-AND-EXTRACTION-OF-SOURCE-ZONES">
<h3><span class="section-number">2.6.2.2. </span>2.2- LANDSLIDE INVENTORY EXPLORATION AND EXTRACTION OF SOURCE ZONES<a class="headerlink" href="#2.2--LANDSLIDE-INVENTORY-EXPLORATION-AND-EXTRACTION-OF-SOURCE-ZONES" title="Permalink to this headline"></a></h3>
<p>Now we are going to explore the information contained in the landslide inventoy shapefile.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/
ogrinfo -so Valemount_landslide_inventory_2022.shp Valemount_landslide_inventory_2022 <span class="p">|</span> grep Count
ogrinfo -so Valemount_landslide_inventory_2022.shp Valemount_landslide_inventory_2022 <span class="p">|</span> tail -10
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Feature Count: 2191
Data axis to CRS axis mapping: 1,2
id: Integer64 (10.0)
Lnds_name: String (80.0)
Lnds_zone: String (80.0)
Type: String (80.0)
Ortho_1x1: String (10.0)
Google: String (10.0)
LiDAR: String (10.0)
Confidence: Integer64 (10.0)
Channelize: String (10.0)
</pre></div></div>
</div>
<p>Next step is to extract only the polygons classified as “debris flow” and save just those classified as “source” zones.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/
ogr2ogr -sql <span class="s2">&quot;SELECT * FROM Valemount_landslide_inventory_2022 WHERE Type=&#39;debris flow&#39; AND Lnds_zone=&#39;source&#39;&quot;</span> debris_flow_sources_2.shp Valemount_landslide_inventory_2022.shp
ogrinfo -so debris_flow_sources_2.shp debris_flow_sources_2 <span class="p">|</span> grep Count
ogrinfo -so debris_flow_sources_2.shp debris_flow_sources_2 <span class="p">|</span> tail -10
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Feature Count: 463
Data axis to CRS axis mapping: 1,2
id: Integer64 (10.0)
Lnds_name: String (80.0)
Lnds_zone: String (80.0)
Type: String (80.0)
Ortho_1x1: String (10.0)
Google: String (10.0)
LiDAR: String (10.0)
Confidence: Integer64 (10.0)
Channelize: String (10.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="n">inventory</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Valemount_landslide_inventory_2022.shp&quot;</span><span class="p">)</span>
<span class="n">inventory_sources</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/debris_flow_sources_2.shp&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">inventory</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Complete Inventory&quot;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">inventory_sources</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Source Inventory&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1, &#39;Source Inventory&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_20_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_20_1.png" />
</div>
</div>
</section>
<section id="2.3--GENERARION-OF-THE-SPATIAL-VARIABLES">
<h3><span class="section-number">2.6.2.3. </span>2.3- GENERARION OF THE SPATIAL VARIABLES<a class="headerlink" href="#2.3--GENERARION-OF-THE-SPATIAL-VARIABLES" title="Permalink to this headline"></a></h3>
<p>At this point we need a set of raster maps from which we are going to extract the different variables for the data set generation. * It is very important that all the raster maps have the same size and are correctly aligned so all the pixels overlap perfectly. * The dependent variable (<strong>source inventory</strong>) has to be in perfect alignement as well.</p>
<p>We are going to use the <strong>pyjeo</strong> library to prepare the final inventory raster layer where: * The value of 0 is given to all the pixels in the DEM that do NOT contain a debris flow source area. * The value of 1 is given to all the pixels in the DEM that do NOT contain a debris flow source area. * NoData value (-9999) are given to the valley bottom plain areas. Those where manually defined by a polygon shapefile.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pyjeo</span> <span class="k">as</span> <span class="nn">pj</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">sources</span> <span class="o">=</span><span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/debris_flow_sources_2.shp&#39;</span>
<span class="n">plains</span> <span class="o">=</span> <span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/flood_planes.shp&#39;</span>
<span class="n">elevation</span> <span class="o">=</span> <span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/elevation.tif&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span> <span class="o">=</span> <span class="n">pj</span><span class="o">.</span><span class="n">JimVect</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pj</span><span class="o">.</span><span class="n">JimVect</span><span class="p">(</span><span class="n">plains</span><span class="p">)</span>
<span class="n">jim</span> <span class="o">=</span><span class="n">pj</span><span class="o">.</span><span class="n">Jim</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jim</span><span class="p">[</span><span class="n">jim</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">jim</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">jim</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">jim</span><span class="o">.</span><span class="n">np</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">jim1</span> <span class="o">=</span> <span class="n">pj</span><span class="o">.</span><span class="n">Jim</span><span class="p">(</span><span class="n">jim</span><span class="p">)</span>
<span class="n">jim1</span><span class="p">[</span><span class="n">jim1</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">jim1</span><span class="o">.</span><span class="n">np</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jim</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">setNoDataVals</span><span class="p">(</span><span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
<span class="n">jim</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/inventory_clean_rast.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jim_mask</span> <span class="o">=</span><span class="n">pj</span><span class="o">.</span><span class="n">Jim</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span>
<span class="n">jim_mask</span><span class="p">[</span><span class="n">jim_mask</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">jim_mask</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">setNoDataVals</span><span class="p">(</span><span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
<span class="n">jim</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/mask_1.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>A final step is needed in order to remove some source area pixels out of the boundaries of the DEM.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
gdal_calc.py -A /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/mask_1.tif <span class="se">\</span>
-B /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/inventory_clean_rast.tif <span class="se">\</span>
--calc<span class="o">=</span><span class="s2">&quot;A*B&quot;</span> --outfile /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/inventory_def.tif --NoDataValue<span class="o">=</span>-9999
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inventory</span> <span class="o">=</span> <span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/inventory_def.tif&#39;</span>
<span class="n">jim</span> <span class="o">=</span><span class="n">pj</span><span class="o">.</span><span class="n">Jim</span><span class="p">(</span><span class="n">inventory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">jim1</span> <span class="o">=</span> <span class="n">pj</span><span class="o">.</span><span class="n">Jim</span><span class="p">(</span><span class="n">jim</span><span class="p">)</span>
<span class="n">jim1</span><span class="p">[</span><span class="n">jim1</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">jim1</span><span class="o">.</span><span class="n">np</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>In the following lines we are going to generate the geomorphometric variables: <strong>slope and aspect</strong> + An additional variable that was generated in Grass, <strong>flow_accumulation</strong> <em>“r.watershed -a -s elevation=elevation accumulation=flow_acc threshold=20”</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/
<span class="c1"># calculate  slope</span>
gdaldem slope -co <span class="nv">COMPRESS</span><span class="o">=</span>DEFLATE -co <span class="nv">ZLEVEL</span><span class="o">=</span><span class="m">9</span> elevation.tif slope.tif
<span class="c1"># calculate  apect</span>
gdaldem aspect -co <span class="nv">COMPRESS</span><span class="o">=</span>DEFLATE -co <span class="nv">ZLEVEL</span><span class="o">=</span><span class="m">9</span> elevation.tif aspect.tif
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span> <span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="n">inventory</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/inventory_def.tif&quot;</span><span class="p">)</span>
<span class="n">rasterio</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">inventory</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;INVENTORY&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">),(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">))</span><span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">map1</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/elevation.tif&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">map1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;CMRmap&quot;</span><span class="p">)</span>
<span class="n">map2</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/slope.tif&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">map2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Reds&quot;</span><span class="p">)</span>
<span class="n">map3</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/aspect.tif&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">map3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;aspect&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">map4</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/flow_acc.tif&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">((</span><span class="n">map4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;flow_accumulation&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;prism&quot;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_35_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_35_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_35_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_35_1.png" />
</div>
</div>
</section>
<section id="2.4--EXTRACT-THE-DATA-TABLE-FROM-RASTER-LAYERS">
<h3><span class="section-number">2.6.2.4. </span>2.4- EXTRACT THE DATA TABLE FROM RASTER LAYERS<a class="headerlink" href="#2.4--EXTRACT-THE-DATA-TABLE-FROM-RASTER-LAYERS" title="Permalink to this headline"></a></h3>
<p>The objective of this section is to organize the data in a tabular format in a way that: * Each row corresponds to one single pixel observation * Each column corresponds to the value that contains each raster map in the same pixel, i.e, the variables.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">cd</span> /home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/
<span class="c1"># generate a virtual multiband layer with all the raster maps</span>
gdalbuildvrt -separate variables_stack_2.vrt inventory_def.tif elevation.tif slope.tif aspect.tif flow_acc.tif
gdalinfo variables_stack_2.vrt <span class="p">|</span> tail -23
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># generate the xyz table skipinig nodata pixels</span>
gdal2xyz.py -allbands -skipnodata variables_stack_2.vrt /home/txomin/LVM_shared/Project/Valemount_data/valemount_source_dataset_2.txt
<span class="c1">#head -20 /home/txomin/LVM_shared/Project/Valemount_data/valemount_source_dataset_2.txt</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
head -20 /home/txomin/LVM_shared/Project/Valemount_data/valemount_source_dataset_2.txt
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
318111.460 5895928.235 0 2149.23 -9999 -9999 6
318116.460 5895928.235 0 2151.8 -9999 -9999 6
318121.460 5895928.235 0 2153.36 -9999 -9999 1
318126.460 5895928.235 0 2154.47 -9999 -9999 1
318106.460 5895923.235 0 2148 -9999 -9999 742
318111.460 5895923.235 0 2151.51 -9999 -9999 9
318116.460 5895923.235 0 2154.06 33.5292 318.359 5
318121.460 5895923.235 0 2155.99 31.6916 328.32 5
318126.460 5895923.235 0 2157.46 -9999 -9999 1
318131.460 5895923.235 0 2158.57 -9999 -9999 10
318136.460 5895923.235 0 2159.91 -9999 -9999 6
318141.460 5895923.235 0 2161.81 -9999 -9999 6
318146.460 5895923.235 0 2163.8 -9999 -9999 1
318151.460 5895923.235 0 2165.67 -9999 -9999 1
318106.460 5895918.235 0 2150.79 -9999 -9999 43
318111.460 5895918.235 0 2154.07 37.8872 310.268 741
318116.460 5895918.235 0 2156.66 34.1429 317.984 8
318121.460 5895918.235 0 2158.6 31.4858 325.843 4
318126.460 5895918.235 0 2160.15 30.3317 331.319 4
318131.460 5895918.235 0 2161.48 30.7167 333.778 4
</pre></div></div>
</div>
</section>
</section>
<section id="3.0-Data-Exploration">
<h2><span class="section-number">2.6.3. </span><strong>3.0 Data Exploration</strong><a class="headerlink" href="#3.0-Data-Exploration" title="Permalink to this headline"></a></h2>
<p>Once we have our information well organized in a table, let’s explore and refine it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show_hist</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="c1">#import skgstat as skg  # It gives AttributeError: module &#39;plotly.graph_objs&#39; has no attribute &#39;FigureWidget&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">original_data_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/valemount_source_dataset_2.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">original_data_table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;elevation&quot;</span><span class="p">,</span> <span class="s2">&quot;slope&quot;</span><span class="p">,</span> <span class="s2">&quot;aspect&quot;</span><span class="p">,</span> <span class="s2">&quot;flow_acc&quot;</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">original_data_table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>source</th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>318116.46</td>
      <td>5895928.235</td>
      <td>0</td>
      <td>2151.80</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>318121.46</td>
      <td>5895928.235</td>
      <td>0</td>
      <td>2153.36</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>318126.46</td>
      <td>5895928.235</td>
      <td>0</td>
      <td>2154.47</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>318106.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2148.00</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>742.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>318111.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2151.51</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>318116.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2154.06</td>
      <td>33.5292</td>
      <td>318.359</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>318121.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2155.99</td>
      <td>31.6916</td>
      <td>328.320</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>318126.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2157.46</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>318131.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2158.57</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>318136.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2159.91</td>
      <td>-9999.0000</td>
      <td>-9999.000</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>All the rows with NoData values (-9999) are going to be excluded from the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;original_data_table  &quot;</span><span class="p">,</span> <span class="n">original_data_table</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">clean_data_table</span> <span class="o">=</span> <span class="n">original_data_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">original_data_table</span><span class="p">[</span><span class="s2">&quot;aspect&quot;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">9999</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">original_data_table</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">!=-</span><span class="mi">9999</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;clean_data_table  &quot;</span><span class="p">,</span> <span class="n">clean_data_table</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">clean_data_table</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
original_data_table   (46517746, 7)
clean_data_table   (39357034, 7)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>source</th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>318116.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2154.06</td>
      <td>33.5292</td>
      <td>318.359</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>318121.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>2155.99</td>
      <td>31.6916</td>
      <td>328.320</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>318111.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2154.07</td>
      <td>37.8872</td>
      <td>310.268</td>
      <td>741.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>318116.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2156.66</td>
      <td>34.1429</td>
      <td>317.984</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>318121.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2158.60</td>
      <td>31.4858</td>
      <td>325.843</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>318126.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2160.15</td>
      <td>30.3317</td>
      <td>331.319</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>318131.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2161.48</td>
      <td>30.7167</td>
      <td>333.778</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>318136.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2162.71</td>
      <td>31.3158</td>
      <td>331.904</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>318141.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2164.15</td>
      <td>30.2020</td>
      <td>328.198</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>318146.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>2165.63</td>
      <td>27.7112</td>
      <td>323.888</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We verify that there are no extrange values</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_data_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">clean_data_table</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source</th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3.935703e+07</td>
      <td>3.935703e+07</td>
      <td>3.935703e+07</td>
      <td>3.935703e+07</td>
      <td>3.935703e+07</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.226281e-02</td>
      <td>1.588436e+03</td>
      <td>2.620067e+01</td>
      <td>1.750631e+02</td>
      <td>2.457294e+03</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.011881e-01</td>
      <td>4.517979e+02</td>
      <td>1.206892e+01</td>
      <td>1.037492e+02</td>
      <td>1.529432e+05</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>7.330930e+02</td>
      <td>4.945590e-04</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000e+00</td>
      <td>1.188990e+03</td>
      <td>1.773670e+01</td>
      <td>7.559980e+01</td>
      <td>3.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000e+00</td>
      <td>1.604960e+03</td>
      <td>2.682900e+01</td>
      <td>1.868490e+02</td>
      <td>1.000000e+01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000e+00</td>
      <td>1.966760e+03</td>
      <td>3.413430e+01</td>
      <td>2.566960e+02</td>
      <td>3.000000e+01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000e+00</td>
      <td>2.845970e+03</td>
      <td>8.715910e+01</td>
      <td>3.599990e+02</td>
      <td>2.062980e+07</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Count observations with source = 1 vs source = 0</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source area observations:      &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non-Source area observations:  &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Source area observations:       1663339
Non-Source area observations:   37693695
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clean_data_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">clean_data_table</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1">#clean_data_table.loc[:, ~clean_data_table.columns.isin([&#39;X&#39;, &#39;Y&#39;, &#39;source&#39;])].boxplot(figsize=(12, 8))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7ff9cdc42ca0&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7ff9cdc68550&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7ff9cdc10dc0&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7ff9cdbc8640&gt;]],
      dtype=object)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_50_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_50_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;flow_acc &gt; 20000000:      &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;flow_acc&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20000000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;flow_acc &gt; 10000000:      &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;flow_acc&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;flow_acc &gt; 5000000:      &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;flow_acc&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5000000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;flow_acc &gt; 2500000:      &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;flow_acc&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2500000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;flow_acc &gt; 1000000:      &quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">clean_data_table</span><span class="p">[</span><span class="s2">&quot;flow_acc&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
flow_acc &gt; 20000000:       550
flow_acc &gt; 10000000:       1677
flow_acc &gt; 5000000:       5497
flow_acc &gt; 2500000:       7933
flow_acc &gt; 1000000:       11605
</pre></div></div>
</div>
<p>In the following code blocks we are going to normaliza the values of the explanatory variables</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">features</span> <span class="o">=</span> <span class="n">clean_data_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">clean_data_table</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">])]</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">clean_data_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">features</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;elevation&#39; &#39;slope&#39; &#39;aspect&#39; &#39;flow_acc&#39;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>2154.06</td>
      <td>33.52920</td>
      <td>318.3590</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2155.99</td>
      <td>31.69160</td>
      <td>328.3200</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2154.07</td>
      <td>37.88720</td>
      <td>310.2680</td>
      <td>741.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2156.66</td>
      <td>34.14290</td>
      <td>317.9840</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2158.60</td>
      <td>31.48580</td>
      <td>325.8430</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>46512529</th>
      <td>2040.47</td>
      <td>8.61856</td>
      <td>354.3010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>46512530</th>
      <td>2039.94</td>
      <td>14.53420</td>
      <td>31.1026</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>46512531</th>
      <td>2039.16</td>
      <td>18.42540</td>
      <td>38.7273</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>46512532</th>
      <td>2037.82</td>
      <td>23.45520</td>
      <td>52.2631</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>46512533</th>
      <td>2035.73</td>
      <td>25.49600</td>
      <td>52.1357</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>39357034 rows × 4 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaled_features</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
numpy.ndarray
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scaled_features</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(39357034, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data_3</span> <span class="o">=</span> <span class="n">clean_data_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">data_3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(39357034, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cols</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;elevation&#39;, &#39;slope&#39;, &#39;aspect&#39;, &#39;flow_acc&#39;], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data_scaled</span> <span class="o">=</span> <span class="n">clean_data_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">data_scaled</span><span class="p">[[</span><span class="s2">&quot;elevation&quot;</span><span class="p">,</span> <span class="s2">&quot;slope&quot;</span><span class="p">,</span> <span class="s2">&quot;aspect&quot;</span><span class="p">,</span> <span class="s2">&quot;flow_acc&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaled_features</span>
<span class="n">data_scaled</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>source</th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>318116.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>0.672527</td>
      <td>0.384686</td>
      <td>0.884333</td>
      <td>1.938943e-07</td>
    </tr>
    <tr>
      <th>6</th>
      <td>318121.46</td>
      <td>5895923.235</td>
      <td>0</td>
      <td>0.673441</td>
      <td>0.363603</td>
      <td>0.912003</td>
      <td>1.938943e-07</td>
    </tr>
    <tr>
      <th>14</th>
      <td>318111.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>0.672532</td>
      <td>0.434687</td>
      <td>0.861858</td>
      <td>3.587044e-05</td>
    </tr>
    <tr>
      <th>15</th>
      <td>318116.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>0.673758</td>
      <td>0.391727</td>
      <td>0.883291</td>
      <td>3.393150e-07</td>
    </tr>
    <tr>
      <th>16</th>
      <td>318121.46</td>
      <td>5895918.235</td>
      <td>0</td>
      <td>0.674676</td>
      <td>0.361242</td>
      <td>0.905122</td>
      <td>1.454207e-07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>46512529</th>
      <td>372166.46</td>
      <td>5861728.235</td>
      <td>0</td>
      <td>0.618766</td>
      <td>0.098878</td>
      <td>0.984172</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>46512530</th>
      <td>372171.46</td>
      <td>5861728.235</td>
      <td>0</td>
      <td>0.618515</td>
      <td>0.166750</td>
      <td>0.086396</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>46512531</th>
      <td>372176.46</td>
      <td>5861728.235</td>
      <td>0</td>
      <td>0.618146</td>
      <td>0.211395</td>
      <td>0.107576</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>46512532</th>
      <td>372181.46</td>
      <td>5861728.235</td>
      <td>0</td>
      <td>0.617512</td>
      <td>0.269104</td>
      <td>0.145176</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>46512533</th>
      <td>372186.46</td>
      <td>5861728.235</td>
      <td>0</td>
      <td>0.616523</td>
      <td>0.292519</td>
      <td>0.144822</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>39357034 rows × 7 columns</p>
</div></div>
</div>
<p>Now we are going to create a sample of the dataset where the amount of 0 and 1 is balanced.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx_1</span> <span class="o">=</span> <span class="n">data_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">data_scaled</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">idx_0</span> <span class="o">=</span> <span class="n">data_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">data_scaled</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">idx_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">idx_0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_1</span><span class="p">),</span><span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx_1</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">idx_0</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">idx_1</span><span class="p">,</span><span class="n">idx_0</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1663339
[150961, 150962, 150963, 150964, 150965, 150966, 152101, 152102, 152103, 152104]
1663339
[26688694 45123329  9564539 10816655  5537332 13037328  5980513 23094458
 18879536 30389180]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">balanced_data</span> <span class="o">=</span> <span class="n">data_scaled</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">balanced_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>source</th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>150961</th>
      <td>319961.46</td>
      <td>5894608.235</td>
      <td>1</td>
      <td>0.595940</td>
      <td>0.339840</td>
      <td>0.396357</td>
      <td>9.694714e-08</td>
    </tr>
    <tr>
      <th>150962</th>
      <td>319966.46</td>
      <td>5894608.235</td>
      <td>1</td>
      <td>0.595272</td>
      <td>0.362591</td>
      <td>0.450573</td>
      <td>4.362621e-07</td>
    </tr>
    <tr>
      <th>150963</th>
      <td>319971.46</td>
      <td>5894608.235</td>
      <td>1</td>
      <td>0.595045</td>
      <td>0.400068</td>
      <td>0.502524</td>
      <td>1.938943e-07</td>
    </tr>
    <tr>
      <th>150964</th>
      <td>319976.46</td>
      <td>5894608.235</td>
      <td>1</td>
      <td>0.595320</td>
      <td>0.440486</td>
      <td>0.538529</td>
      <td>2.423678e-07</td>
    </tr>
    <tr>
      <th>150965</th>
      <td>319981.46</td>
      <td>5894608.235</td>
      <td>1</td>
      <td>0.595973</td>
      <td>0.468536</td>
      <td>0.550835</td>
      <td>1.938943e-07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>27886027</th>
      <td>339506.46</td>
      <td>5874793.235</td>
      <td>0</td>
      <td>0.386765</td>
      <td>0.131417</td>
      <td>0.613079</td>
      <td>6.204617e-06</td>
    </tr>
    <tr>
      <th>41033936</th>
      <td>340421.46</td>
      <td>5868053.235</td>
      <td>0</td>
      <td>0.050412</td>
      <td>0.194976</td>
      <td>0.622460</td>
      <td>5.332093e-07</td>
    </tr>
    <tr>
      <th>9066271</th>
      <td>329916.46</td>
      <td>5885468.235</td>
      <td>0</td>
      <td>0.116418</td>
      <td>0.275109</td>
      <td>0.405784</td>
      <td>1.454207e-07</td>
    </tr>
    <tr>
      <th>33465275</th>
      <td>322626.46</td>
      <td>5872008.235</td>
      <td>0</td>
      <td>0.326563</td>
      <td>0.358624</td>
      <td>0.738435</td>
      <td>9.694714e-08</td>
    </tr>
    <tr>
      <th>42614980</th>
      <td>371521.46</td>
      <td>5867053.235</td>
      <td>0</td>
      <td>0.223045</td>
      <td>0.242978</td>
      <td>0.039239</td>
      <td>2.908414e-07</td>
    </tr>
  </tbody>
</table>
<p>3326678 rows × 7 columns</p>
</div></div>
</div>
<p>Finaly we generate the scatter plots to observe the relationship between the variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_sample</span> <span class="o">=</span> <span class="n">balanced_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="o">~</span><span class="n">balanced_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">predictors_sample</span> <span class="p">,</span>  <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">scatter_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_63_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_63_0.png" />
</div>
</div>
<p><strong>I’d like to do a variogram to check the spatial autorcorrelation but cant install skgstat</strong></p>
</section>
<section id="4.0-Machine-Learning">
<h2><span class="section-number">2.6.4. </span><strong>4.0 Machine Learning</strong><a class="headerlink" href="#4.0-Machine-Learning" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">from</span> <span class="nn">rasterio</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">rasterio.plot</span> <span class="kn">import</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">pyspatialml</span> <span class="kn">import</span> <span class="n">Raster</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span><span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">RocCurveDisplay</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">6.5</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data.sampler</span> <span class="kn">import</span> <span class="n">WeightedRandomSampler</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
</pre></div>
</div>
</div>
<section id="4.1-Data-set-splitting">
<h3><span class="section-number">2.6.4.1. </span>4.1 Data set splitting<a class="headerlink" href="#4.1-Data-set-splitting" title="Permalink to this headline"></a></h3>
<p>Split the dataset (balanced_data) in order to create response variable vs predictors variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number observations with 1:  </span><span class="si">{</span><span class="n">balanced_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">balanced_data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number observations with 0:  </span><span class="si">{</span><span class="n">balanced_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">balanced_data</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1">#print(&quot;Test data set&quot;)</span>
<span class="c1">#print(f&quot;number of pixels with value 1: {np.count_nonzero(Y_test == 1)}&quot;)</span>
<span class="c1">#print(f&quot;number of pixels with value 0: {np.count_nonzero(Y_test == 0)}&quot;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number observations with 1:  (1663339, 7)
Number observations with 0:  (1663339, 7)
</pre></div></div>
</div>
<p>I create a subset for the exploration phase</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">balanced_data</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#print(subset[&quot;source&quot;].unique)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number observations with 1:  </span><span class="si">{</span><span class="n">subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number observations with 0:  </span><span class="si">{</span><span class="n">subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(332668, 7)

Number observations with 1:  (166334, 7)
Number observations with 0:  (166334, 7)
</pre></div></div>
</div>
<p>We separate the predictors in an independent dataframe</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#predictors = balanced_data.iloc[:,[3,4,5,6,7,8]]</span>
<span class="c1">#predictors = subset.iloc[:,[3,4,5,6,7,8]]</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>150961</th>
      <td>0.595940</td>
      <td>0.339840</td>
      <td>0.396357</td>
      <td>9.694714e-08</td>
    </tr>
    <tr>
      <th>152105</th>
      <td>0.593540</td>
      <td>0.432921</td>
      <td>0.523760</td>
      <td>2.908414e-07</td>
    </tr>
    <tr>
      <th>153248</th>
      <td>0.592641</td>
      <td>0.384547</td>
      <td>0.392640</td>
      <td>1.938943e-07</td>
    </tr>
    <tr>
      <th>153258</th>
      <td>0.592565</td>
      <td>0.412114</td>
      <td>0.568174</td>
      <td>4.847357e-08</td>
    </tr>
    <tr>
      <th>154403</th>
      <td>0.590492</td>
      <td>0.485489</td>
      <td>0.506679</td>
      <td>2.423678e-07</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And we generate the target variable Y.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Y = balanced_data.iloc[:,2].values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#cols = balanced_data.iloc[:,[3,4,5,6,7,8]].columns.values</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">subset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(332668,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 1])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">class_sample_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span> <span class="o">==</span> <span class="n">t</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">Y</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">class_sample_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[166334 166334]
</pre></div></div>
</div>
<p>Create 4 dataset for training and testing the algorithms</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>
<span class="n">predictors_train</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4543580</th>
      <td>0.489895</td>
      <td>0.416931</td>
      <td>0.090972</td>
      <td>2.423678e-07</td>
    </tr>
    <tr>
      <th>31626453</th>
      <td>0.623329</td>
      <td>0.452705</td>
      <td>0.609088</td>
      <td>4.459568e-06</td>
    </tr>
    <tr>
      <th>8014862</th>
      <td>0.500084</td>
      <td>0.343213</td>
      <td>0.370626</td>
      <td>7.271035e-07</td>
    </tr>
    <tr>
      <th>12333889</th>
      <td>0.351926</td>
      <td>0.308792</td>
      <td>0.002270</td>
      <td>9.694714e-08</td>
    </tr>
    <tr>
      <th>1119096</th>
      <td>0.400774</td>
      <td>0.096089</td>
      <td>0.546268</td>
      <td>1.216687e-05</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>27937440</th>
      <td>0.293026</td>
      <td>0.271926</td>
      <td>0.815419</td>
      <td>1.420276e-05</td>
    </tr>
    <tr>
      <th>13744240</th>
      <td>0.237982</td>
      <td>0.517935</td>
      <td>0.433001</td>
      <td>3.829412e-06</td>
    </tr>
    <tr>
      <th>23266746</th>
      <td>0.111182</td>
      <td>0.117781</td>
      <td>0.669988</td>
      <td>4.847357e-08</td>
    </tr>
    <tr>
      <th>460383</th>
      <td>0.643240</td>
      <td>0.338554</td>
      <td>0.273997</td>
      <td>1.163366e-06</td>
    </tr>
    <tr>
      <th>10976443</th>
      <td>0.665390</td>
      <td>0.200948</td>
      <td>0.046691</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>232867 rows × 4 columns</p>
</div></div>
</div>
<p>Verify that in both thaining and testing datasets the number of 0 and 1 is balanced.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train data set&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 1: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_train</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 0: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_train</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train data set
number of pixels with value 1: 116366
number of pixels with value 0: 116501
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test data set&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 1: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_test</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 0: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_test</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Test data set
number of pixels with value 1: 49968
number of pixels with value 0: 49833
</pre></div></div>
</div>
</section>
<section id="4.2-Random-Forest">
<h3><span class="section-number">2.6.4.2. </span>4.2 Random Forest<a class="headerlink" href="#4.2-Random-Forest" title="Permalink to this headline"></a></h3>
<p>We want to generate a RF algorithm to predict the probability of being a debris flow source area.</p>
<p>Even though we are in a classification problem. We are going to use the <strong>Regression</strong> mode of the Random Forest.</p>
<p>First we are going to evaluating the optimal n_estimator value for the Random Forest</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">scores</span> <span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="n">rfReg</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">k</span><span class="p">,</span><span class="n">max_features</span><span class="o">=</span><span class="mf">0..33</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">max_samples</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">24</span> <span class="p">,</span> <span class="n">oob_score</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">rfReg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
    <span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
    <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">scores</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Value of n_estimators for Random Forest Classifier&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Prediction Accuracy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Figures/RF_optimization.png&quot;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_88_0.png" class="no-scaled-link" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_88_0.png" style="width: 500px; height: 300px;" />
</div>
</div>
<p><strong>The model exploration phase gave the following conclusions:</strong></p>
<ul class="simple">
<li><p>n_estimators = 30 is the optimal parameter Let’s now run the final model</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rfReg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">max_features</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">max_samples</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">24</span> <span class="p">,</span> <span class="n">oob_score</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">rfReg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
<span class="n">dic_pred</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
<span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dic_pred</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;train&#39;: array([0.3780577 , 0.80381591, 0.747023  , ..., 0.02925411, 0.60093102,
        0.05171677]),
 &#39;test&#39;: array([0.50321099, 0.02264603, 0.71128009, ..., 0.68730963, 0.77844419,
        0.64082765])}
</pre></div></div>
</div>
<p>We generate a confusion matrix and a ROC curve in order to evaluate the performance of the model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="n">cm_display</span> <span class="o">=</span> <span class="n">ConfusionMatrixDisplay</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_93_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_93_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#y_score = rfReg.decision_function(predictors_test)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span> <span class="n">pos_label</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">roc_display</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="p">(</span><span class="n">fpr</span><span class="o">=</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="o">=</span><span class="n">tpr</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_94_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_94_0.png" />
</div>
</div>
<p>We can explore the organization of the results using the scatterplot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">dic_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span>
<span class="c1">#plt.scatter(y_train,y_pred)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;y_test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y_predict&#39;</span><span class="p">)</span>
<span class="n">ident</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ident</span><span class="p">,</span><span class="n">ident</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7ff9c322a820&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_96_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_96_1.png" />
</div>
</div>
<p>We can also have a look to the relevance of the used variables.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">impt</span> <span class="o">=</span> <span class="p">[</span><span class="n">rfReg</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">tree</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">rfReg</span><span class="o">.</span><span class="n">estimators_</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">impt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cols</span> <span class="o">=</span> <span class="n">clean_data_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)),</span><span class="n">impt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ind</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">impt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ind</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)),</span><span class="n">cols</span><span class="p">[</span><span class="n">ind</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_99_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_99_0.png" />
</div>
</div>
<p><strong>Now we can apply the generated model to the raster maps and obtain a susceptibility map</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">elevation</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/elevation.tif&quot;</span><span class="p">)</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/slope.tif&quot;</span><span class="p">)</span>
<span class="n">aspect</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/aspect.tif&quot;</span><span class="p">)</span>
<span class="n">flow_acc</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/flow_acc.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_rasters</span> <span class="o">=</span> <span class="p">[</span><span class="n">elevation</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">flow_acc</span><span class="p">]</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">Raster</span><span class="p">(</span><span class="n">predictors_rasters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">rfReg</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mi">9999</span><span class="p">)</span>
<span class="c1">#result_proba = stack.predict_proba(estimator=rfReg, dtype=&#39;float32&#39;, nodata=-9999)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># plot regression result</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;plasma&quot;</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/source_prob.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Figures/RfRegressor_map.png&quot;</span> <span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">800</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_107_0.png" class="no-scaled-link" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_107_0.png" style="width: 800px; height: 500px;" />
</div>
</div>
</section>
<section id="4.3-Support-Vector-Machine-for-Regression-(SVR)">
<h3><span class="section-number">2.6.4.3. </span>4.3 Support Vector Machine for Regression (SVR)<a class="headerlink" href="#4.3-Support-Vector-Machine-for-Regression-(SVR)" title="Permalink to this headline"></a></h3>
<p>We are going to try to apply the SVM Regressor to the same dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
</pre></div>
</div>
</div>
<p>We can plot a scatter plot of the most potential variables [elevation and slope] to observe if there is a clustering.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="s2">&quot;elevation&quot;</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">subset</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Linearly separable data?&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;elevation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;slope&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_112_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_112_0.png" />
</div>
</div>
<p>We create a much smaller subset for the exploration phase in order to avoid very long computational time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">subset_100</span> <span class="o">=</span> <span class="n">balanced_data</span><span class="p">[::</span><span class="mi">100</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_100</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#print(subset[&quot;source&quot;].unique)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number observations with 1:  </span><span class="si">{</span><span class="n">subset_100</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">subset_100</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number observations with 0:  </span><span class="si">{</span><span class="n">subset_100</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">subset_100</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(33267, 7)

Number observations with 1:  (16634, 7)
Number observations with 0:  (16633, 7)
</pre></div></div>
</div>
<p>We can save the subset table to use it directly in case of computer crash, and avoid all the previous steps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">subset_100</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/subset_100.txt&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;True&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="c1">#subset_100.write(&quot;/home/txomin/LVM_shared/Project/Valemount_data/subset_100.txt&quot;)#</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/subset_100.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>So, we have to split the data again in training and test subsets</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#predictors = balanced_data.iloc[:,[3,4,5,6,7,8]]</span>
<span class="c1">#predictors = subset.iloc[:,[3,4,5,6,7,8]]</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>150961</th>
      <td>0.595940</td>
      <td>0.339840</td>
      <td>0.396357</td>
      <td>9.694714e-08</td>
    </tr>
    <tr>
      <th>157876</th>
      <td>0.584775</td>
      <td>0.405498</td>
      <td>0.448568</td>
      <td>3.393150e-07</td>
    </tr>
    <tr>
      <th>162557</th>
      <td>0.588556</td>
      <td>0.386079</td>
      <td>0.216777</td>
      <td>5.332093e-07</td>
    </tr>
    <tr>
      <th>166125</th>
      <td>0.576947</td>
      <td>0.519611</td>
      <td>0.280226</td>
      <td>1.502681e-06</td>
    </tr>
    <tr>
      <th>169719</th>
      <td>0.594458</td>
      <td>0.375756</td>
      <td>0.173641</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Y = balanced_data.iloc[:,2].values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#cols = balanced_data.iloc[:,[3,4,5,6,7,8]].columns.values</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>
<span class="n">predictors_train</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23310647</th>
      <td>0.069639</td>
      <td>0.157875</td>
      <td>0.646518</td>
      <td>1.454207e-07</td>
    </tr>
    <tr>
      <th>11105549</th>
      <td>0.680895</td>
      <td>0.449267</td>
      <td>0.775413</td>
      <td>1.017945e-06</td>
    </tr>
    <tr>
      <th>25188622</th>
      <td>0.538591</td>
      <td>0.373464</td>
      <td>0.739144</td>
      <td>5.332093e-07</td>
    </tr>
    <tr>
      <th>16704940</th>
      <td>0.645838</td>
      <td>0.552962</td>
      <td>0.479199</td>
      <td>9.209978e-07</td>
    </tr>
    <tr>
      <th>17419574</th>
      <td>0.476822</td>
      <td>0.447592</td>
      <td>0.485196</td>
      <td>5.816828e-07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>15256488</th>
      <td>0.655266</td>
      <td>0.781469</td>
      <td>0.503718</td>
      <td>1.454207e-07</td>
    </tr>
    <tr>
      <th>15886672</th>
      <td>0.536405</td>
      <td>0.397595</td>
      <td>0.151926</td>
      <td>1.017945e-06</td>
    </tr>
    <tr>
      <th>11527887</th>
      <td>0.420302</td>
      <td>0.407068</td>
      <td>0.675394</td>
      <td>4.847357e-08</td>
    </tr>
    <tr>
      <th>30547721</th>
      <td>0.544867</td>
      <td>0.266243</td>
      <td>0.684146</td>
      <td>5.816828e-07</td>
    </tr>
    <tr>
      <th>2970286</th>
      <td>0.569260</td>
      <td>0.714146</td>
      <td>0.611796</td>
      <td>7.755771e-07</td>
    </tr>
  </tbody>
</table>
<p>23286 rows × 4 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">predictors_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(23286, 4)
(23286,)
</pre></div></div>
</div>
<p>We can explore the optimal Regularization value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">)</span>
    <span class="n">svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> <span class="c1"># Fit the SVR model according to the given training data.</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regularization C = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> and kernel = rbf&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy of SVR on training set: </span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span> <span class="c1"># Returns the coefficient of determination (R^2) of the prediction.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy of SVR on test set: </span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Regularization C = 1 and kernel = rbf
Accuracy of SVR on training set: 0.24024
Accuracy of SVR on test set: 0.24185

Regularization C = 2 and kernel = rbf
Accuracy of SVR on training set: 0.24128
Accuracy of SVR on test set: 0.24294

Regularization C = 3 and kernel = rbf
Accuracy of SVR on training set: 0.24102
Accuracy of SVR on test set: 0.24268

Regularization C = 4 and kernel = rbf
Accuracy of SVR on training set: 0.24143
Accuracy of SVR on test set: 0.24291

Regularization C = 5 and kernel = rbf
Accuracy of SVR on training set: 0.24151
Accuracy of SVR on test set: 0.24282

Regularization C = 6 and kernel = rbf
Accuracy of SVR on training set: 0.24164
Accuracy of SVR on test set: 0.24309

Regularization C = 7 and kernel = rbf
Accuracy of SVR on training set: 0.24169
Accuracy of SVR on test set: 0.24309

Regularization C = 8 and kernel = rbf
Accuracy of SVR on training set: 0.24158
Accuracy of SVR on test set: 0.24296

Regularization C = 9 and kernel = rbf
Accuracy of SVR on training set: 0.24154
Accuracy of SVR on test set: 0.24285

Regularization C = 10 and kernel = rbf
Accuracy of SVR on training set: 0.24111
Accuracy of SVR on test set: 0.24226

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">)</span>
<span class="n">svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> <span class="c1"># Fit the SVR model according to the given training data.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy of SVR on training set: </span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span> <span class="c1"># Returns the coefficient of determination (R^2) of the prediction.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy of SVR on test set: </span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy of SVR on training set: 0.24744
Accuracy of SVR on test set: 0.23693
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">svr_pred</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">svr_pred</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
<span class="n">svr_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range prediction train: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">svr_pred</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> --  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">svr_pred</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range prediction test: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">svr_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> --  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">svr_pred</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
range prediction train: -0.6247238892601716 --  1.2884218089203205
range prediction test: -1.1966206427227377 --  1.1193402180140222
</pre></div></div>
</div>
<p>The resulting values are in the range of -1.2 and 1.3.</p>
<p>In order to represent the susceptibility these values should be passed by a <em>SIGMOIDAL</em> function.</p>
<blockquote>
<div><p>def sig_func(x):</p>
</div></blockquote>
<blockquote>
<div><p>return 1 / (1 + np.exp(-x))output = sig_func(input)</p>
<p>print(output)</p>
</div></blockquote>
<p><strong>The following commands block is the repetition of the block ran in the Random Forest section.</strong></p>
<p><strong>It is not ras because it takes a lot of time.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#del original_data_table</span>
<span class="c1">#del clean_data_table</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">elevation</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/elevation.tif&quot;</span><span class="p">)</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/slope.tif&quot;</span><span class="p">)</span>
<span class="n">aspect</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/aspect.tif&quot;</span><span class="p">)</span>
<span class="n">flow_acc</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/flow_acc.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_rasters</span> <span class="o">=</span> <span class="p">[</span><span class="n">elevation</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">flow_acc</span><span class="p">]</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">Raster</span><span class="p">(</span><span class="n">predictors_rasters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">svr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mi">9999</span><span class="p">)</span>
<span class="c1">#result_proba = stack.predict_proba(estimator=rfReg, dtype=&#39;float32&#39;, nodata=-9999)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># plot regression result</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;plasma&quot;</span>
<span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;/home/txomin/LVM_shared/Project/Valemount_data/Raster_variables/source_prob_svm.tif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Multilayer-Perceptron-(MP)">
<h2><span class="section-number">2.6.5. </span>Multilayer Perceptron (MP)<a class="headerlink" href="#Multilayer-Perceptron-(MP)" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
<p>Upload the data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">subset_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/home/txomin/LVM_shared/Project/Valemount_data/subset_100.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>  <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">subset_100</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">subset_100</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-16-d056b02f7cc8&gt;:1: DtypeWarning: Columns (1,2,3,4,5,6,7) have mixed types. Specify dtype option on import or set low_memory=False.
  subset_100 = pd.read_csv(&#34;/home/txomin/LVM_shared/Project/Valemount_data/subset_100.txt&#34;, sep=&#34; &#34;,  index_col=False)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>source</th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>319961.46</td>
      <td>5894608.235</td>
      <td>1</td>
      <td>0.5959395648681869</td>
      <td>0.33984028646546643</td>
      <td>0.39635665654626817</td>
      <td>9.694713942680682e-08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>319986.46</td>
      <td>5894578.235</td>
      <td>1</td>
      <td>0.5847746934629892</td>
      <td>0.4054976013231919</td>
      <td>0.4485679126886464</td>
      <td>3.393149879938239e-07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>319961.46</td>
      <td>5894558.235</td>
      <td>1</td>
      <td>0.5885562671182469</td>
      <td>0.3860789794735605</td>
      <td>0.21677699104719736</td>
      <td>5.332092668474375e-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>319991.46</td>
      <td>5894543.235</td>
      <td>1</td>
      <td>0.5769465046947835</td>
      <td>0.5196114051142899</td>
      <td>0.28022577840494</td>
      <td>1.502680661115506e-06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>319951.46</td>
      <td>5894528.235</td>
      <td>1</td>
      <td>0.5944581724350257</td>
      <td>0.3757564187183976</td>
      <td>0.17364076011322255</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#predictors = balanced_data.iloc[:,[3,4,5,6,7,8]]</span>
<span class="c1">#predictors = subset.iloc[:,[3,4,5,6,7,8]]</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.5959395648681869</td>
      <td>0.33984028646546643</td>
      <td>0.39635665654626817</td>
      <td>9.694713942680682e-08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5847746934629892</td>
      <td>0.4054976013231919</td>
      <td>0.4485679126886464</td>
      <td>3.393149879938239e-07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.5885562671182469</td>
      <td>0.3860789794735605</td>
      <td>0.21677699104719736</td>
      <td>5.332092668474375e-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.5769465046947835</td>
      <td>0.5196114051142899</td>
      <td>0.28022577840494</td>
      <td>1.502680661115506e-06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.5944581724350257</td>
      <td>0.3757564187183976</td>
      <td>0.17364076011322255</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Y = balanced_data.iloc[:,2].values</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#cols = balanced_data.iloc[:,[3,4,5,6,7,8]].columns.values</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">subset_100</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_train</span><span class="p">,</span> <span class="n">predictors_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_train</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">Y_test</span><span class="p">)</span>
<span class="n">predictors_train</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>elevation</th>
      <th>slope</th>
      <th>aspect</th>
      <th>flow_acc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17990</th>
      <td>0.11525091143497707</td>
      <td>0.3014757442257044</td>
      <td>0.9190747752077089</td>
      <td>4.8473569713403414e-08</td>
    </tr>
    <tr>
      <th>6084</th>
      <td>0.45213564253858607</td>
      <td>0.41195135304574293</td>
      <td>0.2594462762396562</td>
      <td>9.694713942680682e-08</td>
    </tr>
    <tr>
      <th>30356</th>
      <td>0.047089347841828944</td>
      <td>0.0844628640367968</td>
      <td>0.5593959983222175</td>
      <td>2.4236784856701703e-07</td>
    </tr>
    <tr>
      <th>48802</th>
      <td>0.3844459473977899</td>
      <td>0.44209180775710577</td>
      <td>0.8939580387723299</td>
      <td>5.816828365608409e-07</td>
    </tr>
    <tr>
      <th>47361</th>
      <td>0.4474784854963162</td>
      <td>0.37815434602508763</td>
      <td>0.4812041144558735</td>
      <td>6.301564062742443e-07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12411</th>
      <td>0.5962614009239535</td>
      <td>0.39583590474441815</td>
      <td>0.44982347173186593</td>
      <td>2.9084141828042046e-07</td>
    </tr>
    <tr>
      <th>6500</th>
      <td>0.6552662554422242</td>
      <td>0.7814685090057648</td>
      <td>0.5037180658835163</td>
      <td>1.4542070914021023e-07</td>
    </tr>
    <tr>
      <th>21633</th>
      <td>0.649212897863908</td>
      <td>0.17937305630231787</td>
      <td>0.923235897877494</td>
      <td>3.393149879938239e-07</td>
    </tr>
    <tr>
      <th>59537</th>
      <td>0.1984625702300702</td>
      <td>0.31834958006278136</td>
      <td>0.7250297917494215</td>
      <td>2.472152055383574e-06</td>
    </tr>
    <tr>
      <th>899</th>
      <td>0.569260302421769</td>
      <td>0.7141464130370311</td>
      <td>0.6117961438781775</td>
      <td>7.755771154144546e-07</td>
    </tr>
  </tbody>
</table>
<p>46574 rows × 4 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">predictors_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(46574, 4)
(46574,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train data set&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 1: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_train</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 0: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_train</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Train data set
number of pixels with value 1: 0
number of pixels with value 0: 691
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test data set&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 1: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_test</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;number of pixels with value 0: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">Y_test</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Test data set
number of pixels with value 1: 0
number of pixels with value 0: 308
</pre></div></div>
</div>
<p>In order to convert the predictors data frame to the Torch data, first they have to be transformed into <em>numpy</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pandas.core.frame.DataFrame
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Predictors_train</span> <span class="o">=</span> <span class="n">predictors_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">Predictors_test</span> <span class="o">=</span> <span class="n">predictors_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">type</span><span class="p">(</span><span class="n">Predictors_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
numpy.ndarray
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">predictors_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">Predictors_train</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">predictors_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">Predictors_test</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The objective is to run a Feed Forward Neural Network with the following parameters: * Mean Square Error (MSE) as a the evaluation criterion * Stochastic Gradient Descent (SGD) as the optimizer function * 1000 Epochs * Dimention Ranges 5, 25, 50, 100 * Lerning Rate values 0.75, 0.5, 0.1, 0.01, 0.05, 0.001 * Two hidden layers * Sigmoidal final activation function</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Try with FF</span>
<span class="k">class</span> <span class="nc">Feedforward</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Feedforward</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_size</span> <span class="o">=</span> <span class="n">input_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span>  <span class="o">=</span> <span class="n">hidden_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">)</span>
        <span class="c1"># self.fc3 = torch.nn.Linear(self.hidden_size, self.hidden_size)</span>
        <span class="c1"># self.fc4 = torch.nn.Linear(self.hidden_size, self.hidden_size)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tanh</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Tanh</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">hidden</span><span class="p">))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">hidden</span><span class="p">))</span>
        <span class="c1"># hidden = self.relu(self.fc4(hidden))</span>
        <span class="c1">#output = self.sigmoid(self.fc3(hidden))</span>

        <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># model.train()</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">hid_dim_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="c1">#hid_dim_range = [5,25]</span>
<span class="n">lr_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.001</span><span class="p">]</span>
<span class="c1">#lr_range = [0.75,0.5]</span>

<span class="c1">#Let&#39;s create a place to save these models, so we can</span>
<span class="n">path_to_save_models</span> <span class="o">=</span> <span class="s1">&#39;./models&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_to_save_models</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path_to_save_models</span><span class="p">)</span>

<span class="k">for</span> <span class="n">hid_dim</span> <span class="ow">in</span> <span class="n">hid_dim_range</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">lr</span> <span class="ow">in</span> <span class="n">lr_range</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">hid_dim: </span><span class="si">{}</span><span class="s1">, lr: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hid_dim</span><span class="p">,</span> <span class="n">lr</span><span class="p">))</span>
        <span class="k">if</span> <span class="s1">&#39;model&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deleting previous model&#39;</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">model</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">optimizer</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Feedforward</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">hid_dim</span><span class="p">)</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="p">)</span>
        <span class="c1">#optimizer = torch.optim.SGD(model.parameters(), lr = lr)</span>

        <span class="n">all_loss_train</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">all_loss_val</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="c1"># Forward pass</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">predictors_train</span><span class="p">)</span>
            <span class="c1"># Compute Loss</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_train</span><span class="p">)</span>

            <span class="c1"># Backward pass</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">all_loss_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

            <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">predictors_test</span><span class="p">)</span>
                <span class="c1"># Compute Loss</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_test</span><span class="p">)</span>
                <span class="n">all_loss_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

                <span class="k">if</span> <span class="n">epoch</span><span class="o">%</span><span class="k">100</span>==0:
                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
                    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch </span><span class="si">{}</span><span class="s1">, train_loss: </span><span class="si">{:.4f}</span><span class="s1">, val_loss: </span><span class="si">{:.4f}</span><span class="s1">, r_value: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span><span class="n">all_loss_train</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">all_loss_val</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">r_value</span><span class="p">))</span>

        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">all_loss_train</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">all_loss_val</span><span class="p">))</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;slope: </span><span class="si">{:.4f}</span><span class="s1">, r_value: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">r_value</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">name_to_save</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_save_models</span><span class="p">,</span><span class="s1">&#39;model_SGD_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_lr&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_hid_dim&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">hid_dim</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saving model to &#39;</span><span class="p">,</span> <span class="n">name_to_save</span><span class="p">)</span>
        <span class="n">model_state</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;epoch&#39;</span><span class="p">:</span> <span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;state_dict&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
                    <span class="s1">&#39;optimizer&#39;</span> <span class="p">:</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
            <span class="p">}</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model_state</span><span class="p">,</span> <span class="n">name_to_save</span> <span class="o">+</span><span class="s1">&#39;.pt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

hid_dim: 5, lr: 0.75
Deleting previous model
Epoch 0, train_loss: 0.2500, val_loss: 0.2500, r_value: -0.0655
Epoch 100, train_loss: 0.2500, val_loss: 0.2500, r_value: -0.0550
Epoch 200, train_loss: 0.2500, val_loss: 0.2500, r_value: -0.0469
Epoch 300, train_loss: 0.2500, val_loss: 0.2500, r_value: -0.0265
Epoch 400, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0578
Epoch 500, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0567
Epoch 600, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0626
Epoch 700, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0730
Epoch 800, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0885
Epoch 900, train_loss: 0.2499, val_loss: 0.2499, r_value: 0.1086
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.75_hid_dim5

hid_dim: 5, lr: 0.5
Deleting previous model
Epoch 0, train_loss: 0.2619, val_loss: 0.2595, r_value: -0.0813
Epoch 100, train_loss: 0.2500, val_loss: 0.2499, r_value: 0.0514
Epoch 200, train_loss: 0.2498, val_loss: 0.2498, r_value: 0.2299
Epoch 300, train_loss: 0.2496, val_loss: 0.2495, r_value: 0.3505
Epoch 400, train_loss: 0.2493, val_loss: 0.2492, r_value: 0.4086
Epoch 500, train_loss: 0.2488, val_loss: 0.2487, r_value: 0.4348
Epoch 600, train_loss: 0.2478, val_loss: 0.2478, r_value: 0.4476
Epoch 700, train_loss: 0.2459, val_loss: 0.2459, r_value: 0.4538
Epoch 800, train_loss: 0.2418, val_loss: 0.2417, r_value: 0.4563
Epoch 900, train_loss: 0.2334, val_loss: 0.2333, r_value: 0.4573
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_3.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.5_hid_dim5

hid_dim: 5, lr: 0.1
Deleting previous model
Epoch 0, train_loss: 0.2509, val_loss: 0.2508, r_value: -0.2765
Epoch 100, train_loss: 0.2507, val_loss: 0.2506, r_value: -0.2542
Epoch 200, train_loss: 0.2505, val_loss: 0.2505, r_value: -0.2279
Epoch 300, train_loss: 0.2504, val_loss: 0.2504, r_value: -0.1961
Epoch 400, train_loss: 0.2503, val_loss: 0.2503, r_value: -0.1570
Epoch 500, train_loss: 0.2502, val_loss: 0.2502, r_value: -0.1084
Epoch 600, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.0482
Epoch 700, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0248
Epoch 800, train_loss: 0.2499, val_loss: 0.2499, r_value: 0.1088
Epoch 900, train_loss: 0.2498, val_loss: 0.2498, r_value: 0.1972
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_5.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.1_hid_dim5

hid_dim: 5, lr: 0.01
Deleting previous model
Epoch 0, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2356
Epoch 100, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2371
Epoch 200, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2385
Epoch 300, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2400
Epoch 400, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2414
Epoch 500, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2428
Epoch 600, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2443
Epoch 700, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2457
Epoch 800, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2471
Epoch 900, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.2486
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_7.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.01_hid_dim5

hid_dim: 5, lr: 0.05
Deleting previous model
Epoch 0, train_loss: 0.2759, val_loss: 0.2749, r_value: 0.3544
Epoch 100, train_loss: 0.2512, val_loss: 0.2511, r_value: 0.3689
Epoch 200, train_loss: 0.2491, val_loss: 0.2491, r_value: 0.3788
Epoch 300, train_loss: 0.2489, val_loss: 0.2489, r_value: 0.3851
Epoch 400, train_loss: 0.2488, val_loss: 0.2489, r_value: 0.3897
Epoch 500, train_loss: 0.2488, val_loss: 0.2488, r_value: 0.3932
Epoch 600, train_loss: 0.2487, val_loss: 0.2487, r_value: 0.3962
Epoch 700, train_loss: 0.2486, val_loss: 0.2486, r_value: 0.3989
Epoch 800, train_loss: 0.2485, val_loss: 0.2486, r_value: 0.4013
Epoch 900, train_loss: 0.2484, val_loss: 0.2485, r_value: 0.4035
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_9.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_9.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.05_hid_dim5

hid_dim: 5, lr: 0.001
Deleting previous model
Epoch 0, train_loss: 0.2577, val_loss: 0.2574, r_value: -0.0997
Epoch 100, train_loss: 0.2573, val_loss: 0.2570, r_value: -0.0989
Epoch 200, train_loss: 0.2570, val_loss: 0.2567, r_value: -0.0981
Epoch 300, train_loss: 0.2566, val_loss: 0.2563, r_value: -0.0974
Epoch 400, train_loss: 0.2563, val_loss: 0.2560, r_value: -0.0967
Epoch 500, train_loss: 0.2560, val_loss: 0.2557, r_value: -0.0960
Epoch 600, train_loss: 0.2557, val_loss: 0.2554, r_value: -0.0953
Epoch 700, train_loss: 0.2554, val_loss: 0.2551, r_value: -0.0947
Epoch 800, train_loss: 0.2551, val_loss: 0.2548, r_value: -0.0940
Epoch 900, train_loss: 0.2548, val_loss: 0.2546, r_value: -0.0934
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_11.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_11.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.001_hid_dim5

hid_dim: 25, lr: 0.75
Deleting previous model
Epoch 0, train_loss: 0.2507, val_loss: 0.2501, r_value: -0.0051
Epoch 100, train_loss: 0.2493, val_loss: 0.2493, r_value: 0.3616
Epoch 200, train_loss: 0.2478, val_loss: 0.2478, r_value: 0.4514
Epoch 300, train_loss: 0.2432, val_loss: 0.2432, r_value: 0.4593
Epoch 400, train_loss: 0.2265, val_loss: 0.2265, r_value: 0.4595
Epoch 500, train_loss: 0.2008, val_loss: 0.2009, r_value: 0.4712
Epoch 600, train_loss: 0.1923, val_loss: 0.1918, r_value: 0.4889
Epoch 700, train_loss: 0.1891, val_loss: 0.1881, r_value: 0.5002
Epoch 800, train_loss: 0.1878, val_loss: 0.1865, r_value: 0.5055
Epoch 900, train_loss: 0.1872, val_loss: 0.1857, r_value: 0.5081
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_13.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_13.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.75_hid_dim25

hid_dim: 25, lr: 0.5
Deleting previous model
Epoch 0, train_loss: 0.2522, val_loss: 0.2507, r_value: 0.0599
Epoch 100, train_loss: 0.2484, val_loss: 0.2485, r_value: 0.3156
Epoch 200, train_loss: 0.2459, val_loss: 0.2459, r_value: 0.3704
Epoch 300, train_loss: 0.2403, val_loss: 0.2403, r_value: 0.4001
Epoch 400, train_loss: 0.2279, val_loss: 0.2278, r_value: 0.4253
Epoch 500, train_loss: 0.2112, val_loss: 0.2113, r_value: 0.4469
Epoch 600, train_loss: 0.2002, val_loss: 0.2002, r_value: 0.4655
Epoch 700, train_loss: 0.1947, val_loss: 0.1944, r_value: 0.4800
Epoch 800, train_loss: 0.1916, val_loss: 0.1910, r_value: 0.4905
Epoch 900, train_loss: 0.1898, val_loss: 0.1889, r_value: 0.4972
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_15.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_15.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.5_hid_dim25

hid_dim: 25, lr: 0.1
Deleting previous model
Epoch 0, train_loss: 0.2612, val_loss: 0.2596, r_value: 0.0976
Epoch 100, train_loss: 0.2499, val_loss: 0.2499, r_value: 0.1158
Epoch 200, train_loss: 0.2498, val_loss: 0.2498, r_value: 0.2804
Epoch 300, train_loss: 0.2497, val_loss: 0.2497, r_value: 0.3816
Epoch 400, train_loss: 0.2495, val_loss: 0.2495, r_value: 0.4285
Epoch 500, train_loss: 0.2494, val_loss: 0.2494, r_value: 0.4482
Epoch 600, train_loss: 0.2492, val_loss: 0.2492, r_value: 0.4562
Epoch 700, train_loss: 0.2491, val_loss: 0.2490, r_value: 0.4592
Epoch 800, train_loss: 0.2489, val_loss: 0.2489, r_value: 0.4600
Epoch 900, train_loss: 0.2487, val_loss: 0.2486, r_value: 0.4599
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_17.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_17.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.1_hid_dim25

hid_dim: 25, lr: 0.01
Deleting previous model
Epoch 0, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.4148
Epoch 100, train_loss: 0.2497, val_loss: 0.2497, r_value: 0.4202
Epoch 200, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.4252
Epoch 300, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.4293
Epoch 400, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.4325
Epoch 500, train_loss: 0.2495, val_loss: 0.2495, r_value: 0.4350
Epoch 600, train_loss: 0.2495, val_loss: 0.2495, r_value: 0.4369
Epoch 700, train_loss: 0.2494, val_loss: 0.2494, r_value: 0.4383
Epoch 800, train_loss: 0.2494, val_loss: 0.2494, r_value: 0.4395
Epoch 900, train_loss: 0.2494, val_loss: 0.2494, r_value: 0.4405
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_19.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_19.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.01_hid_dim25

hid_dim: 25, lr: 0.05
Deleting previous model
Epoch 0, train_loss: 0.2612, val_loss: 0.2606, r_value: -0.0994
Epoch 100, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0553
Epoch 200, train_loss: 0.2499, val_loss: 0.2499, r_value: 0.1630
Epoch 300, train_loss: 0.2499, val_loss: 0.2498, r_value: 0.2430
Epoch 400, train_loss: 0.2498, val_loss: 0.2498, r_value: 0.2966
Epoch 500, train_loss: 0.2497, val_loss: 0.2497, r_value: 0.3314
Epoch 600, train_loss: 0.2497, val_loss: 0.2497, r_value: 0.3543
Epoch 700, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.3696
Epoch 800, train_loss: 0.2495, val_loss: 0.2495, r_value: 0.3802
Epoch 900, train_loss: 0.2494, val_loss: 0.2494, r_value: 0.3878
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_21.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_21.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.05_hid_dim25

hid_dim: 25, lr: 0.001
Deleting previous model
Epoch 0, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4030
Epoch 100, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4026
Epoch 200, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4022
Epoch 300, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4018
Epoch 400, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4014
Epoch 500, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4010
Epoch 600, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4005
Epoch 700, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.4001
Epoch 800, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.3996
Epoch 900, train_loss: 0.2507, val_loss: 0.2507, r_value: -0.3991
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_23.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_23.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.001_hid_dim25

hid_dim: 50, lr: 0.75
Deleting previous model
Epoch 0, train_loss: 0.2531, val_loss: 0.2504, r_value: -0.0752
Epoch 100, train_loss: 0.2469, val_loss: 0.2469, r_value: 0.4293
Epoch 200, train_loss: 0.2362, val_loss: 0.2361, r_value: 0.4556
Epoch 300, train_loss: 0.2079, val_loss: 0.2078, r_value: 0.4704
Epoch 400, train_loss: 0.1939, val_loss: 0.1934, r_value: 0.4853
Epoch 500, train_loss: 0.1902, val_loss: 0.1893, r_value: 0.4959
Epoch 600, train_loss: 0.1885, val_loss: 0.1874, r_value: 0.5021
Epoch 700, train_loss: 0.1878, val_loss: 0.1864, r_value: 0.5053
Epoch 800, train_loss: 0.1874, val_loss: 0.1859, r_value: 0.5072
Epoch 900, train_loss: 0.1871, val_loss: 0.1855, r_value: 0.5084
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_25.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_25.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.75_hid_dim50

hid_dim: 50, lr: 0.5
Deleting previous model
Epoch 0, train_loss: 0.2646, val_loss: 0.2505, r_value: 0.1006
Epoch 100, train_loss: 0.2486, val_loss: 0.2486, r_value: 0.3606
Epoch 200, train_loss: 0.2462, val_loss: 0.2462, r_value: 0.3978
Epoch 300, train_loss: 0.2404, val_loss: 0.2405, r_value: 0.4165
Epoch 400, train_loss: 0.2270, val_loss: 0.2273, r_value: 0.4324
Epoch 500, train_loss: 0.2092, val_loss: 0.2096, r_value: 0.4482
Epoch 600, train_loss: 0.1990, val_loss: 0.1992, r_value: 0.4651
Epoch 700, train_loss: 0.1941, val_loss: 0.1939, r_value: 0.4801
Epoch 800, train_loss: 0.1913, val_loss: 0.1906, r_value: 0.4911
Epoch 900, train_loss: 0.1895, val_loss: 0.1885, r_value: 0.4982
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_27.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_27.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.5_hid_dim50

hid_dim: 50, lr: 0.1
Deleting previous model
Epoch 0, train_loss: 0.2510, val_loss: 0.2507, r_value: -0.0797
Epoch 100, train_loss: 0.2498, val_loss: 0.2498, r_value: 0.1198
Epoch 200, train_loss: 0.2495, val_loss: 0.2495, r_value: 0.2430
Epoch 300, train_loss: 0.2492, val_loss: 0.2492, r_value: 0.3108
Epoch 400, train_loss: 0.2489, val_loss: 0.2489, r_value: 0.3480
Epoch 500, train_loss: 0.2485, val_loss: 0.2485, r_value: 0.3698
Epoch 600, train_loss: 0.2481, val_loss: 0.2481, r_value: 0.3834
Epoch 700, train_loss: 0.2477, val_loss: 0.2477, r_value: 0.3926
Epoch 800, train_loss: 0.2471, val_loss: 0.2472, r_value: 0.3991
Epoch 900, train_loss: 0.2465, val_loss: 0.2466, r_value: 0.4042
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_29.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_29.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.1_hid_dim50

hid_dim: 50, lr: 0.01
Deleting previous model
Epoch 0, train_loss: 0.2583, val_loss: 0.2578, r_value: -0.2941
Epoch 100, train_loss: 0.2507, val_loss: 0.2506, r_value: -0.2481
Epoch 200, train_loss: 0.2504, val_loss: 0.2503, r_value: -0.2167
Epoch 300, train_loss: 0.2503, val_loss: 0.2503, r_value: -0.1844
Epoch 400, train_loss: 0.2502, val_loss: 0.2502, r_value: -0.1480
Epoch 500, train_loss: 0.2502, val_loss: 0.2501, r_value: -0.1065
Epoch 600, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.0603
Epoch 700, train_loss: 0.2500, val_loss: 0.2500, r_value: -0.0100
Epoch 800, train_loss: 0.2500, val_loss: 0.2500, r_value: 0.0430
Epoch 900, train_loss: 0.2499, val_loss: 0.2499, r_value: 0.0967
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_31.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_31.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.01_hid_dim50

hid_dim: 50, lr: 0.05
Deleting previous model
Epoch 0, train_loss: 0.2601, val_loss: 0.2584, r_value: -0.1342
Epoch 100, train_loss: 0.2499, val_loss: 0.2500, r_value: 0.1041
Epoch 200, train_loss: 0.2497, val_loss: 0.2497, r_value: 0.3417
Epoch 300, train_loss: 0.2495, val_loss: 0.2495, r_value: 0.3898
Epoch 400, train_loss: 0.2493, val_loss: 0.2493, r_value: 0.4041
Epoch 500, train_loss: 0.2491, val_loss: 0.2491, r_value: 0.4101
Epoch 600, train_loss: 0.2488, val_loss: 0.2489, r_value: 0.4132
Epoch 700, train_loss: 0.2486, val_loss: 0.2486, r_value: 0.4151
Epoch 800, train_loss: 0.2483, val_loss: 0.2484, r_value: 0.4165
Epoch 900, train_loss: 0.2481, val_loss: 0.2481, r_value: 0.4176
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_33.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_33.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.05_hid_dim50

hid_dim: 50, lr: 0.001
Deleting previous model
Epoch 0, train_loss: 0.2582, val_loss: 0.2579, r_value: 0.4330
Epoch 100, train_loss: 0.2559, val_loss: 0.2556, r_value: 0.4400
Epoch 200, train_loss: 0.2541, val_loss: 0.2539, r_value: 0.4456
Epoch 300, train_loss: 0.2528, val_loss: 0.2527, r_value: 0.4501
Epoch 400, train_loss: 0.2519, val_loss: 0.2518, r_value: 0.4537
Epoch 500, train_loss: 0.2513, val_loss: 0.2511, r_value: 0.4565
Epoch 600, train_loss: 0.2508, val_loss: 0.2507, r_value: 0.4588
Epoch 700, train_loss: 0.2504, val_loss: 0.2503, r_value: 0.4606
Epoch 800, train_loss: 0.2502, val_loss: 0.2501, r_value: 0.4620
Epoch 900, train_loss: 0.2500, val_loss: 0.2499, r_value: 0.4632
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_35.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_35.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.001_hid_dim50

hid_dim: 100, lr: 0.75
Deleting previous model
Epoch 0, train_loss: 0.2500, val_loss: 0.2502, r_value: 0.4543
Epoch 100, train_loss: 0.2573, val_loss: 0.2568, r_value: 0.4469
Epoch 200, train_loss: 0.2251, val_loss: 0.2245, r_value: 0.4513
Epoch 300, train_loss: 0.1965, val_loss: 0.1964, r_value: 0.4726
Epoch 400, train_loss: 0.1918, val_loss: 0.1912, r_value: 0.4883
Epoch 500, train_loss: 0.1897, val_loss: 0.1886, r_value: 0.4971
Epoch 600, train_loss: 0.1887, val_loss: 0.1873, r_value: 0.5017
Epoch 700, train_loss: 0.1882, val_loss: 0.1866, r_value: 0.5041
Epoch 800, train_loss: 0.1879, val_loss: 0.1862, r_value: 0.5057
Epoch 900, train_loss: 0.1876, val_loss: 0.1859, r_value: 0.5068
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_37.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_37.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.75_hid_dim100

hid_dim: 100, lr: 0.5
Deleting previous model
Epoch 0, train_loss: 0.2525, val_loss: 0.2511, r_value: -0.1845
Epoch 100, train_loss: 0.2471, val_loss: 0.2471, r_value: 0.4080
Epoch 200, train_loss: 0.2403, val_loss: 0.2406, r_value: 0.4059
Epoch 300, train_loss: 0.2252, val_loss: 0.2258, r_value: 0.4191
Epoch 400, train_loss: 0.2084, val_loss: 0.2092, r_value: 0.4386
Epoch 500, train_loss: 0.1995, val_loss: 0.2000, r_value: 0.4590
Epoch 600, train_loss: 0.1946, val_loss: 0.1946, r_value: 0.4767
Epoch 700, train_loss: 0.1916, val_loss: 0.1911, r_value: 0.4892
Epoch 800, train_loss: 0.1898, val_loss: 0.1888, r_value: 0.4970
Epoch 900, train_loss: 0.1887, val_loss: 0.1874, r_value: 0.5019
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_39.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_39.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.5_hid_dim100

hid_dim: 100, lr: 0.1
Deleting previous model
Epoch 0, train_loss: 0.2532, val_loss: 0.2514, r_value: -0.0951
Epoch 100, train_loss: 0.2494, val_loss: 0.2494, r_value: 0.3980
Epoch 200, train_loss: 0.2486, val_loss: 0.2487, r_value: 0.4343
Epoch 300, train_loss: 0.2479, val_loss: 0.2479, r_value: 0.4409
Epoch 400, train_loss: 0.2470, val_loss: 0.2470, r_value: 0.4432
Epoch 500, train_loss: 0.2459, val_loss: 0.2460, r_value: 0.4445
Epoch 600, train_loss: 0.2447, val_loss: 0.2448, r_value: 0.4456
Epoch 700, train_loss: 0.2432, val_loss: 0.2433, r_value: 0.4466
Epoch 800, train_loss: 0.2414, val_loss: 0.2415, r_value: 0.4477
Epoch 900, train_loss: 0.2392, val_loss: 0.2393, r_value: 0.4488
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_41.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_41.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.1_hid_dim100

hid_dim: 100, lr: 0.01
Deleting previous model
Epoch 0, train_loss: 0.2545, val_loss: 0.2540, r_value: -0.2149
Epoch 100, train_loss: 0.2503, val_loss: 0.2503, r_value: -0.1830
Epoch 200, train_loss: 0.2502, val_loss: 0.2502, r_value: -0.1324
Epoch 300, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.0792
Epoch 400, train_loss: 0.2500, val_loss: 0.2500, r_value: -0.0261
Epoch 500, train_loss: 0.2499, val_loss: 0.2500, r_value: 0.0248
Epoch 600, train_loss: 0.2499, val_loss: 0.2499, r_value: 0.0720
Epoch 700, train_loss: 0.2498, val_loss: 0.2498, r_value: 0.1146
Epoch 800, train_loss: 0.2497, val_loss: 0.2497, r_value: 0.1522
Epoch 900, train_loss: 0.2496, val_loss: 0.2496, r_value: 0.1849
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_43.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_43.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.01_hid_dim100

hid_dim: 100, lr: 0.05
Deleting previous model
Epoch 0, train_loss: 0.2529, val_loss: 0.2521, r_value: 0.0654
Epoch 100, train_loss: 0.2495, val_loss: 0.2496, r_value: 0.1986
Epoch 200, train_loss: 0.2492, val_loss: 0.2493, r_value: 0.2893
Epoch 300, train_loss: 0.2489, val_loss: 0.2490, r_value: 0.3439
Epoch 400, train_loss: 0.2486, val_loss: 0.2486, r_value: 0.3765
Epoch 500, train_loss: 0.2482, val_loss: 0.2483, r_value: 0.3967
Epoch 600, train_loss: 0.2479, val_loss: 0.2479, r_value: 0.4098
Epoch 700, train_loss: 0.2475, val_loss: 0.2475, r_value: 0.4185
Epoch 800, train_loss: 0.2470, val_loss: 0.2471, r_value: 0.4247
Epoch 900, train_loss: 0.2466, val_loss: 0.2467, r_value: 0.4291
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_45.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_45.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.05_hid_dim100

hid_dim: 100, lr: 0.001
Deleting previous model
Epoch 0, train_loss: 0.2505, val_loss: 0.2504, r_value: -0.2423
Epoch 100, train_loss: 0.2503, val_loss: 0.2502, r_value: -0.2270
Epoch 200, train_loss: 0.2502, val_loss: 0.2502, r_value: -0.2116
Epoch 300, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.1962
Epoch 400, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.1806
Epoch 500, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.1648
Epoch 600, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.1485
Epoch 700, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.1316
Epoch 800, train_loss: 0.2501, val_loss: 0.2501, r_value: -0.1142
Epoch 900, train_loss: 0.2501, val_loss: 0.2500, r_value: -0.0960
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_47.png" src="../../_images/STUDENTSPROJECTS_Proj_2022_Matera_Modeling_debris_flow_source_areas_Txomin_Bornaetxea_154_47.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model to  ./models/model_SGD_1000_lr0.001_hid_dim100
</pre></div></div>
</div>
<section id="ML-Perceptron-CONCLUSIONS">
<h3><span class="section-number">2.6.5.1. </span>ML Perceptron CONCLUSIONS<a class="headerlink" href="#ML-Perceptron-CONCLUSIONS" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p>Highest r_value Performance: 0.5084 with hid_dim: 50, lr: 0.75</p></li>
<li><p>In general the best results are obtained with the highest Learning Rate, i.e. 0.75</p></li>
<li><p>Maybe increasing the number of Epochs can be benefitial?</p></li>
</ul>
</section>
</section>
<section id="GENERAL-CONCLUSIONS">
<h2><span class="section-number">2.6.6. </span><strong>GENERAL CONCLUSIONS</strong><a class="headerlink" href="#GENERAL-CONCLUSIONS" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>The modeling results are not good <strong>BUT !</strong></p></li>
<li><p>It is highly dependent on the input data.</p></li>
<li><p>The quality of the input data for this experiment are not too much.</p></li>
</ul>
<p>At least I have learned <strong>A LOT</strong> about: * How to manage spatial data using Python commands such as <strong>PyGeo</strong> and <strong>Rasterio</strong>. * How to generate statistical models * which are the key parameter to be considered during the generation of the model * How to translate these models into the final maps</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Distributionof_Fresh_water_Biodiversity_AcrossCuba_Yusdiel_Torres.html" class="btn btn-neutral float-left" title="2.5. Yusdiel Torres-Cambas: Distribution of freshwater biodiversity across Cuba" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Prediction_of_AGB_using_RFR_SVR_FFNN_Ritwika_Mukhopadhyay.html" class="btn btn-neutral float-right" title="2.7. Ritwika Mukhopadhyay: Comparative Analysis of the prediction of AGB using Random Forest Regression, Support Vector Machine for Regression &amp; FeedForward Neural Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Giuseppe Amatulli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>