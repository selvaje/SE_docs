

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.3. Observed and simulated internal variability climate feedbacks comparison. &mdash; Spatial Ecology&#39;s code documentation 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.4. Statistical comparison global gridded climate datasets and their influence on LPJ-GUESS model outputs" href="Alexandra_Pongr%C3%A1cz_project_idea.html" />
    <link rel="prev" title="1.2. Compiling OTB from source" href="Farzad_VahidiMayamey_sw2021_b.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Spatial Ecology's code documentation
              <img src="../../_static/SE_compact.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">COURSE TRAINERS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../COURSETRAINERS/trainers.html">Spatial Ecology course trainers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">COURSES AROUND THE WORLD</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_wcsu_02-04_2021.html">Western Connecticut State University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_stock_uni_04-05_2021.html">Stockholm University 2021</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2022.html">GeoComp &amp; ML 2022 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_modelling_10-11_2022.html">GeoComp &amp; Modelling 2022 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2023.html">GeoComp &amp; ML 2023 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_ml_04-05_2024.html">GeoComp &amp; ML 2024 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_GEO-OPEN-HACK-2024_06_2024.html">GEO-OPEN-HACK-2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_11-12_2024.html">GeoComp 2024 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_geoanlysis_04_2025.html">Geo Comp/Analysis 2025 course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COURSESAROUNDTHEWORLD/course_geocomp_ml_09-11_2025.html">GeoComp &amp; ML 2025 course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GEO DATA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GEODATA/geomorpho90m/geomorpho90m.html">Geomorpho90m: technical documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LINUX VIRTUAL MACHINE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_Ubuntu24.04_for_Spatial_Ecology_course.html">Prepare Ubuntu 24.04 for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_Colab_for_Spatial_Ecology_course.html">Prepare Colab for Spatial Ecology courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VIRTUALMACHINE/Setting_OSGeoLive_for_Spatial_Ecology_course.html">Prepare OSGeoLive for Spatial Ecology courses</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WEB SEMINARS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html">Raster/Vector Processing using GDAL/OGR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#image-processing-using-pktools">Image Processing using Pktools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#introduction-to-grass-gis">Introduction to GRASS GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WEBSEMINAR/webseminar.html#geocomputation-with-high-performance-computing">GeoComputation with High Performance Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">BASH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashintro_osgeo.html">Linux Operation System as a base for Spatial Ecology Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashinter_osgeo.html">Manipulate text files in bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BASH/bashxargs_osgeo.html">Multi-core bash</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AWK</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AWK/awk.html">AWK Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GDAL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GDAL/gdal_osgeo.html">Use GDAL/OGR for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GDAL/gdal_colab.html">Use GDAL/OGR for raster/vector operations - colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PKTOOLS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pktools_osgeo.html">Use PKTOOLS for raster/vector operations - osgeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pktools_colab.html">Use PKTOOLS for raster/vector operations - colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_introduction1.html">Introduction to pyjeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_introduction2.html">pyjeo: an open source image processing library in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_pktools.html">Performing raster and vector operations in Python using pyjeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PKTOOLS/pyjeo_upscaling_surf.html">Scaling-up: batch processing on the cluster with pyjeo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../R/R_Intro.html">R Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PYTHON</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/PythonEnvs.html">Python environments or how to survive to your journey in the geodata space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Python_Intro.html">Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Geo_Python.html">Python &amp; GeoComputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Python_data_analysis_SM.html">Python data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/Python_geospatial_data_analysis_SM.html">Python geospatial data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/RasterIO_Intro.html">RasterIO for dummies: a brief intro to a <em>pythonic</em> raster library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/RasterIO_Intro.html#2.-Preparing-the-dataset-for-next-ML-exercises-via-rasterio">2. Preparing the dataset for next ML exercises via rasterio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/RasterIO_Intro.html#3.-Beyond-the-basics">3. Beyond the basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PYTHON/OGCSQL.html">Generalities about OGC Geospatial extensions for SQL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GRASS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_intro.html">GRASS Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_newproject.html">Start a new GRASS project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_hydro.html">Using GRASS for stream-network extraction and basins delineation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/grass_hydro_colab.html">Using GRASS for stream-network extraction and basins delineation in Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/SDM1_MWood_gecomp4GRASS.html">SDM1 : Montane woodcreper - Gecomputation for the Random Forest model using GRASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRASS/SDM1_MWood_GRASSmodel.html">SDM1 : Montane woodcreper - Random Forest Model using GRASS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">HIGH PERFORMANCE COMPUTING</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HPC/hpc_setting.html">Geocomputation at High Performance Computing Cluster (HPC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HPC/hpc_setting_grass.html">Use of GRASS in HPC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASSIGNMENTS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASSIGNMENTS/assignment_fall2022_solutions.html">Assignments Fall 2022</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CASE STUDY</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_gecomp.html">SDM1 : Montane woodcreper - Gecomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_Rmodel.html">SDM1 : Montane woodcreper - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_gecomp4GRASS.html">SDM1 : Montane woodcreper - Gecomputation for the Random Forest model using GRASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM1_MWood_GRASSmodel.html">SDM1 : Montane woodcreper - Random Forest Model using GRASS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/SDM2_Vath_Rmodel.html">SDM2 : Varied Thrush - Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/manipulate_GSIM.html">Manipulate GSIM files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Data_type_GTiff.html">Data type in GTiff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/temporal_interpolation.html">Temporal interpolation of landsat images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/DTW.html">Dynamic Time Warping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/pred_NP.html">Estimating nitrogen and phosphorus concentrations in streams and rivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day1.html">Estimating nitrogen concentrations in streams and rivers using NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day2.html">Autoencoder (AE), Variational Autoencoder (VAE) and Generative Adversarial Network (GAN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN-day3.html">LSTM Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_01DataExplore.html">Estimation of tree height using GEDI dataset - Data explore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_02Predictors_extraction.html">Estimation of tree height using GEDI dataset - Predictors extraction at point location</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_03RF_pred.html">Estimation of tree height using GEDI dataset - Random Forest prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04SVM_pred_2022.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR) - 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04SVM_pred_2023.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR) - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04SVM_pred_2024.html">Estimation of tree height using GEDI dataset - Support Vector Machine for Regression (SVR) - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_04SVM_pred_2024.html#Exercise:-explore-the-other-parameters-offered-by-the-SVM-library-and-try-to-make-the-model-better.-Some-suggestions:">Exercise: explore the other parameters offered by the SVM library and try to make the model better. Some suggestions:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_05Perceptron_pred_2022.html">Estimation of tree height using GEDI dataset - Perceptron 1 - 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_05Perceptron_intro_2023.html">Estimation of tree height using GEDI dataset - Perceptron 1 - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_05Perceptron_intro_2024.html">Estimation of tree height using GEDI dataset - Perceptron - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_06Perceptron_pred_2023.html">Estimation of tree height using GEDI dataset - Perceptron tree prediction - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_06Perceptron_complete_2024.html">Estimation of tree height using GEDI dataset - Perceptron complete - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_05Perceptron_pred_clean_2022.html">Estimation of tree height using GEDI dataset - Clean Data - Perceptron 2 - 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_06NeuralNets_pred.html">Estimation of tree height using GEDI dataset - Neural Network 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Tree_Height_07FeedForward_Networks_2024.html">Estimation of tree height using GEDI dataset - Neural Network 1 - 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NNs_pt3_SHAP.html">Neural Nets (pt.3), Interpretability and Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/CNN_satelite_2022.html">Using Multi-layer Perceptron and Convolutional Neural Networks for Satellite image classification - 2022.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/CNN_satelite_2023.html">Using Multi-layer Perceptron and Convolutional Neural Networks for Satellite image classification - 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/CNN_satelite_2023.html#Using-CNNs-for-a-image-dataset">Using CNNs for a image dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/foundation_model_IIASA2024.html">Prithvi 100M model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/foundation_model_IIASA2024.html#Proposed-exercises">Proposed exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN_Unsupervised_2024.html">Autoencoder (AE), Variational Autoencoder (VAE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN_Unsupervised_2024.html#Implementing-an-Autoencoder">Implementing an Autoencoder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN_Unsupervised_2024.html#Autoencoding-MNIST">Autoencoding MNIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN_Unsupervised_2024.html#Section-2">Section 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/NN_Unsupervised_2024.html#Section-3---Generative-Models">Section 3 - Generative Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/LSTMs_tutorial.html">Using LSTM for time-series predictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/CNN_satelite_with_GPT_code_2023.html">Using GPT to implement a Convolutional Neural Networks for Satellite image classification.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/Classification_pyjeo_sklearn_2023.html">Classification in Python using pyjeo and sklearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CASESTUDY/GEEviaPython_2023.html">Google Earth Engine use via Python, containers and other mythical beasts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Students Projects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. 2021 SWEDEN</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Farzad_VahidiMayamey_sw2021_a.html">1.1. Calculating landcover distribution &amp; vegetation extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Farzad_VahidiMayamey_sw2021_b.html">1.2. Compiling OTB from source</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.3. Observed and simulated internal variability climate feedbacks comparison.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Project-description">1.3.1. 1. Project description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Data-set-and-Methods">1.3.2. 2. Data set and Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.1-Data">1.3.3. 2.1 Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.1.1-Observations">1.3.4. 2.1.1 Observations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.1.2-Simulations">1.3.5. 2.1.2 Simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.2-Methods">1.3.6. 2.2 Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.2.1-Preprocessing">1.3.7. 2.2.1 Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bash-script-to-preprocess-observations-(detrend-and-deseasonalize)">1.3.8. Bash script to preprocess observations (detrend and deseasonalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bash-script-to-preprocess-simulations-CMIP6-historical-(detrend-and-deseasonalize)">1.3.9. Bash script to preprocess simulations CMIP6 historical (detrend and deseasonalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bash-script-to-preprocess-simulations-AMIP-(detrend-and-deseasonalize)">1.3.10. Bash script to preprocess simulations AMIP (detrend and deseasonalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bash-script-to-preprocess-simulations-CMIP6-piControl-and-Abrupt">1.3.11. Bash script to preprocess simulations CMIP6 piControl and Abrupt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.2.2-Feedbacks">1.3.12. 2.2.2 Feedbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Results">1.3.13. 3. Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.1-Observed-feedbacks">1.3.14. 3.1 Observed feedbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.2-Simulated-feeedbacks">1.3.15. 3.2 Simulated feeedbacks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Alexandra_Pongr%C3%A1cz_project_idea.html">1.4. Statistical comparison global gridded climate datasets and their influence on LPJ-GUESS model outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Carlos_G%C3%B3mez-Ortiz_GeocomputationProject.html">1.5. Emulating FLEXPART with a Multi-Layer Perceptron</a></li>
<li class="toctree-l2"><a class="reference internal" href="Felicity_Alice_Holmes_Geocomp_project.html">1.6. Processing Elmer/Ice output</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hamm_Alexandra_final_project.html">1.7. pan-Arctic classified slope and aspect maps (Geo computation only)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Jacopo_Cantoni_SeasonAnalisis.html">1.8. Seasonal Analisis of discharges in the Mälaren catchement.</a></li>
<li class="toctree-l2"><a class="reference internal" href="Julia_Wagner_Geocomputation.html">1.9. Mapping of soil organic carbon stocks with Random Forest</a></li>
<li class="toctree-l2"><a class="reference internal" href="Kap%C3%A1s_Roz%C3%A1lia_project.html">1.10. NDVI Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="SaeidAminjafariProject.html">1.11. Phase Change Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tatiana_Klisho_project.html">1.12. Relationship between continental-scale patterns of fire activity and modes of climate variability</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#matera">2. 2022 MATERA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OUTDOOR</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OUTDOOR/outdoor_orientering.html">Do not get lost in the wilderness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OUTDOOR/outdoor_info.html">Shelter locations close to Gioia del Colle (BA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OUTDOOR/bike_accomodation.html">Accomodation in Gioia del Colle (BA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OUTDOOR/puglia_discover.html">Discover Puglia by bike!</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TALKS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TALKS/intelligent_modelling.html">Intelligent modelling in time and space: combine GeoComputation and Machine Learning for  environmental application.</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADMIN</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/00_pktools_gdrive_install.html">Install pktools on the gdrive and be able to use from any Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/video.html">Video tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ADMIN/Compiling_OTB.html">Compiling OTB from source</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Spatial Ecology's code documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">1. </span>2021 SWEDEN</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1.3. </span>Observed and simulated internal variability climate feedbacks comparison.</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/STUDENTSPROJECTS/Proj_2021_SW/Alejandro_Uribe_Geo_comp_pro_AU.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Observed-and-simulated-internal-variability-climate-feedbacks-comparison.">
<h1><span class="section-number">1.3. </span>Observed and simulated internal variability climate feedbacks comparison.<a class="headerlink" href="#Observed-and-simulated-internal-variability-climate-feedbacks-comparison." title="Link to this heading"></a></h1>
<p>Geocomputation and Machine learning</p>
<p>Alejandro Uribe</p>
<section id="1.-Project-description">
<h2><span class="section-number">1.3.1. </span>1. Project description<a class="headerlink" href="#1.-Project-description" title="Link to this heading"></a></h2>
<p>In the presence of radiative forcings (<span class="math notranslate nohighlight">\(F\)</span>), the climate system reestablishes its energy balance by increasing the mean global temperature (<span class="math notranslate nohighlight">\(T\)</span>). This increase of temperature produces secondary forcing fluxes which are proportional to the initial response (<span class="math notranslate nohighlight">\(\lambda T\)</span>). The additional feedback fluxes are added to the initial forcing, leading to a final response (Lindzen et al, 2001). Examples of such a mechanism are cloud feedbacks; clouds are important in the energetic balance
of the earth since they both reflect shortwave radiation coming from the sun back to space and longwave to the surface. For example, if high cloud cover from deep convective clouds in the tropics decreases with warming (Iris effect), more longwave would escape to space (negative longwave feedback), but if stratocumulus clouds from shallow convection in the subtropics decrease more shortwave would reach the surface (positive shortwave feedback).</p>
<p>A typical approach to quantify the feedback mechanism is to consider the planetary energy balance at the top of the atmosphere (TOA), represented as:</p>
<p><span class="math">\begin{equation}\label{R}\tag{1}
R=F+\lambda T
\end{equation}</span></p>
<p>where <span class="math notranslate nohighlight">\(R\)</span> is the net TOA radiative flux anomaly, <span class="math notranslate nohighlight">\(\lambda\)</span> is the radiative feedback parameter and <span class="math notranslate nohighlight">\(T\)</span> is the global mean surface air temperature anomaly (Zelinka et al, 2020). Generally, to diagnose climate feedbacks, <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are estimated using coupled ocean-atmosphere General Circulation Models (GCM’s) in which atmospheric concentrations of carbon dioxide are abruptly quadruplet from their preindustrial concentration and held fixed. However, those diagnosed
feedbacks are not easily comparable with observations and thus their validity is uncertain.</p>
<p>In this project, I used a different approach in which, instead of utilizing <span class="math notranslate nohighlight">\(CO_2\)</span> forcings, I estimated the feedback parameter produced by climate variations over time resulting from natural causes (internal variability) using observations. Similar ideas have been used before (Mauritsen &amp; Stevens, 2015 for example); however, their approach focussed particularly on the tropics and the extent of their observational dataset is small compared to today. As the second step in this project, I
diagnosed the same feedbacks from a set of model simulations of historical climate from the last generation of the Coupled Model Intercomparison Project (CMIP6) and compared them with those from observations. Finally, I wondered about potential relations between simulated feedbacks due to natural variability and <span class="math notranslate nohighlight">\(CO_2\)</span> forcings. This project is framed within the GeoCompuation component of the lecture.</p>
</section>
<section id="2.-Data-set-and-Methods">
<h2><span class="section-number">1.3.2. </span>2. Data set and Methods<a class="headerlink" href="#2.-Data-set-and-Methods" title="Link to this heading"></a></h2>
</section>
<section id="2.1-Data">
<h2><span class="section-number">1.3.3. </span>2.1 Data<a class="headerlink" href="#2.1-Data" title="Link to this heading"></a></h2>
<p>Diagnosis of internal variability feedbacks were produced using observations, whereas simulated feedbacks from model simulations. The data description is as follows.</p>
</section>
<section id="2.1.1-Observations">
<h2><span class="section-number">1.3.4. </span>2.1.1 Observations<a class="headerlink" href="#2.1.1-Observations" title="Link to this heading"></a></h2>
<p>To estimate observed internal variability feedbacks and cloud properties, I used:</p>
<ul class="simple">
<li><p>TOA shortwave and longwave fluxes (clear sky and all sky) at monthly in 1° × 1° regions from satellite data of the Clouds and the Earth’s Radiant Energy System (CERES) instruments and “Energy Balanced and Filled” (EBAF) updated to version Ed4.1.</p></li>
<li><p>Cloud properties stratified by cloud optical depth and pressure from CERES-MODIS/VIIRS and GEO.</p></li>
<li><p>Gridded temperatuere anolimalies datase from the latest version of HadCRUT(5) analysis</p></li>
</ul>
<p>Observations were obtained from <a class="reference external" href="https://ceres.larc.nasa.gov/data/">https://ceres.larc.nasa.gov/data/</a> and <a class="reference external" href="https://crudata.uea.ac.uk/cru/data/temperature/">https://crudata.uea.ac.uk/cru/data/temperature/</a>, respectvely.</p>
</section>
<section id="2.1.2-Simulations">
<h2><span class="section-number">1.3.5. </span>2.1.2 Simulations<a class="headerlink" href="#2.1.2-Simulations" title="Link to this heading"></a></h2>
<p>To estimate simulated internal variability feedbacks, I used TOA shortwave and longwave fluxes (clear sky (CS) and all sky) and air temperature from historical simulations of global coupled climate models produced for the sixth phase of Coupled Model Intercomparison Project (CMIP) and Atmospheric Model Intercomparison Project (AMIP) (Table 1.). In these simulations, boundary conditions (e.g irradiation, aerosols, orbital parameters, and green house concentration in the atmosphere) represent
those estimated for the historical period starting in 1850 and ending in 2014 (Fiedler et al, 2020).</p>
<p>To investigate if the simulated internal variability feedbacks relate to simulated <span class="math notranslate nohighlight">\(CO_2\)</span> forcing feedbacks, I used outputs from CMIP6 in which atmospheric <span class="math notranslate nohighlight">\(CO_2\)</span> concentrations were abruptly quadruplet from their preindustrial concentration and held fixed (abrupt-4xCO2) (Zelinka et al 2020).</p>
<p>All simulated data was downloaded from the Deutsches KlimaRechenZentrum (DKRZ) data repository, using the DKRZ CMIP data pool (<a class="reference external" href="https://www.dkrz.de/up/services/data-management/cmip-data-pool">https://www.dkrz.de/up/services/data-management/cmip-data-pool</a>). I constrained both observational and simulations datasets to their overlaping period, 2001 to 2014. Finally, Cloud Radiative Effects (CRE - the amount of energy that would return to space if there were no clouds, minus the amount that escapes with clouds present.) fluxes were calculated in both observations
and simulations by substracting CS from all-sky fluxes.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>CMIP6 historical</p></th>
<th class="head"><p>AMIP</p></th>
<th class="head"><p>abrupt-4xCO2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ACCESS-CM2</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>ACCESS-ESM1-5</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>AWI-CM-1-1-MR</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AWI-ESM-1-1-LR</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>BCC-CSM2-MR</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>CAMS-CSM1-0</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>CanESM5</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CESM2</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>CESM2-FV2</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>CESM2-WACCM</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>CESM2-WACCM-FV2</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>CMCC-CM2-HR4</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CMCC-CM2-SR5</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>CMCC-ESM2</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>FGOALS-g3</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>GISS-E2-1-G</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>GISS-E2-1-G-CC</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>GISS-E2-1-H</p></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>IITM-ESM</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>MIROC6</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>MPI-ESM-1-2-HAM</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>MPI-ESM1-2-HR</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>MPI-ESM1-2-LR</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>MRI-ESM2-0</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-even"><td><p>NESM3</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>NorCPM1</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>NorESM2-LM</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>NorESM2-MM</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>SAM0-UNICON</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
</tr>
<tr class="row-odd"><td><p>TaiESM1</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>BCC-ESM</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
</tr>
</tbody>
</table>
<p><em>Table 1. Models used.</em></p>
</section>
<section id="2.2-Methods">
<h2><span class="section-number">1.3.6. </span>2.2 Methods<a class="headerlink" href="#2.2-Methods" title="Link to this heading"></a></h2>
</section>
<section id="2.2.1-Preprocessing">
<h2><span class="section-number">1.3.7. </span>2.2.1 Preprocessing<a class="headerlink" href="#2.2.1-Preprocessing" title="Link to this heading"></a></h2>
<p>Figure 1. shows the global mean temperature anomaly time series from 1850 to 2021 (even though the period extension is larger than the one I used to diagnose internal variability feedbacks, it helps us to visualize the most important fluctuations in the time series as example). The large time scale positive trend (red line) is related to anthropogenic warming and thus is does not belong to internal variability. On the othere side, the high-frequency oscillation is a print of seasonality. Both
trends do not correspond to monthly climate variability and thus it is important to remove them before performing the feedbacks diagnosis. To that end, I used Climate Data Operators (CDO) within a bash pre-analysis script as showed in the cell after the figure.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">input_data</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">DATA</span><span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;HadCRUT/HadCRUT.5.0.1.0.analysis.anomalies.ensemble_mean.nc&#39;</span><span class="p">)</span>
<span class="c1">#os.system(&#39;cdo -trend -fldmean &#39;+input_data+&#39;HadCRUT/HadCRUT.5.0.1.0.analysis.anomalies.ensemble_mean.nc afile.nc bfile.nc&#39;)</span>
<span class="n">a</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;afile.nc&#39;</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;bfile.nc&#39;</span><span class="p">)</span>
<span class="n">trend</span><span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">tas_mean</span><span class="o">.</span><span class="n">values</span><span class="o">+</span><span class="n">b</span><span class="o">.</span><span class="n">tas_mean</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DATA</span><span class="o">.</span><span class="n">time</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DATA</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">trend</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;trend&#39;</span><span class="p">)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">DATA</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
<span class="n">DATA</span><span class="o">.</span><span class="n">tas_mean</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Anomaly [K]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [Year]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">DATA</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">DATA</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;T_timeseries.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_15_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_15_0.png" />
</div>
</div>
<p><em>Figure 1. Global mean temperature anomaly time series. Values were weighted by the cosine of their latitude before taking the mean. Trend is displayed as the red line.</em></p>
</section>
<section id="Bash-script-to-preprocess-observations-(detrend-and-deseasonalize)">
<h2><span class="section-number">1.3.8. </span>Bash script to preprocess observations (detrend and deseasonalize)<a class="headerlink" href="#Bash-script-to-preprocess-observations-(detrend-and-deseasonalize)" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> observations_preprocessing.sh

<span class="c1">#!/bin/bash</span>
<span class="c1">##################################################################</span>
<span class="c1">#                           1. HadCRUT                           #</span>
<span class="c1">##################################################################</span>

<span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/HadCRUT/&#39;</span>

<span class="c1">######### Selecting overlaping period ######################################</span>

<span class="n">cdo</span> <span class="n">selyear</span><span class="p">,</span><span class="mi">2001</span><span class="o">/</span><span class="mi">2014</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">anomalies</span><span class="o">.</span><span class="n">ensemble_mean</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span>

<span class="c1">######### Removing seasonality #############################################</span>

<span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">ymonmean</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span>

<span class="c1">######### Removing trend ###################################################</span>

<span class="n">cdo</span> <span class="o">-</span><span class="n">detrend</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">detre_desea_HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span>

<span class="c1">######### Removing temporary files #########################################</span>

<span class="n">rm</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_HadCRUT</span><span class="mf">.5.0.1.0</span><span class="o">.</span><span class="n">mean_2001_2014_mon</span><span class="o">.</span><span class="n">nc</span>

<span class="c1">##################################################################</span>
<span class="c1">#                           2. CERES                             #</span>
<span class="c1">##################################################################</span>

<span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/CERES/&#39;</span>

<span class="c1">######### Selecting overlaping period ######################################</span>

<span class="n">cdo</span> <span class="n">selyear</span><span class="p">,</span><span class="mi">2001</span><span class="o">/</span><span class="mi">2014</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CERES_EBAF_Ed4</span><span class="mf">.1</span><span class="n">_Subset_200101</span><span class="o">-</span><span class="mf">201912.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CERES_EBAF</span><span class="o">-</span><span class="n">TOA_Ed4</span><span class="mf">.1</span><span class="n">_Subset_2001</span><span class="o">-</span><span class="mf">2014.</span><span class="n">nc</span>

<span class="c1">######### Calculating anomalies ############################################</span>

<span class="n">cdo</span> <span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CERES_EBAF</span><span class="o">-</span><span class="n">TOA_Ed4</span><span class="mf">.1</span><span class="n">_Subset_2001</span><span class="o">-</span><span class="mf">2014.</span><span class="n">nc</span> <span class="o">-</span><span class="n">timmean</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CERES_EBAF</span><span class="o">-</span><span class="n">TOA_Ed4</span><span class="mf">.1</span><span class="n">_Subset_2001</span><span class="o">-</span><span class="mf">2014.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">flux_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span>

<span class="c1">######### Removing seasonality #############################################</span>

<span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">flux_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="o">-</span><span class="n">ymonmean</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">flux_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_flux_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span>

<span class="c1">######### Removing trend ###################################################</span>

<span class="n">cdo</span> <span class="o">-</span><span class="n">detrend</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_flux_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">tmp</span><span class="o">.</span><span class="n">nc</span>

<span class="c1">##################################################################</span>
<span class="c1">#                2. Cloud properties                             #</span>
<span class="c1">##################################################################</span>

<span class="c1"># TOP quantitites</span>

<span class="c1">######### Calculating anomalies ############################################</span>

<span class="n">cdo</span> <span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CERES_CldTypHist</span><span class="o">-</span><span class="n">MON_GEO</span><span class="o">-</span><span class="n">MODIS_Ed4</span><span class="mf">.1</span><span class="n">_Subset_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="o">-</span><span class="n">timmean</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CERES_CldTypHist</span><span class="o">-</span><span class="n">MON_GEO</span><span class="o">-</span><span class="n">MODIS_Ed4</span><span class="mf">.1</span><span class="n">_Subset_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span>

<span class="c1">######### Removing seasonality #############################################</span>

<span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="o">-</span><span class="n">ymonmean</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span>

<span class="c1">######### Removing trend ###################################################</span>

<span class="n">cdo</span> <span class="o">-</span><span class="n">detrend</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">detre_desea_CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span>

<span class="c1">######### Removing temporary files #########################################</span>

<span class="n">rm</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">desea_CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="n">CldTypHist_anom_200101</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overwriting observations_preprocessing.sh
</pre></div></div>
</div>
</section>
<section id="Bash-script-to-preprocess-simulations-CMIP6-historical-(detrend-and-deseasonalize)">
<h2><span class="section-number">1.3.9. </span>Bash script to preprocess simulations CMIP6 historical (detrend and deseasonalize)<a class="headerlink" href="#Bash-script-to-preprocess-simulations-CMIP6-historical-(detrend-and-deseasonalize)" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> models_historical_preprocessing.sh
<span class="ch">#!/bin/bash</span>
<span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/CMIP6_historical/&#39;</span>
<span class="nb">input</span><span class="o">=</span><span class="s2">&quot;models&quot;</span>
<span class="k">while</span> <span class="n">IFS</span><span class="o">=</span> <span class="n">read</span> <span class="o">-</span><span class="n">r</span> <span class="n">line</span>
<span class="n">do</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">rlut_</span> <span class="n">rlutcs_</span> <span class="n">rsut_</span> <span class="n">rsutcs_</span> <span class="n">ts_</span>
    <span class="n">do</span>
            <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">CMIP6_historical</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span>
            <span class="n">dir_out</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">CMIP6_historical</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span>
        <span class="n">rm</span> <span class="err">$</span><span class="p">{</span><span class="n">dir_out</span><span class="p">}</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span>
            <span class="k">if</span> <span class="n">test</span> <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;$</span><span class="si">{dir_out}</span><span class="s2">/$</span><span class="si">{var}</span><span class="s2">2001_2014.nc&quot;</span>
            <span class="n">then</span>
                    <span class="n">echo</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mi">185001</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="s1">&#39;exist!&#39;</span>
            <span class="k">else</span>
                    <span class="n">cd</span> <span class="err">$</span><span class="p">{</span><span class="n">dir_out</span><span class="p">}</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">selyear</span><span class="p">,</span><span class="mi">2001</span><span class="o">/</span><span class="mi">2014</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mi">185001</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span> <span class="o">-</span><span class="n">timmean</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">ymonmean</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">seasons</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">seasons</span><span class="o">.</span><span class="n">nc</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">detrend</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="n">detre_desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">rm</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">seasons</span><span class="o">.</span><span class="n">nc</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">echo</span> <span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="s1">&#39;Created!&#39;</span>
            <span class="n">fi</span>
    <span class="n">done</span>
<span class="n">done</span> <span class="o">&lt;</span> <span class="s2">&quot;$input&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overwriting models_historical_preprocessing.sh
</pre></div></div>
</div>
</section>
<section id="Bash-script-to-preprocess-simulations-AMIP-(detrend-and-deseasonalize)">
<h2><span class="section-number">1.3.10. </span>Bash script to preprocess simulations AMIP (detrend and deseasonalize)<a class="headerlink" href="#Bash-script-to-preprocess-simulations-AMIP-(detrend-and-deseasonalize)" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> models_amip_preprocessing.sh
<span class="ch">#!/bin/bash</span>
<span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/down_amip/&#39;</span>
<span class="nb">input</span><span class="o">=</span><span class="s2">&quot;models_amip&quot;</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">AMIP_alejandro</span>
<span class="k">while</span> <span class="n">IFS</span><span class="o">=</span> <span class="n">read</span> <span class="o">-</span><span class="n">r</span> <span class="n">line</span>
<span class="n">do</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">rlut_</span> <span class="n">rlutcs_</span> <span class="n">rsut_</span> <span class="n">rsutcs_</span> <span class="n">ts_</span>
    <span class="n">do</span>
            <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">AMIP</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span>
            <span class="n">dir_out</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">AMIP</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">test</span> <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;$</span><span class="si">{dir_out}</span><span class="s2">/$</span><span class="si">{var}</span><span class="s2">2001_2014.nc&quot;</span>
            <span class="n">then</span>
                    <span class="n">echo</span> <span class="n">detre_desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="s1">&#39;exist!&#39;</span>
            <span class="k">else</span>
                    <span class="n">cd</span> <span class="err">$</span><span class="p">{</span><span class="n">dir_out</span><span class="p">}</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">selyear</span><span class="p">,</span><span class="mi">2001</span><span class="o">/</span><span class="mi">2014</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mi">197901</span><span class="o">-</span><span class="mf">201412.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span> <span class="o">-</span><span class="n">timmean</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="mf">2001_2014.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">ymonmean</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">seasons</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">sub</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">seasons</span><span class="o">.</span><span class="n">nc</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">cdo</span> <span class="o">-</span><span class="n">detrend</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="n">detre_desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">rm</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">seasons</span><span class="o">.</span><span class="n">nc</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span>
                    <span class="n">echo</span> <span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span> <span class="n">desea_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="n">anom</span><span class="o">.</span><span class="n">nc</span> <span class="s1">&#39;Created!&#39;</span>
            <span class="n">fi</span>
    <span class="n">done</span>
<span class="n">done</span> <span class="o">&lt;</span> <span class="s2">&quot;$input&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overwriting models_amip_preprocessing.sh
</pre></div></div>
</div>
</section>
<section id="Bash-script-to-preprocess-simulations-CMIP6-piControl-and-Abrupt">
<h2><span class="section-number">1.3.11. </span>Bash script to preprocess simulations CMIP6 piControl and Abrupt<a class="headerlink" href="#Bash-script-to-preprocess-simulations-CMIP6-piControl-and-Abrupt" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> models_pi_ab_preprocessing.sh
<span class="ch">#!/bin/bash</span>
<span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/CMIP6_piControl-Abrupt/&#39;</span>
<span class="nb">input</span><span class="o">=</span><span class="s2">&quot;models_pi_ab&quot;</span>
<span class="k">while</span> <span class="n">IFS</span><span class="o">=</span> <span class="n">read</span> <span class="o">-</span><span class="n">r</span> <span class="n">line</span>
<span class="n">do</span>
    <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">abrupt</span><span class="o">-</span><span class="mi">4</span><span class="n">xCO2</span> <span class="n">piControl</span>
    <span class="n">do</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">rlut_</span> <span class="n">rlutcs_</span> <span class="n">rsut_</span> <span class="n">rsutcs_</span> <span class="n">ts_</span>
            <span class="n">do</span>
                    <span class="n">mkdir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">CMIP6_piControl</span><span class="o">-</span><span class="n">Abrupt_ale</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span>
                    <span class="n">dir_out</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">alejandro</span><span class="o">/</span><span class="n">CL_feedbacks</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">CMIP6_piControl</span><span class="o">-</span><span class="n">Abrupt_ale</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span>
                    <span class="k">if</span> <span class="n">test</span> <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;$</span><span class="si">{dir_out}</span><span class="s2">/ymean_$</span><span class="si">{var}</span><span class="s2">$</span><span class="si">{exp}</span><span class="s2">.nc&quot;</span>
                    <span class="n">then</span>
                            <span class="n">echo</span> <span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="err">$</span><span class="p">{</span><span class="n">exp</span><span class="p">}</span><span class="o">.</span><span class="n">nc</span> <span class="s1">&#39;exist!&#39;</span>
                    <span class="k">else</span>
                            <span class="n">cd</span> <span class="err">$</span><span class="p">{</span><span class="nb">dir</span><span class="p">}</span><span class="err">$</span><span class="p">{</span><span class="n">line</span><span class="p">}</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">exp</span><span class="p">}</span>
                            <span class="n">cdo</span> <span class="o">-</span><span class="n">yearmean</span> <span class="err">$</span><span class="p">{</span><span class="n">dir_out</span><span class="p">}</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="err">$</span><span class="p">{</span><span class="n">exp</span><span class="p">}</span><span class="o">.</span><span class="n">nc</span> <span class="err">$</span><span class="p">{</span><span class="n">dir_out</span><span class="p">}</span><span class="o">/</span><span class="n">ymean_</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="err">$</span><span class="p">{</span><span class="n">exp</span><span class="p">}</span><span class="o">.</span><span class="n">nc</span>
                            <span class="n">rm</span> <span class="err">$</span><span class="p">{</span><span class="n">dir_out</span><span class="p">}</span><span class="o">/</span><span class="err">$</span><span class="p">{</span><span class="n">var</span><span class="p">}</span><span class="err">$</span><span class="p">{</span><span class="n">exp</span><span class="p">}</span><span class="o">.</span><span class="n">nc</span> <span class="c1"># remove later</span>
                    <span class="n">fi</span>
            <span class="n">done</span>
    <span class="n">done</span>
<span class="n">done</span> <span class="o">&lt;</span> <span class="s2">&quot;$input&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overwriting models_pi_ab_preprocessing.sh
</pre></div></div>
</div>
<p>Figure 2. shows an example of the deseasonalized and detrended data to diagnose the feedbacks for the overlaping period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">input_data</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">DATA</span><span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;HadCRUT/detre_desea_HadCRUT.5.0.1.0.mean_2001_2014_mon.nc&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">DATA</span><span class="o">.</span><span class="n">tas_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Anomaly [K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;T_timeseries_detre_desea.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_26_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_26_0.png" />
</div>
</div>
<p><em>Figure 2. Global mean detrended and deseasonalized air temperature anomaly time series. Values were weighted by the cosine of their latitude before taking the mean.</em></p>
<p>To verify if the resulting data is in reality related to internal climate variability, I decided to decomposed the signal of the radiation fluxes and compared it with the sign of El Niño South Oscillation (ENSO), which perhaps is the most relevant sample of internal variability. To do that, I extracted the principal component (PC) of the leading mode of the empirical orthogonal functions (EOF’s) of the global mean time series of TOA shortwave and longwave anomalies and compared it with sea
surface temperature anomalies in the region NINO 3.4. The high correlation between shortwave and longwave with El NINO 3.4 index indicates that the preprocessing filters produced internal variability data (Figure 3).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">eofs.xarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">Eof</span>
<span class="n">DATA_tmp</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;HadCRUT/detre_desea_HadCRUT.5.0.1.0.mean_2001_2014_mon.nc&#39;</span><span class="p">)</span>
<span class="n">DATA_flux</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;CERES/detre_desea_flux_anom_200101-201412.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#LW</span>
<span class="n">lw_flux</span><span class="o">=</span><span class="n">DATA_flux</span><span class="o">.</span><span class="n">toa_lw_all_mon</span>
<span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">DATA_flux</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">wgts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">coslat</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">Eof</span><span class="p">(</span><span class="n">lw_flux</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">wgts</span><span class="p">)</span>
<span class="n">eof_flux_lw</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofsAsCorrelation</span><span class="p">(</span><span class="n">neofs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pc_flux_lw</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">pcs</span><span class="p">(</span><span class="n">npcs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pcscaling</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">var_lw</span><span class="o">=</span><span class="n">solver</span><span class="o">.</span><span class="n">varianceFraction</span><span class="p">(</span><span class="n">neigs</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="c1">#SW</span>
<span class="n">sw_flux</span><span class="o">=</span><span class="n">DATA_flux</span><span class="o">.</span><span class="n">toa_sw_all_mon</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">Eof</span><span class="p">(</span><span class="n">sw_flux</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">wgts</span><span class="p">)</span>
<span class="n">eof_flux_sw</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofsAsCorrelation</span><span class="p">(</span><span class="n">neofs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pc_flux_sw</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">pcs</span><span class="p">(</span><span class="n">npcs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pcscaling</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">var_sw</span><span class="o">=</span><span class="n">solver</span><span class="o">.</span><span class="n">varianceFraction</span><span class="p">(</span><span class="n">neigs</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="c1"># Anomalies NINO 3.4</span>
<span class="n">sst_anom</span><span class="o">=</span><span class="n">DATA_tmp</span><span class="o">.</span><span class="n">tas_mean</span>
<span class="n">sst_anom_34</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">120</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">R_LW</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sst_anom_34</span><span class="p">,</span><span class="n">pc_flux_lw</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R_SW</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sst_anom_34</span><span class="p">,</span><span class="n">pc_flux_sw</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sst_anom_34</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nino 3.4&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">pc_flux_lw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">sst_anom_34</span><span class="o">.</span><span class="n">time</span>
<span class="n">pc_flux_lw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;LW flux, R=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R_LW</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">pc_flux_sw</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">sst_anom_34</span><span class="o">.</span><span class="n">time</span>
<span class="n">pc_flux_sw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SW flux, R=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R_SW</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;PC_1EOF.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_29_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_29_0.png" />
</div>
</div>
<p><em>Figure 3. PC of leading EOF of TOA fluxes and SST anomalies Niño 3.4.</em></p>
</section>
<section id="2.2.2-Feedbacks">
<h2><span class="section-number">1.3.12. </span>2.2.2 Feedbacks<a class="headerlink" href="#2.2.2-Feedbacks" title="Link to this heading"></a></h2>
<p>Shortwave and longwave feedbacks were calculated from both observations and simulations using the linear regression coefficients between radiative fluxes anomalies and air temperature anomalies (equation 3 and 4). The following cell shows the python function used for that purpose, including the 95% confidence interval.</p>
<p><span class="math">\begin{equation}\label{Rl}\tag{2}
R_L=F_L+\lambda_LT
\end{equation}</span></p>
<p><span class="math">\begin{equation}\label{Rs}\tag{3}
R_S=F_S+\lambda_ST
\end{equation}</span></p>
<p>where the subindexes <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(S\)</span> indicate longwave and shortwave, respectively.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span> <span class="n">y_values</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">sst_mean</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y_values</span><span class="o">.</span><span class="n">values</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
    <span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="c1"># Confidence intervals</span>
    <span class="n">IC</span><span class="o">=</span><span class="n">fitted</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="n">fitted</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">IC</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Instead of diagnosing global feedbacks, I decided to take a different approach. First, I divided the globe into “boxes” of 10° latitudinal width from 90°S to 90°N. Then, I calculated the feedbacks within each box and the mean feedback between the hemispherical equivalent boxes. I applied this methodology to differentiate potential feedbacks behaviors from the tropics to the poles.</p>
<p>This method requires the calculation of 18 feedback-boxes for 2 radiative fluxes in observations times 30 models from CMIP6 and 23 models in AMIP for a total of 990 regressions. The process was repeated for clear sky, all-sky, and cloud radiative effects fluxes for a final total of 2970 regressions. To that end, the following python code was applied to produce npz files with NumPy arrays containing the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> feedbacks.py
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">output</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="n">North</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">South</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">full</span><span class="o">=</span><span class="p">[</span><span class="n">North</span><span class="p">,</span><span class="n">South</span><span class="p">]</span>
<span class="k">for</span> <span class="n">Hem</span> <span class="ow">in</span> <span class="n">full</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Hem</span> <span class="o">==</span> <span class="n">North</span><span class="p">):</span>
        <span class="n">upp</span><span class="o">=</span><span class="mi">10</span>
        <span class="n">H</span><span class="o">=</span><span class="s1">&#39;North&#39;</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Hem</span> <span class="o">==</span> <span class="n">South</span><span class="p">):</span>
        <span class="n">upp</span><span class="o">=-</span><span class="mi">10</span>
        <span class="n">H</span><span class="o">=</span><span class="s1">&#39;South&#39;</span>
    <span class="k">for</span> <span class="n">rad</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="s1">&#39;cs&#39;</span><span class="p">,</span><span class="s1">&#39;cre&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">rad</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">IR</span><span class="o">=</span><span class="s1">&#39;rlut&#39;</span>
            <span class="n">IR_obs</span><span class="o">=</span><span class="s1">&#39;toa_lw_all_mon&#39;</span>
            <span class="n">SR</span><span class="o">=</span><span class="s1">&#39;rsut&#39;</span>
            <span class="n">SR_obs</span><span class="o">=</span><span class="s1">&#39;toa_sw_all_mon&#39;</span>
        <span class="k">elif</span> <span class="n">rad</span><span class="o">==</span><span class="s1">&#39;cs&#39;</span><span class="p">:</span>
            <span class="n">IR</span><span class="o">=</span><span class="s1">&#39;rlutcs&#39;</span>
            <span class="n">IR_obs</span><span class="o">=</span><span class="s1">&#39;toa_lw_clr_c_mon&#39;</span>
            <span class="n">SR</span><span class="o">=</span><span class="s1">&#39;rsutcs&#39;</span>
            <span class="n">SR_obs</span><span class="o">=</span><span class="s1">&#39;toa_sw_clr_c_mon&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">IR</span><span class="o">=</span><span class="s1">&#39;rlutcre&#39;</span>
            <span class="n">IR_obs</span><span class="o">=</span><span class="s1">&#39;toa_lw_cre_mon&#39;</span>
            <span class="n">SR</span><span class="o">=</span><span class="s1">&#39;rsutcre&#39;</span>
            <span class="n">SR_obs</span><span class="o">=</span><span class="s1">&#39;toa_sw_cre_mon&#39;</span>
        <span class="n">savez_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">domain</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">)):</span>
            <span class="n">feed_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">feed_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
            <span class="n">top_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
            <span class="n">bot_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
            <span class="n">top_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
            <span class="n">bot_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Hem</span><span class="p">):</span>
                <span class="c1">#-----------------------------------------------------------------</span>
                <span class="c1">#------------------------ OBS ------------------------------------</span>
                <span class="c1">#-----------------------------------------------------------------</span>
                <span class="n">DATA_sst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="s1">&#39;HadCRUT/detre_desea_HadCRUT.5.0.1.0.mean_2001_2014_mon.nc&#39;</span><span class="p">)</span>
                <span class="n">sst_anom</span><span class="o">=</span><span class="n">DATA_sst</span><span class="o">.</span><span class="n">tas_mean</span>
                <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">DATA_sst</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
                <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                <span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Local&#39;</span><span class="p">:</span>
                    <span class="n">sst_anom</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
                    <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                <span class="n">sst_mean</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">DATA_flux</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="s1">&#39;CERES/detre_desea_flux_anom_200101-201412.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">sw_flux</span><span class="o">=</span><span class="n">DATA_flux</span><span class="p">[</span><span class="n">SR_obs</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sw_flux</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
                <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                <span class="n">lw_flux</span><span class="o">=</span><span class="n">DATA_flux</span><span class="p">[</span><span class="n">IR_obs</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                <span class="c1">#</span>
                <span class="n">sw_mean</span><span class="o">=</span><span class="n">sw_flux</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                <span class="n">lw_mean</span><span class="o">=</span><span class="n">lw_flux</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                <span class="c1">#------------------------ SW FLUX ------------------------------------</span>
                <span class="n">m_sw</span><span class="p">,</span><span class="n">sw_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="o">-</span><span class="n">sw_mean</span><span class="p">)</span>
                <span class="n">bot_sw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sw_IC</span><span class="p">)</span>
                <span class="n">top_sw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sw_IC</span><span class="p">)</span>
                <span class="n">feed_sw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_sw</span>
                <span class="c1">#------------------------ LW FLUX ------------------------------------</span>
                <span class="n">m_lw</span><span class="p">,</span><span class="n">lw_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="o">-</span><span class="n">lw_mean</span><span class="p">)</span>
                <span class="n">bot_lw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lw_IC</span><span class="p">)</span>
                <span class="n">top_lw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lw_IC</span><span class="p">)</span>
                <span class="n">feed_lw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_lw</span>
            <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;feed_lw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">feed_lw</span>
            <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_lw_IC</span>
            <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_lw_IC</span>
            <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;feed_sw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">feed_sw</span>
            <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_sw_IC</span>
            <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_sw_IC</span>
            <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="p">((</span><span class="s1">&#39;CMIP6_historical&#39;</span><span class="p">,</span><span class="s1">&#39;AMIP&#39;</span><span class="p">,</span><span class="s1">&#39;CMIP6_4xCO2&#39;</span><span class="p">)):</span>
                    <span class="n">models</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">):</span>
                        <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span><span class="o">+</span><span class="n">exp</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
                    <span class="n">mean_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mean_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_sw</span><span class="p">)</span>
                    <span class="n">mod_m_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mod_m_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mod_lw_IC_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mod_sw_IC_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mod_lw_IC_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mod_sw_IC_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">)</span>
                    <span class="n">mean_mod_lw</span><span class="o">=</span><span class="p">[]</span>
                    <span class="n">mean_mod_sw</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
                        <span class="c1">#-----------------------------------------------------------------</span>
                        <span class="c1">#------------------------ MODELS ---------------------------------</span>
                        <span class="c1">#-----------------------------------------------------------------</span>
                        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Hem</span><span class="p">):</span>
                            <span class="n">LW</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/detre_desea_&#39;</span><span class="o">+</span><span class="n">IR</span><span class="o">+</span><span class="s1">&#39;_anom.nc&#39;</span><span class="p">)</span>
                            <span class="n">rlut</span><span class="o">=</span><span class="n">LW</span><span class="p">[</span><span class="n">IR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cre&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                            <span class="n">weights_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">rlut</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
                            <span class="n">weights_mod</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                            <span class="n">rlut</span><span class="o">=</span><span class="n">rlut</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                            <span class="n">SW</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/detre_desea_&#39;</span><span class="o">+</span><span class="n">SR</span><span class="o">+</span><span class="s1">&#39;_anom.nc&#39;</span><span class="p">)</span>
                            <span class="n">rsut</span><span class="o">=</span><span class="n">SW</span><span class="p">[</span><span class="n">SR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cre&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                            <span class="n">rsut</span><span class="o">=</span><span class="n">rsut</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                            <span class="n">TS</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/detre_desea_ts_anom.nc&#39;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Global&#39;</span><span class="p">:</span>
                                    <span class="n">weights_glob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">TS</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
                                    <span class="n">weights_glob</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                                    <span class="n">ts</span><span class="o">=</span><span class="n">TS</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_glob</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                                <span class="c1">#------------------------ SW FLUX ------------------------------------</span>
                                <span class="n">m_sw</span><span class="p">,</span><span class="n">sw_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="o">-</span><span class="n">rsut</span><span class="p">)</span>
                                <span class="n">mod_m_sw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_sw</span>
                                <span class="n">mod_sw_IC_min</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sw_IC</span><span class="p">)</span>
                                <span class="n">mod_sw_IC_max</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sw_IC</span><span class="p">)</span>
                                <span class="c1">#------------------------ LW FLUX ------------------------------------</span>
                                <span class="n">m_lw</span><span class="p">,</span><span class="n">lw_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="o">-</span><span class="n">rlut</span><span class="p">)</span>
                                <span class="n">mod_m_lw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_lw</span>
                                <span class="n">mod_lw_IC_min</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lw_IC</span><span class="p">)</span>
                                <span class="n">mod_lw_IC_max</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lw_IC</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">LW_pi</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/ymean_&#39;</span><span class="o">+</span><span class="n">IR</span><span class="o">+</span><span class="s1">&#39;_piControl.nc&#39;</span><span class="p">,</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
                                <span class="n">LW_ab</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/ymean_&#39;</span><span class="o">+</span><span class="n">IR</span><span class="o">+</span><span class="s1">&#39;_abrupt-4xCO2.nc&#39;</span><span class="p">,</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
                                <span class="n">rlut_pi</span><span class="o">=</span><span class="n">LW_pi</span><span class="p">[</span><span class="n">IR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cre&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                                <span class="n">rlut_ab</span><span class="o">=</span><span class="n">LW_ab</span><span class="p">[</span><span class="n">IR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cre&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                                <span class="n">weights_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">rlut_pi</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
                                <span class="n">weights_mod</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                                <span class="n">rlut</span><span class="o">=</span><span class="n">rlut_ab</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span><span class="o">-</span><span class="n">rlut_pi</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                                <span class="n">SW_pi</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/ymean_&#39;</span><span class="o">+</span><span class="n">SR</span><span class="o">+</span><span class="s1">&#39;_piControl.nc&#39;</span><span class="p">,</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
                                <span class="n">SW_ab</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/ymean_&#39;</span><span class="o">+</span><span class="n">SR</span><span class="o">+</span><span class="s1">&#39;_abrupt-4xCO2.nc&#39;</span><span class="p">,</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
                                <span class="n">rsut_pi</span><span class="o">=</span><span class="n">SW_pi</span><span class="p">[</span><span class="n">SR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cre&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                                <span class="n">rsut_ab</span><span class="o">=</span><span class="n">SW_ab</span><span class="p">[</span><span class="n">SR</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cre&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                                <span class="n">rsut</span><span class="o">=</span><span class="n">rsut_ab</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span><span class="o">-</span><span class="n">rsut_pi</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                                <span class="n">TS_pi</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/ymean_ts_piControl.nc&#39;</span><span class="p">,</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
                                <span class="n">TS_ab</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;/ymean_ts_abrupt-4xCO2.nc&#39;</span><span class="p">,</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="mi">150</span><span class="p">))</span>
                                <span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Global&#39;</span><span class="p">:</span>
                                    <span class="n">weights_glob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">TS_pi</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
                                    <span class="n">weights_glob</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
                                    <span class="n">ts</span><span class="o">=</span><span class="n">TS_ab</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_glob</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span><span class="o">-</span><span class="n">TS_pi</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_glob</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">ts_pi</span><span class="o">=</span><span class="n">TS_pi</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                                    <span class="n">ts_ab</span><span class="o">=</span><span class="n">TS_ab</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                                    <span class="n">ts</span><span class="o">=</span><span class="n">ts_ab</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span><span class="o">-</span><span class="n">ts_pi</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_mod</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
                                <span class="c1">#------------------------ SW FLUX ------------------------------------</span>
                                <span class="n">m_sw</span><span class="p">,</span><span class="n">sw_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="o">-</span><span class="n">rsut</span><span class="p">)</span>
                                <span class="n">mod_m_sw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_sw</span>
                                <span class="n">mod_sw_IC_min</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sw_IC</span><span class="p">)</span>
                                <span class="n">mod_sw_IC_max</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sw_IC</span><span class="p">)</span>
                                <span class="c1">#------------------------ LW FLUX ------------------------------------</span>
                                <span class="n">m_lw</span><span class="p">,</span><span class="n">lw_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="o">-</span><span class="n">rlut</span><span class="p">)</span>
                                <span class="n">mod_m_lw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_lw</span>
                                <span class="n">mod_lw_IC_min</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lw_IC</span><span class="p">)</span>
                                <span class="n">mod_lw_IC_max</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lw_IC</span><span class="p">)</span>
                        <span class="n">mean_mod_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_m_lw</span><span class="p">))</span>
                        <span class="n">mean_mod_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_m_sw</span><span class="p">))</span>
                        <span class="n">savez_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_m_lw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_m_lw</span><span class="p">)</span>
                        <span class="n">savez_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_lw_IC_min_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_lw_IC_min</span><span class="p">)</span>
                        <span class="n">savez_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_lw_IC_max_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_lw_IC_max</span><span class="p">)</span>
                        <span class="n">savez_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_m_sw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_m_sw</span><span class="p">)</span>
                        <span class="n">savez_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_sw_IC_min_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_sw_IC_min</span><span class="p">)</span>
                        <span class="n">savez_dict</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_sw_IC_max_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mod_sw_IC_max</span><span class="p">)</span>
                    <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;mean_mod_lw_&#39;</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_mod_lw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;mean_mod_sw_&#39;</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_mod_sw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="s1">&#39;Feed_Ftropics_&#39;</span><span class="o">+</span><span class="n">rad</span><span class="o">+</span><span class="s1">&#39;_NOSI_NOI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">savez_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing feedbacks.py
</pre></div></div>
</div>
<p>Additionally, changes in observed cloud cover, optical depth, cloud top height, and cloud top temperature anomalies with air temperature were calculated to understand the feedbacks results. Those changes were estimated using the same regression function with the following scripts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> optical_properties.py
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">output</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="n">North</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">South</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">full</span><span class="o">=</span><span class="p">[</span><span class="n">North</span><span class="p">,</span><span class="n">South</span><span class="p">]</span>
<span class="n">savez_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">domain</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">)):</span>
    <span class="n">North</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">South</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">full</span><span class="o">=</span><span class="p">[</span><span class="n">North</span><span class="p">,</span><span class="n">South</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">Hem</span> <span class="ow">in</span> <span class="n">full</span><span class="p">:</span>
        <span class="n">reg_clda</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">reg_cldt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_clda</span><span class="p">)</span>
        <span class="n">top_clda_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_clda</span><span class="p">)</span>
        <span class="n">bot_clda_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_clda</span><span class="p">)</span>
        <span class="n">top_cldt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_clda</span><span class="p">)</span>
        <span class="n">bot_cldt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_clda</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Hem</span><span class="p">):</span>
            <span class="c1">#print(i,i-10)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Hem</span> <span class="o">==</span> <span class="n">North</span><span class="p">):</span>
                <span class="n">upp</span><span class="o">=</span><span class="mi">10</span>
                <span class="n">H</span><span class="o">=</span><span class="s1">&#39;North&#39;</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Hem</span> <span class="o">==</span> <span class="n">South</span><span class="p">):</span>
                <span class="n">upp</span><span class="o">=-</span><span class="mi">10</span>
                <span class="n">H</span><span class="o">=</span><span class="s1">&#39;South&#39;</span>
            <span class="c1">#-----------------------------------------------------------------</span>
            <span class="c1">#------------------------ OBS ------------------------------------</span>
            <span class="c1">#-----------------------------------------------------------------</span>
            <span class="n">DATA_sst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="s1">&#39;HadCRUT/detre_desea_HadCRUT.5.0.1.0.mean_2001_2014_mon.nc&#39;</span><span class="p">)</span>
            <span class="n">sst_anom</span><span class="o">=</span><span class="n">DATA_sst</span><span class="o">.</span><span class="n">tas_mean</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">DATA_sst</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
            <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
            <span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Local&#39;</span><span class="p">:</span>
                <span class="n">sst_anom</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
                <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
            <span class="n">sst_mean</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">DATA</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="s1">&#39;CERES/detre_desea_flux_anom_200101-201412.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">C_area</span><span class="o">=</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;cldarea_total_daynight_mon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">C_area</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
            <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
            <span class="n">C_tau</span><span class="o">=</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;cldtau_total_day_mon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>       <span class="c1">#</span>
            <span class="n">cld_area</span><span class="o">=</span><span class="n">C_area</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
            <span class="n">cld_tau</span><span class="o">=</span><span class="n">C_tau</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
            <span class="c1">#------------------------ Cloud area FLUX ----------------------------</span>
            <span class="n">m_clda</span><span class="p">,</span><span class="n">clda_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="n">cld_area</span><span class="p">)</span>
            <span class="n">bot_clda_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">clda_IC</span><span class="p">)</span>
            <span class="n">top_clda_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">clda_IC</span><span class="p">)</span>
            <span class="n">reg_clda</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_clda</span>
            <span class="c1">#------------------------ Cloud thickness FLUX -----------------------</span>
            <span class="n">m_cldt</span><span class="p">,</span><span class="n">cldt_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="n">cld_tau</span><span class="p">)</span>
            <span class="n">bot_cldt_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cldt_IC</span><span class="p">)</span>
            <span class="n">top_cldt_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cldt_IC</span><span class="p">)</span>
            <span class="n">reg_cldt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_cldt</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;reg_clda_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_clda</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_clda_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_clda_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_clda_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_clda_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;reg_cldt_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_cldt</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_cldt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_cldt_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_cldt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_cldt_IC</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="s1">&#39;optical_Ftropics_NOI_NOSI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">savez_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing optical_properties.py
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> Height_temperature.py
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">output</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="n">North</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">South</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="n">full</span><span class="o">=</span><span class="p">[</span><span class="n">North</span><span class="p">,</span><span class="n">South</span><span class="p">]</span>
<span class="n">savez_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">domain</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span><span class="s1">&#39;Local&#39;</span><span class="p">)):</span>
    <span class="n">North</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">South</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">full</span><span class="o">=</span><span class="p">[</span><span class="n">North</span><span class="p">,</span><span class="n">South</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">Hem</span> <span class="ow">in</span> <span class="n">full</span><span class="p">:</span>
        <span class="n">reg_cth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">top_cth_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">bot_cth_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">reg_cod</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">top_cod_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">bot_cod_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">reg_ctt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">top_ctt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="n">bot_ctt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">reg_cth</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Hem</span><span class="p">):</span>
            <span class="c1">#print(i,i-10)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Hem</span> <span class="o">==</span> <span class="n">North</span><span class="p">):</span>
                <span class="n">upp</span><span class="o">=</span><span class="mi">10</span>
                <span class="n">H</span><span class="o">=</span><span class="s1">&#39;North&#39;</span>
            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Hem</span> <span class="o">==</span> <span class="n">South</span><span class="p">):</span>
                <span class="n">upp</span><span class="o">=-</span><span class="mi">10</span>
                <span class="n">H</span><span class="o">=</span><span class="s1">&#39;South&#39;</span>
            <span class="c1">#-----------------------------------------------------------------</span>
            <span class="c1">#------------------------ OBS ------------------------------------</span>
            <span class="c1">#-----------------------------------------------------------------</span>
            <span class="n">DATA_sst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="s1">&#39;HadCRUT/detre_desea_HadCRUT.5.0.1.0.mean_2001_2014_mon.nc&#39;</span><span class="p">)</span>
            <span class="n">sst_anom</span><span class="o">=</span><span class="n">DATA_sst</span><span class="o">.</span><span class="n">tas_mean</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">DATA_sst</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
            <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
            <span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Local&#39;</span><span class="p">:</span>
                <span class="n">sst_anom</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
                <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
                <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
            <span class="n">sst_mean</span><span class="o">=</span><span class="n">sst_anom</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="s1">&#39;longitude&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">DATA</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="s1">&#39;CERES/detre_desea_CldTypHist_anom_200101-201412.nc&#39;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">cth</span><span class="o">=</span><span class="n">DATA</span><span class="o">.</span><span class="n">cldtyp_cldhght_top_tot_daynite_mon</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">cth</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
            <span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>
            <span class="n">cod</span><span class="o">=</span><span class="n">DATA</span><span class="o">.</span><span class="n">cldtyp_cldtau_tot_daynite_mon</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
            <span class="n">ctt</span><span class="o">=</span><span class="n">DATA</span><span class="o">.</span><span class="n">cldtyp_cldtemp_top_tot_daynite_mon</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">upp</span><span class="p">)))</span>
            <span class="n">cth</span><span class="o">=</span><span class="n">cth</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
            <span class="n">cod</span><span class="o">=</span><span class="n">cod</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
            <span class="n">ctt</span><span class="o">=</span><span class="n">ctt</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">))</span>
            <span class="c1">#------------------------  ----------------------------</span>
            <span class="n">m_cth</span><span class="p">,</span><span class="n">cth_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="n">cth</span><span class="p">)</span>
            <span class="n">bot_cth_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cth_IC</span><span class="p">)</span>
            <span class="n">top_cth_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cth_IC</span><span class="p">)</span>
            <span class="n">reg_cth</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_cth</span>
            <span class="c1">#------------------------  ----------------------------</span>
            <span class="n">m_cod</span><span class="p">,</span><span class="n">cod_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="n">cod</span><span class="p">)</span>
            <span class="n">bot_cod_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cod_IC</span><span class="p">)</span>
            <span class="n">top_cod_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">cod_IC</span><span class="p">)</span>
            <span class="n">reg_cod</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_cod</span>
            <span class="c1">#------------------------  ----------------------------</span>
            <span class="n">m_ctt</span><span class="p">,</span><span class="n">ctt_IC</span><span class="o">=</span><span class="n">regression</span><span class="p">(</span><span class="n">sst_mean</span><span class="p">,</span><span class="n">ctt</span><span class="p">)</span>
            <span class="n">bot_ctt_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ctt_IC</span><span class="p">)</span>
            <span class="n">top_ctt_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ctt_IC</span><span class="p">)</span>
            <span class="n">reg_ctt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">m_ctt</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;reg_cth_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_cth</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_cth_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_cth_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_cth_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_cth_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;reg_cod_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_cod</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_cod_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_cod_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_cod_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_cod_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;reg_ctt_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_ctt</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;top_ctt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_ctt_IC</span>
        <span class="n">savez_dict</span><span class="p">[</span><span class="s1">&#39;bot_ctt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_ctt_IC</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">output</span><span class="o">+</span><span class="s1">&#39;CTH_NOSI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">savez_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Writing Height_temperature.py
</pre></div></div>
</div>
</section>
<section id="3.-Results">
<h2><span class="section-number">1.3.13. </span>3. Results<a class="headerlink" href="#3.-Results" title="Link to this heading"></a></h2>
<p>Even though the analysis was performed using global and local (box) change of temperature anomalies, for practical purposes of this project, I present here the local results.</p>
</section>
<section id="3.1-Observed-feedbacks">
<h2><span class="section-number">1.3.14. </span>3.1 Observed feedbacks<a class="headerlink" href="#3.1-Observed-feedbacks" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">input_data</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">Ty_sky</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[W $m^{-2} K^{-1}$]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude [Degree]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">intervals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(10S,10N)&#39;</span><span class="p">,</span><span class="s1">&#39;(10,20)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(20,30)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(30,40)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(40,50)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(50,60)S/N&#39;</span><span class="p">,</span>
           <span class="s1">&#39;(60,70)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(70,80)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(80,90)S/N&#39;</span><span class="p">]</span>
<span class="n">domain</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span>
<span class="n">feed_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">top_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">feed_sw</span><span class="o">=</span><span class="p">[];</span><span class="n">top_sw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_sw_IC</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">):</span>
    <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;Feed_Ftropics_&#39;</span><span class="o">+</span><span class="n">Ty_sky</span><span class="o">+</span><span class="s1">&#39;_NOSI_NOI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">)</span>
    <span class="c1">#-----------------------------------------------------------------</span>
    <span class="c1">#------------------------ OBS ------------------------------------</span>
    <span class="c1">#-----------------------------------------------------------------</span>
    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>
    <span class="n">style</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span>
    <span class="n">sh</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">feed_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;feed_lw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">top_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">bot_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">feed_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;feed_sw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">top_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">bot_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
<span class="n">feed_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bot_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">feed_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feed_sw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bot_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">feed_lw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">feed_sw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">],[</span><span class="n">bot_lw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_lw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">],[</span><span class="n">bot_sw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_sw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">8.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Longwave&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Shortwave&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;obs_feed.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_42_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_42_0.png" />
</div>
</div>
<p><em>Figure 4. All sky Longwave (left) and shortwave (right) feedbacks. Bars indicate the 95% confidence intervals.</em></p>
<p>Figure 4. shows longwave and shortwave feedbacks. Longwave feedbacks are negative across all latitudes with three distinctive features, first small negative feedback in the deep tropics, larger feedback in the subtropics, and nearly constant feedback in the extratropics. Shortwave feedbacks also exhibit three trends, a negative value in the deep tropics, positive feedback in the extratropics, and approximately no feedback in the extratropics. To try to attribute those trends to cloud-related and
not related feedbacks, I split the total feedbacks into clear-sky and cloud radiative effects as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">input_data</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[W $m^{-2} K^{-1}$]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude [Degree]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">intervals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(10S,10N)&#39;</span><span class="p">,</span><span class="s1">&#39;(10,20)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(20,30)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(30,40)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(40,50)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(50,60)S/N&#39;</span><span class="p">,</span>
           <span class="s1">&#39;(60,70)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(70,80)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(80,90)S/N&#39;</span><span class="p">]</span>
<span class="n">domain</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span>
<span class="k">for</span> <span class="n">Ty_sky</span><span class="p">,</span><span class="n">tit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;cs&#39;</span><span class="p">,</span><span class="s1">&#39;cre&#39;</span><span class="p">),(</span><span class="s1">&#39;Clear sky&#39;</span><span class="p">,</span><span class="s1">&#39;Cloud radiative effects&#39;</span><span class="p">)):</span>
    <span class="n">feed_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">top_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">feed_sw</span><span class="o">=</span><span class="p">[];</span><span class="n">top_sw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_sw_IC</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">):</span>
        <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;Feed_Ftropics_&#39;</span><span class="o">+</span><span class="n">Ty_sky</span><span class="o">+</span><span class="s1">&#39;_NOSI_NOI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">)</span>
        <span class="c1">#-----------------------------------------------------------------</span>
        <span class="c1">#------------------------ OBS ------------------------------------</span>
        <span class="c1">#-----------------------------------------------------------------</span>
        <span class="k">if</span> <span class="n">Ty_sky</span><span class="o">==</span><span class="s1">&#39;cs&#39;</span><span class="p">:</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
        <span class="n">style</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span>
        <span class="n">sh</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">feed_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;feed_lw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">top_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">bot_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">feed_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;feed_sw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">top_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">bot_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">feed_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">top_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bot_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">feed_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feed_sw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">top_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bot_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)):</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">feed_lw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">tit</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">feed_sw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">],[</span><span class="n">bot_lw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_lw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">sh</span><span class="p">],[</span><span class="n">bot_sw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_sw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">{</span><span class="n">l</span><span class="p">:</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">())}</span><span class="o">.</span><span class="n">items</span><span class="p">())][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">8.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Longwave&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Shortwave&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;CS_CRE_feedbacks.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_45_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_45_0.png" />
</div>
</div>
<p><em>Figure 5. Clear-sky and Cloud radiative effects longwave (left) and shortwave (right) feedbacks. Bars indicate the 95% confidence intervals.</em></p>
<p>Since variations in the tropical feedbacks relate strongly to CRE, changes in clouds might explain the behavior in that area. Extratropical feedbacks are produced mostly by clear-sky feedbacks (Planck, water vapor, lapse rate, sea ice albedo, etc). In the deep tropics, the positive longwave CRE feedback that counteracts the negative CS comes from rising clouds while remaining at nearly constant temperature (FAT hypothesis - Figure 6.) and increasing cloud cover (Figure 7.), whereas the negative
shortwave feedback is related to the thickening of clouds. In the subtropics, longwave CRE negative feedbacks relate to decreasing cloud cover (potentially an IRIS effect) and thinning clouds, while the positive shortwave CRE feedbacks is a response of thinning clouds and reductions of cloud cover.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">input_data</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude [Degree]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">intervals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(10S,10N)&#39;</span><span class="p">,</span><span class="s1">&#39;(10,20)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(20,30)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(30,40)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(40,50)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(50,60)S/N&#39;</span><span class="p">,</span>
           <span class="s1">&#39;(60,70)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(70,80)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(80,90)S/N&#39;</span><span class="p">]</span>
<span class="n">domain</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span>
<span class="n">m_cth</span><span class="o">=</span><span class="p">[];</span><span class="n">top_cth_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_cth_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">m_ctt</span><span class="o">=</span><span class="p">[];</span><span class="n">top_ctt_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_ctt_IC</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">):</span>
    <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;CTH_NOSI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">)</span>
    <span class="n">m_cth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;reg_cth_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">top_cth_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_cth_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">bot_cth_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_cth_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">m_ctt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;reg_ctt_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">top_ctt_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_ctt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">bot_ctt_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_ctt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
<span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Global&#39;</span><span class="p">:</span>
    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>
<span class="n">m_cth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">m_cth</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_cth_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_cth_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bot_cth_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_cth_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">m_ctt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">m_ctt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_ctt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_ctt_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bot_ctt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_ctt_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m_cth</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m_ctt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">],[</span><span class="n">bot_cth_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_cth_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">],[</span><span class="n">bot_ctt_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_ctt_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">0.8</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">0.8</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">8.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cloud top height&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cloud top temperature&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[ $\% K^{-1}$]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[Dimensionless]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cloud_H_and_T.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_48_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_48_0.png" />
</div>
</div>
<p><em>Figure 6. Cloud top height (left) and Cloud top temperature (right) regresion coefficients. Bars indicate the 95% confidence intervals.</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="nb">input</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span>
<span class="n">input_data</span><span class="o">=</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data_prod/&#39;</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude [Degree]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">intervals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(10S,10N)&#39;</span><span class="p">,</span><span class="s1">&#39;(10,20)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(20,30)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(30,40)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(40,50)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(50,60)S/N&#39;</span><span class="p">,</span>
           <span class="s1">&#39;(60,70)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(70,80)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(80,90)S/N&#39;</span><span class="p">]</span>
<span class="n">domain</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span>
<span class="n">m_cth</span><span class="o">=</span><span class="p">[];</span><span class="n">top_cth_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_cth_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">m_ctt</span><span class="o">=</span><span class="p">[];</span><span class="n">top_ctt_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_ctt_IC</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">):</span>
    <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;optical_Ftropics_NOI_NOSI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">)</span>
    <span class="n">m_cth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;reg_clda_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">top_cth_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_clda_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">bot_cth_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_clda_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">m_ctt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;reg_cldt_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">top_ctt_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_cldt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">bot_ctt_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_cldt_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
<span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>
<span class="n">m_cth</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">m_cth</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_cth_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_cth_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bot_cth_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_cth_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">m_ctt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">m_ctt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_ctt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_ctt_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bot_ctt_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_ctt_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m_cth</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m_ctt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">],[</span><span class="n">bot_cth_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_cth_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">],[</span><span class="n">bot_ctt_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_ctt_IC</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">8.5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cloud fraction&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Optical Depth&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[ $\% K^{-1}$]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[ $K^{-1}$]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">intervals</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;cloud_properties.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_50_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_50_0.png" />
</div>
</div>
<p><em>Figure 7. Cloud fraction (left) and optical depth (right) regression coefficients. Bars indicate the 95% confidence intervals.</em></p>
</section>
<section id="3.2-Simulated-feeedbacks">
<h2><span class="section-number">1.3.15. </span>3.2 Simulated feeedbacks<a class="headerlink" href="#3.2-Simulated-feeedbacks" title="Link to this heading"></a></h2>
<p>Observed feedbacks (blue boxes) and simulated feedbacks are shown in Figure 8. Tropical longwave feedbacks are on average biased from observations, for both CMIP6 and AMIP datasets (top). In CMIP6 (black) the difference locates in the deep tropics (10S to 10N), whereas for AMIP (green) it comes from 10S/N to 30S/N. For shortwave feedbacks, CMIP6 models exhibit a remarkable agreement with observation across all latitudes. This is not the case for AMIP, particularly within the tropics. By
decomposing the all-sky feedback into CS and CRE, it is possible to attribute those biases to the simulation of tropical clouds (middle and bottom).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">for</span> <span class="n">Ty_sky</span><span class="p">,</span><span class="n">tit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="s1">&#39;cs&#39;</span><span class="p">,</span><span class="s1">&#39;cre&#39;</span><span class="p">),(</span><span class="s1">&#39;All sky&#39;</span><span class="p">,</span><span class="s1">&#39;CS&#39;</span><span class="p">,</span> <span class="s1">&#39;CRE&#39;</span><span class="p">)):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[W $m^{-2} K^{-1}$]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude [Degree]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">tit</span><span class="p">)</span>
    <span class="n">intervals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(10S,10N)&#39;</span><span class="p">,</span><span class="s1">&#39;(10,20)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(20,30)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(30,40)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(40,50)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(50,60)S/N&#39;</span><span class="p">,</span>
               <span class="s1">&#39;(60,70)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(70,80)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(80,90)S/N&#39;</span><span class="p">]</span>
    <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span>
    <span class="n">feed_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">top_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">feed_sw</span><span class="o">=</span><span class="p">[];</span><span class="n">top_sw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_sw_IC</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">):</span>
        <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;Feed_Ftropics_&#39;</span><span class="o">+</span><span class="n">Ty_sky</span><span class="o">+</span><span class="s1">&#39;_NOSI_NOI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">)</span>
        <span class="c1">#-----------------------------------------------------------------</span>
        <span class="c1">#------------------------ OBS ------------------------------------</span>
        <span class="c1">#-----------------------------------------------------------------</span>
        <span class="k">if</span> <span class="n">domain</span><span class="o">==</span><span class="s1">&#39;Global&#39;</span><span class="p">:</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>
        <span class="n">feed_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;feed_lw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">top_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">bot_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_lw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">feed_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;feed_sw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">top_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;top_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
        <span class="n">bot_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;bot_sw_IC_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
    <span class="n">feed_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feed_lw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">top_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bot_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">feed_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feed_sw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">top_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">bot_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span><span class="n">feed_lw</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span><span class="n">feed_sw</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)):</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span><span class="n">bot_lw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_lw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span><span class="n">bot_sw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">top_sw_IC</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">exps</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">names</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">experiment</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;CMIP6_historical&#39;</span><span class="p">,</span><span class="s1">&#39;AMIP&#39;</span><span class="p">),(</span><span class="s1">&#39;HIS-&#39;</span><span class="p">,</span><span class="s1">&#39;AMIP-&#39;</span><span class="p">)):</span>
        <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="o">+</span><span class="n">name</span>
        <span class="n">exps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
        <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;Local&#39;</span>
        <span class="c1">#-----------------------------------------------------------------</span>
        <span class="c1">#------------------------ CMIP6 ----------------------------------</span>
        <span class="c1">#-----------------------------------------------------------------</span>
        <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">exps</span><span class="p">:</span>
            <span class="n">models</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">input</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;/*&#39;</span><span class="p">):</span>
                <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/home/alejandro/CL_feedbacks/data/&#39;</span><span class="o">+</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">exp</span><span class="o">==</span><span class="s1">&#39;CMIP6_4xCO2&#39;</span><span class="p">:</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span>
            <span class="k">elif</span> <span class="n">exp</span><span class="o">==</span><span class="s1">&#39;CMIP6_historical&#39;</span><span class="p">:</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
            <span class="k">elif</span> <span class="n">exp</span><span class="o">==</span><span class="s1">&#39;AMIP&#39;</span><span class="p">:</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
            <span class="n">mean_mod_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">mean_mod_sw</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">mod</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
                <span class="n">m_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">top_lw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">m_sw</span><span class="o">=</span><span class="p">[];</span><span class="n">bot_sw_IC</span><span class="o">=</span><span class="p">[];</span><span class="n">top_sw_IC</span><span class="o">=</span><span class="p">[]</span>
                <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">):</span>
                    <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;Feed_Ftropics_&#39;</span><span class="o">+</span><span class="n">Ty_sky</span><span class="o">+</span><span class="s1">&#39;_NOSI_NOI_&#39;</span><span class="o">+</span><span class="n">H</span><span class="o">+</span><span class="s1">&#39;.npz&#39;</span><span class="p">)</span>
                    <span class="n">m_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_m_lw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
                    <span class="n">bot_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_lw_IC_min_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
                    <span class="n">top_lw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_lw_IC_max_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
                    <span class="n">m_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_m_sw_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
                    <span class="n">bot_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_sw_IC_min_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
                    <span class="n">top_sw_IC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_sw_IC_max_&#39;</span><span class="o">+</span><span class="n">domain</span><span class="p">])</span>
                <span class="n">m_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">m_lw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">bot_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">top_lw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_lw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">m_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">m_sw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">bot_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bot_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">top_sw_IC</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">top_sw_IC</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">mean_mod_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_lw</span><span class="p">)</span>
                <span class="n">mean_mod_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_sw</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervals</span><span class="p">)):</span>
                    <span class="n">xtick_mo</span><span class="o">=</span><span class="n">j</span><span class="o">-</span><span class="mf">0.5</span><span class="o">+</span><span class="n">k</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">))</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xtick_mo</span><span class="p">,</span><span class="n">m_lw</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xtick_mo</span><span class="p">,</span><span class="n">m_sw</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xtick_mo</span><span class="p">,</span><span class="n">xtick_mo</span><span class="p">],[</span><span class="n">bot_lw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">top_lw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xtick_mo</span><span class="p">,</span><span class="n">xtick_mo</span><span class="p">],[</span><span class="n">bot_sw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">top_sw_IC</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            <span class="n">mean_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_mod_lw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">mean_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mean_mod_sw</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span><span class="n">mean_lw</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intervals</span><span class="p">,</span><span class="n">mean_sw</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;LW feedback&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">{</span><span class="n">l</span><span class="p">:</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">())}</span><span class="o">.</span><span class="n">items</span><span class="p">())][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SW feedback&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">8.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;mod_feedbacks&#39;</span><span class="o">+</span><span class="n">Ty_sky</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_54_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_54_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_54_1.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_54_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_54_2.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_54_2.png" />
</div>
</div>
<p><em>Figure 8. Observed and simulated feedbacks for All-sky (top), CS (middle) and CRE (bottom). Bars and boxes indicate the 95% confidence intervals.</em></p>
<p>To investigate if the above internal variability feedbacks are related to <span class="math notranslate nohighlight">\(CO_2\)</span> forcing feedbacks, I calculated anomalies of air temperature and TOA fluxes for a set of models from the abrupt increase of <span class="math notranslate nohighlight">\(CO_2\)</span> experiments (TAble 1.). The anomalies were computed by taking the differences between pre-industrial concentration and increases <span class="math notranslate nohighlight">\(CO_2\)</span> simulations, then feedbacks were diagnosed by performing the regressions. Figure 9. shows the one-to-one comparison between internal
variability and <span class="math notranslate nohighlight">\(CO_2\)</span> feedbacks, plus their lineal relation. The approximately one-to-one relation indicates a high probability that the internal variability features are also present with <span class="math notranslate nohighlight">\(CO_2\)</span> forcings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.regressionplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">abline_plot</span>
<span class="n">equ_hist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&quot;diff -q  /home/alejandro/CL_feedbacks/data/CMIP6_historical/ /home/alejandro/CL_feedbacks/data/CMIP6_4xCO2/ | grep Common* | cut -d&#39; &#39; -f 5 | cut -d&#39;/&#39; -f 7&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="c1">#.remove(&#39;&#39;)</span>
<span class="n">equ_hist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">equ_amip</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s2">&quot;diff -q  /home/alejandro/CL_feedbacks/data/AMIP/ /home/alejandro/CL_feedbacks/data/CMIP6_4xCO2/ | grep Common* | cut -d&#39; &#39; -f 5 | cut -d&#39;/&#39; -f 7&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="c1">#.remove(&#39;&#39;)</span>
<span class="n">equ_amip</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">Ty_sky</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Internal variability feedback [W $m^{-2} K^{-1}$]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;abrupt-4xCO2 feedback [W $m^{-2} K^{-1}$]&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">intervals</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(10S,10N)&#39;</span><span class="p">,</span><span class="s1">&#39;(10,20)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(20,30)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(30,40)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(40,50)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(50,60)S/N&#39;</span><span class="p">,</span>
           <span class="s1">&#39;(60,70)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(70,80)S/N&#39;</span><span class="p">,</span><span class="s1">&#39;(80,90)S/N&#39;</span><span class="p">]</span>
<span class="n">exps</span><span class="o">=</span><span class="p">[]</span>
<span class="n">names</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="n">LW</span><span class="o">=</span><span class="p">[]</span>
<span class="n">SW</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">exp</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;CMIP6_historical&#39;</span><span class="p">,</span><span class="s1">&#39;AMIP&#39;</span><span class="p">),(</span><span class="s1">&#39;HIS-&#39;</span><span class="p">,</span><span class="s1">&#39;AMIP-&#39;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">exp</span><span class="o">==</span><span class="s1">&#39;CMIP6_historical&#39;</span><span class="p">:</span>
        <span class="n">models</span><span class="o">=</span><span class="n">equ_hist</span>
        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">models</span><span class="o">=</span><span class="n">equ_amip</span>
        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
    <span class="n">m_mod_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">m_mod_sw</span><span class="o">=</span><span class="p">[];</span><span class="n">m_mod_ab_lw</span><span class="o">=</span><span class="p">[];</span><span class="n">m_mod_ab_sw</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">mod</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
        <span class="n">DATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">input_data</span><span class="o">+</span><span class="s1">&#39;Feed_global_&#39;</span><span class="o">+</span><span class="n">Ty_sky</span><span class="o">+</span><span class="s1">&#39;_Had5.npz&#39;</span><span class="p">)</span>
        <span class="n">m_lw</span><span class="o">=</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_m_lw&#39;</span><span class="p">]</span>
        <span class="n">m_mod_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_lw</span><span class="p">)</span>
        <span class="n">m_sw</span><span class="o">=</span><span class="n">DATA</span><span class="p">[</span><span class="n">exp</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_m_sw&#39;</span><span class="p">]</span>
        <span class="n">m_mod_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_sw</span><span class="p">)</span>
        <span class="n">m_lw_ab</span><span class="o">=</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;CMIP6_4xCO2_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_m_lw&#39;</span><span class="p">]</span>
        <span class="n">m_mod_ab_lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_lw_ab</span><span class="p">)</span>
        <span class="n">m_sw_ab</span><span class="o">=</span><span class="n">DATA</span><span class="p">[</span><span class="s1">&#39;CMIP6_4xCO2_&#39;</span><span class="o">+</span><span class="n">mod</span><span class="o">+</span><span class="s1">&#39;_m_sw&#39;</span><span class="p">]</span>
        <span class="n">m_mod_ab_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_sw_ab</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">m_lw_ab</span><span class="p">,</span><span class="n">m_lw</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">m_sw_ab</span><span class="p">,</span><span class="n">m_sw</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">LW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_mod_ab_lw</span><span class="p">)</span>
    <span class="n">LW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_mod_lw</span><span class="p">)</span>
    <span class="n">SW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_mod_ab_sw</span><span class="p">)</span>
    <span class="n">SW</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m_mod_sw</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">m_mod_ab_lw</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">m_mod_lw</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
    <span class="n">abline_plot</span><span class="p">(</span><span class="n">model_results</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">m_mod_ab_sw</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">m_mod_sw</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
    <span class="n">abline_plot</span><span class="p">(</span><span class="n">model_results</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">min_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">LW</span><span class="p">)))</span>
<span class="n">max_lw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">LW</span><span class="p">)))</span>
<span class="n">min_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">SW</span><span class="p">)))</span>
<span class="n">max_sw</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">SW</span><span class="p">)))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_lw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">max_lw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">],</span> <span class="p">[</span><span class="n">min_lw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">max_lw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min_sw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">max_sw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">],</span> <span class="p">[</span><span class="n">min_sw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">max_sw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;LW feedback&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">{</span><span class="n">l</span><span class="p">:</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">())}</span><span class="o">.</span><span class="n">items</span><span class="p">())][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SW feedback&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_lw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="n">max_lw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_lw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="n">max_lw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_sw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="n">max_sw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_sw</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span><span class="n">max_sw</span><span class="o">+</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;abru_his.pdf&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_57_0.png" src="../../_images/STUDENTSPROJECTS_Proj_2021_SW_Alejandro_Uribe_Geo_comp_pro_AU_57_0.png" />
</div>
</div>
<p><em>Figure 9. Internal variability vs abrupt-4xCO2 feedbacks. Discontinuous lines indicate the feedback linear relation and the solid line depicts a perfect relation.</em></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Farzad_VahidiMayamey_sw2021_b.html" class="btn btn-neutral float-left" title="1.2. Compiling OTB from source" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Alexandra_Pongr%C3%A1cz_project_idea.html" class="btn btn-neutral float-right" title="1.4. Statistical comparison global gridded climate datasets and their influence on LPJ-GUESS model outputs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Giuseppe Amatulli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>